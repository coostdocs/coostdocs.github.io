<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="include: co/thread.h.
#Thread The Thread class is an encapsulation of the thread. When a Thread object is created, the thread will be started. Once the thread is started, it will run until the thread function exits. The Thread class does not provide a method for forcing terminating the thread (something like pthread_cancel). This type of method is usually unsafe and may cause damage to user data.
#Thread::Thread explicit Thread(co::Closure* cb); template&lt;typename F&gt; explicit Thread(F&amp;&amp; f); template&lt;typename F, typename P&gt; Thread(F&amp;&amp; f, P&amp;&amp; p); template&lt;typename F, typename T, typename P&gt; Thread(F&amp;&amp; f, T* t, P&amp;&amp; p); Constructor, the thread will start after the Thread object is created.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Thread" />
<meta property="og:description" content="include: co/thread.h.
#Thread The Thread class is an encapsulation of the thread. When a Thread object is created, the thread will be started. Once the thread is started, it will run until the thread function exits. The Thread class does not provide a method for forcing terminating the thread (something like pthread_cancel). This type of method is usually unsafe and may cause damage to user data.
#Thread::Thread explicit Thread(co::Closure* cb); template&lt;typename F&gt; explicit Thread(F&amp;&amp; f); template&lt;typename F, typename P&gt; Thread(F&amp;&amp; f, P&amp;&amp; p); template&lt;typename F, typename T, typename P&gt; Thread(F&amp;&amp; f, T* t, P&amp;&amp; p); Constructor, the thread will start after the Thread object is created." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://coostdocs.github.io/en/co/thread/" /><meta property="article:section" content="co" />

<meta property="article:modified_time" content="2021-10-04T10:55:00+08:00" />

<title>Thread | Documents for Coost</title>
<link rel="manifest" href="../../../manifest.json">
<link rel="icon" href="../../../favicon.png" type="image/x-icon">
  <link rel="alternate" hreflang="cn" href="https://coostdocs.github.io/cn/co/thread/" title="çº¿ç¨‹">
<link rel="stylesheet" href="../../../book.min.0608a3570dae40fa4b3de520d6a873cc9855bb4cb5001c4b16e95a226b84aff8.css" integrity="sha256-BgijVw2uQPpLPeUg1qhzzJhVu0y1ABxLFulaImuEr/g=" crossorigin="anonymous">
  <script defer src="../../../flexsearch.min.js"></script>
  <script defer src="../../../en.search.min.b69c1cb528c525b6ec91a6b3fabc25e400a1d7287f91107616e45c71b3abd1c2.js" integrity="sha256-tpwctSjFJbbskaaz&#43;rwl5ACh1yh/kRB2FuRccbOr0cI=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  


<link href='//cdn.bootcss.com/highlight.js/11.1.0/styles/github.min.css'
  rel='stylesheet' type='text/css' />


</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="../../../cn/"><span>Documents for Coost</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>About</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/co/" class="">Introduction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/contact/" class="">Contact</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/sponsor/" class="">SponsorðŸ’•</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Documents for CO</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/def/" class="">Basic definitions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/defer/" class="">defer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/atomic/" class="">Atomic Operations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/fastring/" class="">fastring</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/fastream/" class="">fastream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/str/" class="">String utilities</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/flag/" class="">co/flag</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/log/" class="">co/log</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/unitest/" class="">Unitest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/json/" class="">JSON</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/time/" class="">Time</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/thread/" class=" active">Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/coroutine/" class="">Coroutine</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-752f64a904309658adbf6062b2c3d8c1" class="toggle"  />
    <label for="section-752f64a904309658adbf6062b2c3d8c1" class="flex justify-between">
      <a role="button" class="">Network Programming</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/byte_order/" class="">Byte order</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/tcp/" class="">TCP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/http/" class="">HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/rpc/" class="">RPC</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/tasked/" class="">Timed task scheduler</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/random/" class="">Random number</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/lrumap/" class="">LruMap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/hash/" class="">Hash</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/path/" class="">Path</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/fs/" class="">File System</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/os/" class="">Operating System</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/build/" class="">Compiling</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Thread</strong>

  <label for="toc-control">
    
    <img src="../../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#thread">Thread</a>
          <ul>
            <li><a href="#threadthread">Thread::Thread</a></li>
            <li><a href="#threadthread-1">Thread::~Thread</a></li>
            <li><a href="#threaddetach">Thread::detach</a></li>
            <li><a href="#threadjoin">Thread::join</a></li>
          </ul>
        </li>
        <li><a href="#cothread_id">co::thread_id</a></li>
        <li><a href="#current_thread_id">current_thread_id</a></li>
        <li><a href="#mutex-mutex">Mutex (Mutex)</a>
          <ul>
            <li><a href="#mutexmutex">Mutex::Mutex</a></li>
            <li><a href="#mutexmutex-1">Mutex::~Mutex</a></li>
            <li><a href="#mutexlock">Mutex::lock</a></li>
            <li><a href="#mutextry_lock">Mutex::try_lock</a></li>
            <li><a href="#mutexunlock">Mutex::unlock</a></li>
          </ul>
        </li>
        <li><a href="#mutexguard">MutexGuard</a>
          <ul>
            <li><a href="#mutexguardmutexguard">MutexGuard::MutexGuard</a></li>
            <li><a href="#mutexguardmutexguard-1">MutexGuard::~MutexGuard</a></li>
          </ul>
        </li>
        <li><a href="#syncevent">SyncEvent</a>
          <ul>
            <li><a href="#synceventsyncevent">SyncEvent::SyncEvent</a></li>
            <li><a href="#synceventsyncevent-1">SyncEvent::~SyncEvent</a></li>
            <li><a href="#synceventreset">SyncEvent::reset</a></li>
            <li><a href="#synceventsignal">SyncEvent::signal</a></li>
            <li><a href="#synceventwait">SyncEvent::wait</a></li>
            <li><a href="#code-example">Code example</a></li>
          </ul>
        </li>
        <li><a href="#tls-based-thread_ptr">TLS-based thread_ptr</a>
          <ul>
            <li><a href="#thread_ptrthread_ptr">thread_ptr::thread_ptr</a></li>
            <li><a href="#thread_ptrthread_ptr-1">thread_ptr::~thread_ptr</a></li>
            <li><a href="#thread_ptrget">thread_ptr::get</a></li>
            <li><a href="#thread_ptroperator">thread_ptr::operator=</a></li>
            <li><a href="#thread_ptroperator-">thread_ptr::operator-&gt;</a></li>
            <li><a href="#thread_ptroperator-1">thread_ptr::operator*</a></li>
            <li><a href="#thread_ptroperator-2">thread_ptr::operator==</a></li>
            <li><a href="#thread_ptroperator-3">thread_ptr::operator!=</a></li>
            <li><a href="#thread_ptroperator-4">thread_ptr::operator!</a></li>
            <li><a href="#thread_ptroperator-bool">thread_ptr::operator bool</a></li>
            <li><a href="#thread_ptrrelease">thread_ptr::release</a></li>
            <li><a href="#thread_ptrreset">thread_ptr::reset</a></li>
            <li><a href="#code-example-1">Code example</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><p>include: <a href="https://github.com/idealvin/co/blob/master/include/co/thread.h">co/thread.h</a>.</p>
<h2 id="thread"><a class="anchor" href="#thread">#</a>Thread</h2>
<p>The <code>Thread</code> class is an encapsulation of the thread. When a Thread object is created, the thread will be started. Once the thread is started, it will run until the thread function exits. The Thread class does not provide a method for forcing terminating the thread (something like pthread_cancel). This type of method is usually unsafe and may cause damage to user data.</p>
<h3 id="threadthread"><a class="anchor" href="#threadthread">#</a>Thread::Thread</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> <span style="color:#900;font-weight:bold">Thread</span>(co<span style="color:#000;font-weight:bold">::</span>Closure<span style="color:#000;font-weight:bold">*</span> cb);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">template</span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">typename</span> F<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> Thread(F<span style="color:#000;font-weight:bold">&amp;&amp;</span> f);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">template</span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">typename</span> F, <span style="color:#000;font-weight:bold">typename</span> P<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>Thread(F<span style="color:#000;font-weight:bold">&amp;&amp;</span> f, P<span style="color:#000;font-weight:bold">&amp;&amp;</span> p);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">template</span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">typename</span> F, <span style="color:#000;font-weight:bold">typename</span> T, <span style="color:#000;font-weight:bold">typename</span> P<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>Thread(F<span style="color:#000;font-weight:bold">&amp;&amp;</span> f, T<span style="color:#000;font-weight:bold">*</span> t, P<span style="color:#000;font-weight:bold">&amp;&amp;</span> p);
</span></span></code></pre></div><ul>
<li>
<p>Constructor, the thread will start after the Thread object is created.</p>
</li>
<li>
<p>In the first version, the parameter cb is a pointer of Closure type. Generally, users are not recommended to use this version directly.</p>
</li>
<li>
<p>For the 2-4th version, a Closure object is constructed according to the passed in parameters, and then the first version is called.</p>
</li>
<li>
<p>In the second version, the parameter f is any runnable object, as long as we can call <code>f()</code>Â or <code>(*f)()</code>.</p>
</li>
<li>
<p>In the third version, the parameter f is any runnable object, as long as we can call <code>f(p)</code>, <code>(*f)(p)</code>Â or <code>(p-&gt;*f)()</code>.</p>
</li>
<li>
<p>In the fourth version, the parameter f is a method with one parameter in class T, the parameter t is a pointer of type <code>T</code>, and p is the parameter of f.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Thread <span style="color:#900;font-weight:bold">x</span>([](){});                  <span style="color:#998;font-style:italic">// lambda
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread <span style="color:#900;font-weight:bold">x</span>(f);                       <span style="color:#998;font-style:italic">// void f();
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread <span style="color:#900;font-weight:bold">x</span>(f, p);                    <span style="color:#998;font-style:italic">// void f(void*); void* p;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread <span style="color:#900;font-weight:bold">x</span>(f, <span style="color:#099">7</span>);                    <span style="color:#998;font-style:italic">// void f(int v);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread <span style="color:#900;font-weight:bold">x</span>(<span style="color:#000;font-weight:bold">&amp;</span>T<span style="color:#000;font-weight:bold">::</span>f, <span style="color:#000;font-weight:bold">&amp;</span>t);               <span style="color:#998;font-style:italic">// void T::f(); T t;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread <span style="color:#900;font-weight:bold">x</span>(<span style="color:#000;font-weight:bold">&amp;</span>T<span style="color:#000;font-weight:bold">::</span>f, <span style="color:#000;font-weight:bold">&amp;</span>t, <span style="color:#099">7</span>);            <span style="color:#998;font-style:italic">// void T::f(int v); T t;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread <span style="color:#900;font-weight:bold">x</span>(std<span style="color:#000;font-weight:bold">::</span>bind(<span style="color:#000;font-weight:bold">&amp;</span>T<span style="color:#000;font-weight:bold">::</span>f, <span style="color:#000;font-weight:bold">&amp;</span>t, <span style="color:#099">7</span>)); <span style="color:#998;font-style:italic">// void T::f(int v); T t;
</span></span></span></code></pre></div><h3 id="threadthread-1"><a class="anchor" href="#threadthread-1">#</a>Thread::~Thread</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Thread<span style="color:#000;font-weight:bold">::~</span>Thread();
</span></span></code></pre></div><ul>
<li>Destructor, call the <code>join()</code> method, wait for the thread to exit, and release system resources.</li>
</ul>
<h3 id="threaddetach"><a class="anchor" href="#threaddetach">#</a>Thread::detach</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">detach</span>();
</span></span></code></pre></div><ul>
<li>
<p>Let the thread run independently of the Thread object. Once this method is called, the Thread object is useless. When the thread function exits, the system resources are automatically released.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">f</span>();
</span></span><span style="display:flex;"><span>Thread(f).detach(); <span style="color:#998;font-style:italic">// run f() in a thread
</span></span></span></code></pre></div><h3 id="threadjoin"><a class="anchor" href="#threadjoin">#</a>Thread::join</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">join</span>();
</span></span></code></pre></div><ul>
<li>Calling this method will block until the thread function exits, and then release system resources.</li>
<li>If the <code>detach()</code> method has been called before, nothing will happen when calling this method.</li>
</ul>
<h2 id="cothread_id"><a class="anchor" href="#cothread_id">#</a>co::thread_id</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>uint32 <span style="color:#900;font-weight:bold">thread_id</span>();
</span></span></code></pre></div><ul>
<li>This function returns the id of the current thread.</li>
<li>In the internal implementation, <a href="https://wiki.osdev.org/Thread_Local_Storage">TLS</a> is used to save the thread id, and each thread only needs one system call.</li>
</ul>
<h2 id="current_thread_id"><a class="anchor" href="#current_thread_id">#</a>current_thread_id</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>uint32 <span style="color:#900;font-weight:bold">current_thread_id</span>();
</span></span></code></pre></div><ul>
<li>Deprecated since v2.0.2, use <code>co::thread_id()</code> instead.</li>
</ul>
<h2 id="mutex-mutex"><a class="anchor" href="#mutex-mutex">#</a>Mutex (Mutex)</h2>
<p><code>Mutex</code> is a kind of mutual exclusion lock commonly used in multithreaded programming. At the same time, at most one thread holds the lock, and other threads must wait for the lock to be released.</p>
<h3 id="mutexmutex"><a class="anchor" href="#mutexmutex">#</a>Mutex::Mutex</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Mutex();
</span></span></code></pre></div><ul>
<li>Constructor, allocate system resources and initialize.</li>
</ul>
<h3 id="mutexmutex-1"><a class="anchor" href="#mutexmutex-1">#</a>Mutex::~Mutex</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Mutex<span style="color:#000;font-weight:bold">::~</span>Mutex();
</span></span></code></pre></div><ul>
<li>Destructor, release system resources.</li>
</ul>
<h3 id="mutexlock"><a class="anchor" href="#mutexlock">#</a>Mutex::lock</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">lock</span>();
</span></span></code></pre></div><ul>
<li>Acquire the lock, the method will block until the lock is successfully acquired.</li>
</ul>
<h3 id="mutextry_lock"><a class="anchor" href="#mutextry_lock">#</a>Mutex::try_lock</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> <span style="color:#900;font-weight:bold">try_lock</span>();
</span></span></code></pre></div><ul>
<li>Acquire the lock, will not block. If the lock is successfully acquired, it returns true, otherwise it returns false.</li>
</ul>
<h3 id="mutexunlock"><a class="anchor" href="#mutexunlock">#</a>Mutex::unlock</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">unlock</span>();
</span></span></code></pre></div><ul>
<li>Release the lock, this method is generally called by the thread that held the lock.</li>
</ul>
<h2 id="mutexguard"><a class="anchor" href="#mutexguard">#</a>MutexGuard</h2>
<p>The <code>MutexGuard</code> class is used to automatically acquire and release the lock in <code>Mutex</code> to prevent users from forgetting to release the lock.</p>
<h3 id="mutexguardmutexguard"><a class="anchor" href="#mutexguardmutexguard">#</a>MutexGuard::MutexGuard</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> <span style="color:#900;font-weight:bold">MutexGuard</span>(Mutex<span style="color:#000;font-weight:bold">&amp;</span> m);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> <span style="color:#900;font-weight:bold">MutexGuard</span>(Mutex<span style="color:#000;font-weight:bold">*</span> m);
</span></span></code></pre></div><ul>
<li>The constructor, the parameter m is a reference or pointer of the <code>Mutex</code>. When it is a pointer, m MUST NOT be NULL.</li>
<li>Internally, m&rsquo;s <code>lock()</code> method is called to acquire the lock.</li>
</ul>
<h3 id="mutexguardmutexguard-1"><a class="anchor" href="#mutexguardmutexguard-1">#</a>MutexGuard::~MutexGuard</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>MutexGuard<span style="color:#000;font-weight:bold">::~</span>MutexGuard();
</span></span></code></pre></div><ul>
<li>
<p>Destructor, release the lock acquired in the constructor.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>Mutex m;
</span></span><span style="display:flex;"><span>MutexGuard <span style="color:#900;font-weight:bold">g</span>(m);
</span></span></code></pre></div><h2 id="syncevent"><a class="anchor" href="#syncevent">#</a>SyncEvent</h2>
<p><code>SyncEvent</code> is a synchronization mechanism between multiple threads, suitable for the producer-consumer model. The consumer calls the <code>wait()</code> method to wait for the synchronization signal, and the producer calls the <code>signal()</code> method to generate the synchronization signal. SyncEvent supports multiple producers and multiple consumers, but in actual applications, there is usually a single consumer.</p>
<h3 id="synceventsyncevent"><a class="anchor" href="#synceventsyncevent">#</a>SyncEvent::SyncEvent</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> <span style="color:#900;font-weight:bold">SyncEvent</span>(<span style="color:#458;font-weight:bold">bool</span> manual_reset <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">false</span>, <span style="color:#458;font-weight:bold">bool</span> signaled <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">false</span>);
</span></span></code></pre></div><ul>
<li>Constructor, the parameter manual_reset indicates whether to manually set the synchronization state to unsynchronized, and the parameter signaled indicates whether the initial state is synchronized.</li>
</ul>
<h3 id="synceventsyncevent-1"><a class="anchor" href="#synceventsyncevent-1">#</a>SyncEvent::~SyncEvent</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>SyncEvent<span style="color:#000;font-weight:bold">::~</span>SyncEvent();
</span></span></code></pre></div><ul>
<li>Destructor, release system resources.</li>
</ul>
<h3 id="synceventreset"><a class="anchor" href="#synceventreset">#</a>SyncEvent::reset</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">reset</span>();
</span></span></code></pre></div><ul>
<li>This method sets SyncEvent to unsynchronized state.</li>
<li>When manual_reset is true in the constructor, the user needs to manually call this method after wait() returns, otherwise the SyncEvent may remain in a synchronized state forever.</li>
</ul>
<h3 id="synceventsignal"><a class="anchor" href="#synceventsignal">#</a>SyncEvent::signal</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">signal</span>();
</span></span></code></pre></div><ul>
<li>This method generates a synchronization signal and sets SyncEvent to a synchronized state.</li>
</ul>
<h3 id="synceventwait"><a class="anchor" href="#synceventwait">#</a>SyncEvent::wait</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">wait</span>();
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> <span style="color:#900;font-weight:bold">wait</span>(uint32 ms);
</span></span></code></pre></div><ul>
<li>The first version will wait until SyncEvent becomes synchronized.</li>
<li>The second version will wait until SyncEvent becomes synchronized or timed out. The parameter ms specifies the timeout period in milliseconds.</li>
<li>The second version returns true when the SyncEvent becomes synchronized, and returns false when it timed out.</li>
<li>When manual_reset is false in the constructor, SyncEvent will be automatically set to unsynchronized when wait() ends.</li>
</ul>
<h3 id="code-example"><a class="anchor" href="#code-example">#</a>Code example</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> manual_reset <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">false</span>;
</span></span><span style="display:flex;"><span>SyncEvent <span style="color:#900;font-weight:bold">ev</span>(manual_reset);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">f1</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (<span style="color:#000;font-weight:bold">!</span>ev.wait(<span style="color:#099">1000</span>)) {
</span></span><span style="display:flex;"><span>        LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;f1: timedout..&#34;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;f1: event signaled..&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (manual_reset) ev.reset();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">f2</span>() {
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;f2: send a signal..&#34;</span>;
</span></span><span style="display:flex;"><span>    ev.signal();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread(f1).detach();
</span></span><span style="display:flex;"><span>Thread(f2).detach();
</span></span></code></pre></div><h2 id="tls-based-thread_ptr"><a class="anchor" href="#tls-based-thread_ptr">#</a>TLS-based thread_ptr</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">template</span> <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">typename</span> T, <span style="color:#000;font-weight:bold">typename</span> D<span style="color:#000;font-weight:bold">=</span>std<span style="color:#000;font-weight:bold">::</span>default_delete<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">thread_ptr</span>;
</span></span></code></pre></div><p>The <code>thread_ptr</code> class is similar to <code>std::unique_ptr</code>, but uses the <a href="https://wiki.osdev.org/Thread_Local_Storage">TLS</a> mechanism internally, and each thread sets and owns its own ptr.</p>
<h3 id="thread_ptrthread_ptr"><a class="anchor" href="#thread_ptrthread_ptr">#</a>thread_ptr::thread_ptr</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>thread_ptr();
</span></span></code></pre></div><ul>
<li>Constructor, allocate system resources and initialize.</li>
</ul>
<h3 id="thread_ptrthread_ptr-1"><a class="anchor" href="#thread_ptrthread_ptr-1">#</a>thread_ptr::~thread_ptr</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>thread_ptr<span style="color:#000;font-weight:bold">::~</span>thread_ptr();
</span></span></code></pre></div><ul>
<li>Destructor, delete the private ptr of each thread, and release TLS related system resources.</li>
</ul>
<h3 id="thread_ptrget"><a class="anchor" href="#thread_ptrget">#</a>thread_ptr::get</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>T<span style="color:#000;font-weight:bold">*</span> <span style="color:#900;font-weight:bold">get</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Return the ptr of the current thread.</li>
<li>If the thread has not set a ptr before, this method returns NULL.</li>
</ul>
<h3 id="thread_ptroperator"><a class="anchor" href="#thread_ptroperator">#</a>thread_ptr::operator=</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#000;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">=</span>(T<span style="color:#000;font-weight:bold">*</span> p);
</span></span></code></pre></div><ul>
<li>Assignment, set the current thread&rsquo;s ptr to p, which is equivalent to <code>reset(p)</code>.</li>
</ul>
<h3 id="thread_ptroperator-"><a class="anchor" href="#thread_ptroperator-">#</a>thread_ptr::operator-&gt;</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>T<span style="color:#000;font-weight:bold">*</span> <span style="color:#000;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">-&gt;</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Overload <code>operator-&gt;</code>, returns the ptr of the current thread.</li>
</ul>
<h3 id="thread_ptroperator-1"><a class="anchor" href="#thread_ptroperator-1">#</a>thread_ptr::operator*</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>T<span style="color:#000;font-weight:bold">&amp;</span> <span style="color:#000;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">*</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Overload <code>operator*</code>, returns the reference of the object pointed to by the ptr of the current thread.</li>
</ul>
<h3 id="thread_ptroperator-2"><a class="anchor" href="#thread_ptroperator-2">#</a>thread_ptr::operator==</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">==</span>(T<span style="color:#000;font-weight:bold">*</span> p) <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Determine whether the current thread&rsquo;s ptr is equal to p.</li>
</ul>
<h3 id="thread_ptroperator-3"><a class="anchor" href="#thread_ptroperator-3">#</a>thread_ptr::operator!=</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">!=</span>(T<span style="color:#000;font-weight:bold">*</span> p) <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Determine whether the current thread&rsquo;s ptr is not equal to p.</li>
</ul>
<h3 id="thread_ptroperator-4"><a class="anchor" href="#thread_ptroperator-4">#</a>thread_ptr::operator!</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span><span style="color:#000;font-weight:bold">!</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Determine whether the ptr of the current thread is NULL, return true if it is NULL, otherwise return false.</li>
</ul>
<h3 id="thread_ptroperator-bool"><a class="anchor" href="#thread_ptroperator-bool">#</a>thread_ptr::operator bool</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> <span style="color:#000;font-weight:bold">operator</span> <span style="color:#900;font-weight:bold">bool</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Convert thread_ptr to bool type. If the internal pointer is not NULL, return true, otherwise return false.</li>
</ul>
<h3 id="thread_ptrrelease"><a class="anchor" href="#thread_ptrrelease">#</a>thread_ptr::release</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>T<span style="color:#000;font-weight:bold">*</span> <span style="color:#900;font-weight:bold">release</span>();
</span></span></code></pre></div><ul>
<li>Release the ptr of the current thread.</li>
<li>This method sets the ptr of the current thread to NULL and returns the previous ptr.</li>
</ul>
<h3 id="thread_ptrreset"><a class="anchor" href="#thread_ptrreset">#</a>thread_ptr::reset</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">reset</span>(T<span style="color:#000;font-weight:bold">*</span> p <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>);
</span></span></code></pre></div><ul>
<li>Reset the ptr of the current thread to p, p is 0 by default, and the previous ptr will be deleted by <code>D()(x)</code>.</li>
</ul>
<h3 id="code-example-1"><a class="anchor" href="#code-example-1">#</a>Code example</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">struct</span> <span style="color:#458;font-weight:bold">T</span> {
</span></span><span style="display:flex;"><span>    T(<span style="color:#458;font-weight:bold">int</span> v)<span style="color:#000;font-weight:bold">:</span> _v(v) {}
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">run</span>() {
</span></span><span style="display:flex;"><span>        LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> current_thread_id() <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;v:&#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> _v;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> _v;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>thread_ptr<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> pt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Each thread will set its own pointer, and different threads will not affect each other
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">f</span>(<span style="color:#458;font-weight:bold">int</span> v) {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> (pt <span style="color:#000;font-weight:bold">==</span> <span style="color:#0086b3">NULL</span>) {
</span></span><span style="display:flex;"><span>        LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;new T(&#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> v <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;)&#34;</span>;
</span></span><span style="display:flex;"><span>        pt.reset(<span style="color:#000;font-weight:bold">new</span> T(v));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    pt<span style="color:#000;font-weight:bold">-&gt;</span>run();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread(f, <span style="color:#099">1</span>).detach(); <span style="color:#998;font-style:italic">// start thread 1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>Thread(f, <span style="color:#099">2</span>).detach(); <span style="color:#998;font-style:italic">// start thread 2
</span></span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

  



  
    
  
    
  


  


<div class="book-languages" tabindex="0" aria-haspopup="true">
  <ul>
    <li class="flex align-center">
      <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
      English
    </li> 
  </ul>

  <ul class="book-languages-list">
    
    <li class="">
      <a href="../../../cn/co/thread/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        ä¸­æ–‡
      </a>
    </li>
    
    <li class="active">
      <a href="../../../en/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </li>
    
  </ul>
</div>




  <div class="book-date"><a class="flex align-center" href="https://github.com/cocoyaxi/codoc/commit/10d4fdb40ec891b00d7a399766ad93022312ed01" title='Last modified by idealvin | October 4, 2021' target="_blank" rel="noopener">
      <img src="../../../svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>October 4, 2021</span>
    </a>
  </div>



  <div class="book-edit">
    <a class="flex align-center" href="https://github.com/cocoyaxi/codoc/edit/master/content/en/co/thread.md" target="_blank" rel="noopener">
      <img src="../../../svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        





<script src="//cdn.bootcss.com/highlight.js/11.1.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/cpp.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/bash.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/lua.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/yaml.min.js"></script>
<script>hljs.configure({ languages: [] }); hljs.initHighlightingOnLoad();</script>





      </footer>

      
  
  <div class="book-comments">


<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '11f9ff9ca43804d70b32',
    clientSecret: '07e2bd5b09a1654e7942a7698c3ec164e7566177',
    repo: 'gitalk',
    owner: 'idealvin',
    admin: ['idealvin'],
    id: location.pathname,
    language: 'zh-CN',
    distractionFreeMode: false,
    proxy: 'https:\/\/cors-anywhere.azm.workers.dev\/https:\/\/github.com\/login\/oauth\/access_token'
  })
  gitalk.render('gitalk-container');
</script></div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#thread">Thread</a>
          <ul>
            <li><a href="#threadthread">Thread::Thread</a></li>
            <li><a href="#threadthread-1">Thread::~Thread</a></li>
            <li><a href="#threaddetach">Thread::detach</a></li>
            <li><a href="#threadjoin">Thread::join</a></li>
          </ul>
        </li>
        <li><a href="#cothread_id">co::thread_id</a></li>
        <li><a href="#current_thread_id">current_thread_id</a></li>
        <li><a href="#mutex-mutex">Mutex (Mutex)</a>
          <ul>
            <li><a href="#mutexmutex">Mutex::Mutex</a></li>
            <li><a href="#mutexmutex-1">Mutex::~Mutex</a></li>
            <li><a href="#mutexlock">Mutex::lock</a></li>
            <li><a href="#mutextry_lock">Mutex::try_lock</a></li>
            <li><a href="#mutexunlock">Mutex::unlock</a></li>
          </ul>
        </li>
        <li><a href="#mutexguard">MutexGuard</a>
          <ul>
            <li><a href="#mutexguardmutexguard">MutexGuard::MutexGuard</a></li>
            <li><a href="#mutexguardmutexguard-1">MutexGuard::~MutexGuard</a></li>
          </ul>
        </li>
        <li><a href="#syncevent">SyncEvent</a>
          <ul>
            <li><a href="#synceventsyncevent">SyncEvent::SyncEvent</a></li>
            <li><a href="#synceventsyncevent-1">SyncEvent::~SyncEvent</a></li>
            <li><a href="#synceventreset">SyncEvent::reset</a></li>
            <li><a href="#synceventsignal">SyncEvent::signal</a></li>
            <li><a href="#synceventwait">SyncEvent::wait</a></li>
            <li><a href="#code-example">Code example</a></li>
          </ul>
        </li>
        <li><a href="#tls-based-thread_ptr">TLS-based thread_ptr</a>
          <ul>
            <li><a href="#thread_ptrthread_ptr">thread_ptr::thread_ptr</a></li>
            <li><a href="#thread_ptrthread_ptr-1">thread_ptr::~thread_ptr</a></li>
            <li><a href="#thread_ptrget">thread_ptr::get</a></li>
            <li><a href="#thread_ptroperator">thread_ptr::operator=</a></li>
            <li><a href="#thread_ptroperator-">thread_ptr::operator-&gt;</a></li>
            <li><a href="#thread_ptroperator-1">thread_ptr::operator*</a></li>
            <li><a href="#thread_ptroperator-2">thread_ptr::operator==</a></li>
            <li><a href="#thread_ptroperator-3">thread_ptr::operator!=</a></li>
            <li><a href="#thread_ptroperator-4">thread_ptr::operator!</a></li>
            <li><a href="#thread_ptroperator-bool">thread_ptr::operator bool</a></li>
            <li><a href="#thread_ptrrelease">thread_ptr::release</a></li>
            <li><a href="#thread_ptrreset">thread_ptr::reset</a></li>
            <li><a href="#code-example-1">Code example</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












