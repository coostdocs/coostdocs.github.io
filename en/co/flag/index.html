<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="include: co/flag.h.
#Basic concepts co.flag is a command line and config file parsing library. Its principle is very simple, define global variables in code, then parse the command line parameters and/or config file when the program starts, and update the value of these global variables.
#flag variable The global variable defined by macros in co.flag are called flag variable. For example, the following code defines a flag variable, the variable name is FLG_x.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="flag" />
<meta property="og:description" content="include: co/flag.h.
#Basic concepts co.flag is a command line and config file parsing library. Its principle is very simple, define global variables in code, then parse the command line parameters and/or config file when the program starts, and update the value of these global variables.
#flag variable The global variable defined by macros in co.flag are called flag variable. For example, the following code defines a flag variable, the variable name is FLG_x." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://coostdocs.github.io/en/co/flag/" /><meta property="article:section" content="co" />

<meta property="article:modified_time" content="2023-09-09T08:51:44+08:00" />

<title>flag | Documents for Coost</title>
<link rel="manifest" href="../../../manifest.json">
<link rel="icon" href="../../../favicon.png" type="image/x-icon">
  <link rel="alternate" hreflang="cn" href="https://coostdocs.github.io/cn/co/flag/" title="配置">
<link rel="stylesheet" href="../../../book.min.e64f6734cb67825f25e10bdd1164b6a6045cb02f3f55987979761a7be73c4787.css" integrity="sha256-5k9nNMtngl8l4QvdEWS2pgRcsC8/VZh5eXYae&#43;c8R4c=" crossorigin="anonymous">
  <script defer src="../../../flexsearch.min.js"></script>
  <script defer src="../../../en.search.min.0d32128d3d724eba79cf6c00c8e570bfc9c785e6617b9adc0fa987ea55b53a21.js" integrity="sha256-DTISjT1yTrp5z2wAyOVwv8nHheZhe5rcD6mH6lW1OiE=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  


<link href='../../../css/github.css' rel='stylesheet' type='text/css' />


</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="../../../cn/"><span>Documents for Coost</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>About</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/co/" class="">Introduction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/contact/" class="">Contact</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/sponsor/" class="">Sponsor💕</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Documents</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/def/" class="">Basic Definitions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/god/" class="">God Oriented Programming</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/mem/" class="">Memory Allocation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/flag/" class=" active">flag</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/log/" class="">log</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/unitest/" class="">Unitest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/benchmark/" class="">Benchmark</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/json/" class="">JSON</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b823a0d731c4d472c5b015b832e5d976" class="toggle"  />
    <label for="section-b823a0d731c4d472c5b015b832e5d976" class="flex justify-between">
      <a role="button" class="">Concurrency</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/atomic/" class="">Atomic Operations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/thread/" class="">Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a8bcee0f770e9eedef784caa025649c4" class="toggle"  />
    <label for="section-a8bcee0f770e9eedef784caa025649c4" class="flex justify-between">
      <a role="button" class="">Coroutine</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/basic/" class="">Basic concepts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/api/" class="">APIs</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/chan/" class="">Channel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/event/" class="">Sync Event</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/io_event/" class="">IO Event</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/mutex/" class="">Mutex Lock</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/wg/" class="">Wait Group</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/pool/" class="">Coroutine Pool</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/concurrency/coroutine/conf/" class="">Config</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-752f64a904309658adbf6062b2c3d8c1" class="toggle"  />
    <label for="section-752f64a904309658adbf6062b2c3d8c1" class="flex justify-between">
      <a role="button" class="">Network Programming</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/byte_order/" class="">Byte order</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/sock/" class="">Socket programming</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/mode/" class="">Network programming model</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/third/" class="">Use third-party network libraries</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/tcp/" class="">TCP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/http/" class="">HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/rpc/" class="">RPC</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-76a5d3cff40a8cc3b003b19d517c02e9" class="toggle"  />
    <label for="section-76a5d3cff40a8cc3b003b19d517c02e9" class="flex justify-between">
      <a role="button" class="">others</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/console/" class="">Console</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/defer/" class="">defer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/error/" class="">Error</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/fastring/" class="">fastring</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/fastream/" class="">fastream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/stl/" class="">STL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/str/" class="">String Utility</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/rand/" class="">Random Value</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/hash/" class="">Hash</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/time/" class="">Time</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/tasked/" class="">Timed task scheduler</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/path/" class="">Path</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/fs/" class="">File System</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/other/os/" class="">Operating System</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/build/" class="">Compiling</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>flag</strong>

  <label for="toc-control">
    
    <img src="../../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#basic-concepts">Basic concepts</a>
          <ul>
            <li><a href="#flag-variable">flag variable</a></li>
            <li><a href="#command-line-flag">command line flag</a></li>
          </ul>
        </li>
        <li><a href="#apis">APIs</a>
          <ul>
            <li><a href="#flagparse">flag::parse</a></li>
            <li><a href="#flagset_value">flag::set_value</a></li>
            <li><a href="#flagalias">flag::alias</a></li>
          </ul>
        </li>
        <li><a href="#use-flag-variable-in-the-code">Use flag variable in the code</a>
          <ul>
            <li><a href="#define-a-flag-variable">Define a flag variable</a></li>
            <li><a href="#add-alias-for-a-flag">Add alias for a flag</a></li>
            <li><a href="#declare-the-flag-variable">Declare the flag variable</a></li>
            <li><a href="#use-the-flag-variable">Use the flag variable</a></li>
          </ul>
        </li>
        <li><a href="#use-flag-in-command-line">Use flag in command line</a>
          <ul>
            <li><a href="#set-value-of-flags">Set value of flags</a></li>
            <li><a href="#show-help-information">Show Help Information</a></li>
            <li><a href="#list-all-flags">List all flags</a></li>
            <li><a href="#show-version-of-the-program">Show version of the program</a></li>
          </ul>
        </li>
        <li><a href="#config-file">config file</a>
          <ul>
            <li><a href="#config-file-format">config file format</a></li>
            <li><a href="#generate-config-file">Generate config file</a></li>
            <li><a href="#adjust-the-order-of-config-items">Adjust the order of config items</a></li>
            <li><a href="#prohibit-config-items-from-being-generated-in-the-config-file">Prohibit config items from being generated in the config file</a></li>
            <li><a href="#specify-the-config-file-when-the-program-starts">Specify the config file when the program starts</a></li>
          </ul>
        </li>
        <li><a href="#custom-help-information">Custom help information</a></li>
        <li><a href="#run-program-as-a-daemon">Run program as a daemon</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><p>include: <a href="https://github.com/idealvin/coost/blob/master/include/co/flag.h">co/flag.h</a>.</p>
<h2 id="basic-concepts"><a class="anchor" href="#basic-concepts">#</a>Basic concepts</h2>
<p><strong>co.flag</strong> is a command line and config file parsing library. Its principle is very simple, define global variables in code, then parse the command line parameters and/or config file when the program starts, and update the value of these global variables.</p>
<h3 id="flag-variable"><a class="anchor" href="#flag-variable">#</a>flag variable</h3>
<p>The global variable defined by macros in <code>co.flag</code> are called <strong>flag variable</strong>. For example, the following code defines a flag variable, the variable name is <code>FLG_x</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_int32</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#34;xxx&#34;</span><span class="p">);</span> <span class="c1">// int32 FLG_x = 0;
</span></span></span></code></pre></div><p><code>co.flag</code> supports 7 types of flag variable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">bool</span><span class="p">,</span> <span class="n">int32</span><span class="p">,</span> <span class="n">int64</span><span class="p">,</span> <span class="n">uint32</span><span class="p">,</span> <span class="n">uint64</span><span class="p">,</span> <span class="kt">double</span><span class="p">,</span> <span class="n">string</span>
</span></span></code></pre></div><p>Every flag variable has a default value, and a new value can be passed to it from command-line or config file. Take the previously <code>FLG_x</code> as an example, we can use <code>-x=23</code> in command line, or <code>x = 23</code> in the config file, to set a new value for it.</p>
<h3 id="command-line-flag"><a class="anchor" href="#command-line-flag">#</a>command line flag</h3>
<p>Command line parameters appear in the form of <code>-x=y</code>, where <code>x</code> is called a <strong>command line flag</strong> (hereinafter referred to as flag). The flag <code>x</code> in command line corresponds to the global variable <code>FLG_x</code> in the code, and <code>-x=y</code> in command line is equivalent to setting the value of <code>FLG_x</code> to <code>y</code>.</p>
<p><code>co.flag</code> is designed to be very flexible:</p>
<ul>
<li>
<p><code>-x=y</code> can omit the preceding <code>-</code>, abbreviated as <code>x=y</code>.</p>
</li>
<li>
<p><code>-x=y</code> can also be written as <code>-x y</code>.</p>
</li>
<li>
<p><code>x=y</code> can be preceded by any number of <code>-</code>.</p>
</li>
<li>
<p>For bool type flags, <code>-b=true</code> can be abbreviated as <code>-b</code>.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># b, i, s are all flags, xx is not a flag</span>
</span></span><span class="line"><span class="cl">./exe -b -i<span class="o">=</span><span class="m">32</span> -s<span class="o">=</span>hello xx
</span></span></code></pre></div><h2 id="apis"><a class="anchor" href="#apis">#</a>APIs</h2>
<h3 id="flagparse"><a class="anchor" href="#flagparse">#</a>flag::parse</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">co</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">fastring</span><span class="o">&gt;</span> <span class="n">parse</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">parse</span><span class="p">(</span><span class="k">const</span> <span class="n">fastring</span><span class="o">&amp;</span> <span class="n">path</span><span class="p">);</span>
</span></span></code></pre></div><ul>
<li>
<p>Added in v3.0.1.</p>
</li>
<li>
<p>The first parse function, parse the command line parameters and config file, and update value of the flag variables. It usually needs to be called once at the beginning of the main function. Generally speaking, it does the following steps:</p>
<ul>
<li>Preprocess the command line parameters, the value of <code>FLG_config</code> may be updated then.</li>
<li>If <code>FLG_config</code> is not empty, parse the config file specified by it, and update value of the flag variables.</li>
<li>Parse other command line parameters and update value of the flag variables.</li>
<li>If <code>FLG_mkconf</code> is true, generate a config file and terminate the program.</li>
<li>If <code>FLG_daemon</code> is true, run the program as a daemon (for Linux only).</li>
<li>When any error occurs, print the error message and terminate the program immediately.</li>
<li>If no error occurs, return the non-flag list. For example, when executing <code>./exe x y</code>, this function will return <code>[&quot;x&quot;, &quot;y&quot;]</code>.</li>
</ul>
</li>
<li>
<p>The second parse function, parses the config file and updates value of the flag variables. The parameter <code>path</code> is the path of the config file. When any error occurs, print the error message and terminate the program.</p>
</li>
</ul>
<blockquote class="book-hint warning">
  <strong>flag::init</strong><br>
Since v3.0.1，<code>flag::init()</code> has been marked as deprecated, please use <code>flag::parse()</code> instead.
</blockquote>

<ul>
<li>Example</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;co/flag.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="flagset_value"><a class="anchor" href="#flagset_value">#</a>flag::set_value</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">fastring</span> <span class="n">set_value</span><span class="p">(</span><span class="k">const</span> <span class="n">fastring</span><span class="o">&amp;</span> <span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="n">fastring</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>
<p>Added in v3.0. Set value of a flag variable, <code>name</code> is the flag name.</p>
</li>
<li>
<p>This function is not thread-safe and usually needs to be called at the beginning of the main function.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_int32</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span><span class="o">::</span><span class="n">set_value</span><span class="p">(</span><span class="s">&#34;b&#34;</span><span class="p">,</span> <span class="s">&#34;true&#34;</span><span class="p">);</span> <span class="c1">// FLG_b -&gt; true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">flag</span><span class="o">::</span><span class="n">set_value</span><span class="p">(</span><span class="s">&#34;i&#34;</span><span class="p">,</span> <span class="s">&#34;23&#34;</span><span class="p">);</span>   <span class="c1">// FLG_i -&gt; 23
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">flag</span><span class="o">::</span><span class="n">set_value</span><span class="p">(</span><span class="s">&#34;s&#34;</span><span class="p">,</span> <span class="s">&#34;xx&#34;</span><span class="p">);</span>   <span class="c1">// FLG_s -&gt; &#34;xx&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">flag</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="flagalias"><a class="anchor" href="#flagalias">#</a>flag::alias</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">alias</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">new_name</span><span class="p">);</span>
</span></span></code></pre></div><ul>
<li>
<p>Added in v3.0. Add an alias to a flag, in <strong>command line or config file</strong> you can replace the original name with the alias.</p>
</li>
<li>
<p>This function is not thread safe and needs to be called before <code>flag::parse()</code>.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">all</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="n">flag</span><span class="o">::</span><span class="n">alias</span><span class="p">(</span><span class="s">&#34;all&#34;</span><span class="p">,</span> <span class="s">&#34;a&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">flag</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="use-flag-variable-in-the-code"><a class="anchor" href="#use-flag-variable-in-the-code">#</a>Use flag variable in the code</h2>
<h3 id="define-a-flag-variable"><a class="anchor" href="#define-a-flag-variable">#</a>Define a flag variable</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_int32</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_int64</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_uint32</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_uint64</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_double</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="p">...)</span>
</span></span></code></pre></div><ul>
<li>
<p>The above 7 macros are used to define 7 different types of flag variables.</p>
</li>
<li>
<p>The parameter <code>name</code> is the flag name, the corresponding global variable name is <code>FLG_name</code>, the parameter <code>value</code> is the default value, and the parameter <code>help</code> is comment for the flag.</p>
</li>
<li>
<p>A flag variable is a global variable and generally should not be defined in the header file.</p>
</li>
<li>
<p>The name of the flag variable is unique, and we cannot define two flag variables with the same name.</p>
</li>
<li>
<p>The flag variable is generally defined outside the namespace, otherwise it may be not possible to use FLG_name to access the flag variable.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// bool FLG_b = false;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_int32</span><span class="p">(</span><span class="n">i32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// int32 FLG_i32 = 32;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_int64</span><span class="p">(</span><span class="n">i64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// int64 FLG_i64 = 64;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_uint32</span><span class="p">(</span><span class="n">u32</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// uint32 FLG_u32 = 0;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_uint64</span><span class="p">(</span><span class="n">u64</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// uint64 FLG_u64 = 0;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_double</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// double FLG_d = 2.0;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;x&#34;</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span> <span class="c1">// fastring&amp; FLG_s = ...;
</span></span></span></code></pre></div><blockquote class="book-hint info">
  Since v3.0.1, <code>DEF_string</code> actually defines a reference to <code>fastring</code>.
</blockquote>

<h3 id="add-alias-for-a-flag"><a class="anchor" href="#add-alias-for-a-flag">#</a>Add alias for a flag</h3>
<ul>
<li>
<p>Added in v3.0, when defining a flag variable, you can add any number of aliases to the flag.</p>
</li>
<li>
<p>In command line or config file, alias can be used instead of the original name.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>         <span class="c1">// no alias
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_bool</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span>      <span class="c1">// d is an alias of debug
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_bool</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">dbg</span><span class="p">);</span> <span class="c1">// 2 aliases
</span></span></span></code></pre></div><h3 id="declare-the-flag-variable"><a class="anchor" href="#declare-the-flag-variable">#</a>Declare the flag variable</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEC_bool</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_int32</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_int64</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_uint32</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_uint64</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_double</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_string</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>
<p>The 7 macros above are used to declare 7 different types of flag variables.</p>
</li>
<li>
<p>The parameter <code>name</code> is the flag name, and the corresponding global variable name is <code>FLG_name</code>.</p>
</li>
<li>
<p>A flag variable can be defined only once, but it can be declared multiple times, which can be declared wherever needed.</p>
</li>
<li>
<p>The flag variable is generally declared outside the namespace, otherwise it may be not possible to use FLG_name to access the flag variable.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEC_bool</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>     <span class="c1">// extern bool FLG_b;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEC_int32</span><span class="p">(</span><span class="n">i32</span><span class="p">);</span>  <span class="c1">// extern int32 FLG_i32;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEC_int64</span><span class="p">(</span><span class="n">i64</span><span class="p">);</span>  <span class="c1">// extern int64 FLG_i64;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEC_uint32</span><span class="p">(</span><span class="n">u32</span><span class="p">);</span> <span class="c1">// extern uint32 FLG_u32;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEC_uint64</span><span class="p">(</span><span class="n">u64</span><span class="p">);</span> <span class="c1">// extern uint64 FLG_u64;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEC_double</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>   <span class="c1">// extern double FLG_d;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEC_string</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>   <span class="c1">// extern fastring&amp; FLG_s;
</span></span></span></code></pre></div><h3 id="use-the-flag-variable"><a class="anchor" href="#use-the-flag-variable">#</a>Use the flag variable</h3>
<p>Once a flag variable is defined or declared, we can use it the same as an ordinary variable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;co/flag.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="n">DEC_bool</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;hello&#34;</span><span class="p">,</span> <span class="s">&#34;xxx&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">FLG_b</span><span class="p">)</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;b is false&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">FLG_s</span> <span class="o">+=</span> <span class="s">&#34; world&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">FLG_s</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="use-flag-in-command-line"><a class="anchor" href="#use-flag-in-command-line">#</a>Use flag in command line</h2>
<h3 id="set-value-of-flags"><a class="anchor" href="#set-value-of-flags">#</a>Set value of flags</h3>
<p>Suppose the following flags are defined in the program:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;bool x&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;bool y&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_int32</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="s">&#34;int32&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_uint64</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s">&#34;uint64&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;nice&#34;</span><span class="p">,</span> <span class="s">&#34;string&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>When the program starts, we can modify value of the flag variables through command line parameters:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># -x=y, x=y, -x y, the three are equivalent</span>
</span></span><span class="line"><span class="cl">./xx -i<span class="o">=</span><span class="m">8</span> <span class="nv">u</span><span class="o">=</span><span class="m">88</span> -s<span class="o">=</span>xxx
</span></span><span class="line"><span class="cl">./xx -i <span class="m">8</span> -u <span class="m">88</span> -s <span class="s2">&#34;hello world&#34;</span>
</span></span><span class="line"><span class="cl">./xx -i8       <span class="c1"># -i=8, only for single-letter named integer flags</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># When a bool type is set to true, the value can be omitted</span>
</span></span><span class="line"><span class="cl">./xx -x        <span class="c1"># -x=true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Multiple single-letter named bool flags can be combined and set to true</span>
</span></span><span class="line"><span class="cl">./xx -xy       <span class="c1"># -x=true -y=true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Integer type flags can have units k, m, g, t, p, not case sensitive</span>
</span></span><span class="line"><span class="cl">./xx -i -4k    <span class="c1"># i=-4096</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Integer type flags can pass octal or hexadecimal numbers</span>
</span></span><span class="line"><span class="cl">./xx <span class="nv">i</span><span class="o">=</span><span class="m">032</span>     <span class="c1"># i=26 octal</span>
</span></span><span class="line"><span class="cl">./xx <span class="nv">u</span><span class="o">=</span>0xff    <span class="c1"># u=255 hexadecimal</span>
</span></span></code></pre></div><h3 id="show-help-information"><a class="anchor" href="#show-help-information">#</a>Show Help Information</h3>
<p><code>co.flag</code> supports using <code>--help</code> command to print the help information of the program:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./xx --help
</span></span><span class="line"><span class="cl">usage:  <span class="nv">$exe</span> <span class="o">[</span>-flag<span class="o">]</span> <span class="o">[</span>value<span class="o">]</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$exe</span> -x -i 8k -s ok        <span class="c1"># x=true, i=8192, s=&#34;ok&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$exe</span> --                    <span class="c1"># print all flags</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$exe</span> -mkconf               <span class="c1"># generate config file</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$exe</span> -conf xx.conf         <span class="c1"># run with config file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flags:
</span></span><span class="line"><span class="cl">    -n  int32
</span></span><span class="line"><span class="cl">        type: int32       default: <span class="m">0</span>
</span></span><span class="line"><span class="cl">        from: test/flag.cc
</span></span><span class="line"><span class="cl">    -s  string
</span></span><span class="line"><span class="cl">        type: string      default: <span class="s2">&#34;hello world&#34;</span>
</span></span><span class="line"><span class="cl">        from: test/flag.cc
</span></span></code></pre></div><h3 id="list-all-flags"><a class="anchor" href="#list-all-flags">#</a>List all flags</h3>
<p><code>co.flag</code> provides <code>--</code> command to list all the flags defined in the program:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./xx --
</span></span><span class="line"><span class="cl">flags:
</span></span><span class="line"><span class="cl">    -boo  bool flag
</span></span><span class="line"><span class="cl">        type: bool        default: <span class="nb">false</span>
</span></span><span class="line"><span class="cl">        from: test/flag.cc
</span></span><span class="line"><span class="cl">    -co_sched_num  number of coroutine schedulers, default: os::cpunum<span class="o">()</span>
</span></span><span class="line"><span class="cl">        type: uint32      default: os::cpunum<span class="o">()</span>
</span></span><span class="line"><span class="cl">        from: src/co/sched.cc
</span></span></code></pre></div><h3 id="show-version-of-the-program"><a class="anchor" href="#show-version-of-the-program">#</a>Show version of the program</h3>
<ul>
<li>
<p><code>version</code> is a flag defined inside coost. You can use the <code>-version</code> command to print version information.</p>
</li>
<li>
<p><code>version</code> is empty by default, its value should be set before calling <code>flag::parse()</code>.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;co/flag.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="n">FLG_version</span> <span class="o">=</span> <span class="s">&#34;v3.0.0&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">flag</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./xx -version
</span></span><span class="line"><span class="cl">v3.0.0
</span></span></code></pre></div><h2 id="config-file"><a class="anchor" href="#config-file">#</a>config file</h2>
<h3 id="config-file-format"><a class="anchor" href="#config-file-format">#</a>config file format</h3>
<p>The config file format of <code>co.flag</code> is flexible:</p>
<ul>
<li>
<p>One config item per line, each config item corresponds to a flag, and the form is unified as <code>x = y</code>, which looks clear at a glance.</p>
</li>
<li>
<p><code>#</code> or <code>//</code> are for comments.</p>
</li>
<li>
<p><code>#</code> or <code>//</code> in quotation marks are not comments.</p>
</li>
<li>
<p>Ignore the blank characters at the beginning or end of the line.</p>
</li>
<li>
<p>Blank characters can be added before or after the <code>=</code> sign.</p>
</li>
<li>
<p><code>\</code> can be used to continue a line to avoid too long a line.</p>
</li>
<li>
<p>The string does not support escaping to avoid ambiguity.</p>
</li>
<li>
<p>The string can be enclosed in double quotes, single quotes or 3 back quotes.</p>
</li>
<li>
<p>Sample config file</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">   </span><span class="c"># config file: xx.conf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">boo = true                </span><span class="w"> </span><span class="c"># bool type</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">s =                       </span><span class="w"> </span><span class="c"># empty string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">s = hello \</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="l">world                 </span><span class="w"> </span><span class="c"># s = &#34;helloworld&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">s = &#34;http://github.com&#34;    #</span><span class="w"> </span><span class="c"># or // in quotation marks are not comments</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">s = &#34;I&#39;m ok&#34;              </span><span class="w"> </span><span class="c"># enclose the string in double quotes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">s =&#39;how are &#34;U&#34;&#39;          </span><span class="w"> </span><span class="c"># enclose the string in single quotes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">s = ```I&#39;m &#34;ok&#34;```        </span><span class="w"> </span><span class="c"># enclose the string in 3 back quotes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">i32 = 4k                  </span><span class="w"> </span><span class="c"># 4096, integers can have units k, m, g, t, p, not case sensitive</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">i32 = 032                 </span><span class="w"> </span><span class="c"># octal, i32 = 26</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">i32 = 0xff                </span><span class="w"> </span><span class="c"># hexadecimal, i32 = 255</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="l">pi = 3.14159              </span><span class="w"> </span><span class="c"># double type</span><span class="w">
</span></span></span></code></pre></div><h3 id="generate-config-file"><a class="anchor" href="#generate-config-file">#</a>Generate config file</h3>
<ul>
<li><code>mkconf</code> is a flag defined internally in coost, which is a switch for automatically generating config file.</li>
<li>You can use <code>-mkconf</code> to generate a config file in command line.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./xx -mkconf            <span class="c1"># Generate xx.conf</span>
</span></span><span class="line"><span class="cl">./xx -mkconf -x <span class="nv">u</span><span class="o">=</span><span class="m">88</span>    <span class="c1"># Custom config item value</span>
</span></span></code></pre></div><h3 id="adjust-the-order-of-config-items"><a class="anchor" href="#adjust-the-order-of-config-items">#</a>Adjust the order of config items</h3>
<p>In the automatically generated config file, the config items are sorted by flag level, file name, and code line number. If the user wants some config items to be ranked higher, the flag level can be set to a smaller value, otherwise, the flag level can be set to a larger value.</p>
<p>When defining a flag, you can use <code>#n</code> at the beginning of the comment to specify the flag level, <strong>n must be an integer between 0 and 9</strong>. If the comment is not empty, there must be a space after n. When not specified, the default flag level is 5.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;comments&#34;</span><span class="p">);</span>    <span class="c1">// The default level is 5
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_bool</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;#3&#34;</span><span class="p">);</span>          <span class="c1">// The level is 3, and the comment is empty
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DEF_bool</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;#3 comments&#34;</span><span class="p">);</span> <span class="c1">// The level is 3
</span></span></span></code></pre></div><h3 id="prohibit-config-items-from-being-generated-in-the-config-file"><a class="anchor" href="#prohibit-config-items-from-being-generated-in-the-config-file">#</a>Prohibit config items from being generated in the config file</h3>
<p>Flags whose comments start with <code>.</code>, are <strong>hidden flags</strong>, which will not be present in the config file, but can be found with the <code>--</code> command in command line. A flag with an empty comment is completely invisible and will neither be generated in the config file nor be found with the <code>--</code> command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">DEF_bool</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="s">&#34;.say something here&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">DEF_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;good&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span></code></pre></div><h3 id="specify-the-config-file-when-the-program-starts"><a class="anchor" href="#specify-the-config-file-when-the-program-starts">#</a>Specify the config file when the program starts</h3>
<ul>
<li><code>config</code> is a flag defined internally in coost, which is the path of the config file. It has an alias <code>conf</code>.</li>
<li>You can use <code>-config</code> to specify the config file in command line.</li>
<li>Another way, you can modify the value of <code>FLG_config</code> to specify the config file, before calling <code>flag::parse()</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./xx -config xx.conf
</span></span><span class="line"><span class="cl">./xx -conf xx.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># If the config file name ends with .conf or config, </span>
</span></span><span class="line"><span class="cl"><span class="c1"># and it is the first non-flag parameter in command line, </span>
</span></span><span class="line"><span class="cl"><span class="c1"># -config can be omitted.</span>
</span></span><span class="line"><span class="cl">./xx xx.conf
</span></span><span class="line"><span class="cl">./xx xx.conf -x
</span></span></code></pre></div><h2 id="custom-help-information"><a class="anchor" href="#custom-help-information">#</a>Custom help information</h2>
<ul>
<li>
<p><code>help</code> is a flag defined in coost, which stores the help information of the program. This information can be seen with the command <code>--help</code> in command line.</p>
</li>
<li>
<p><code>FLG_help</code> is empty by default, and the default help information provided by coost is used.</p>
</li>
<li>
<p>You can modify the value of <code>FLG_help</code> before calling <code>flag::parse()</code> to customize the help information.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;co/flag.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FLG_help</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;usage:</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">             <span class="o">&lt;&lt;</span> <span class="s">&#34;</span><span class="se">\t</span><span class="s">./xx -ip 127.0.0.1 -port 7777</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="run-program-as-a-daemon"><a class="anchor" href="#run-program-as-a-daemon">#</a>Run program as a daemon</h2>
<ul>
<li>
<p><code>daemon</code> is a flag defined in coost. If it is true, the program will run as a daemon. It only works on Linux platform.</p>
</li>
<li>
<p>You can use <code>-daemon</code> in command line to make the program run in the background as a daemon.</p>
</li>
<li>
<p>Example</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./xx -daemon
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

  



  
    
  
    
  


  


<div class="book-languages" tabindex="0" aria-haspopup="true">
  <ul>
    <li class="flex align-center">
      <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
      English
    </li> 
  </ul>

  <ul class="book-languages-list">
    
    <li class="">
      <a href="../../../cn/co/flag/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        中文
      </a>
    </li>
    
    <li class="active">
      <a href="../../../en/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </li>
    
  </ul>
</div>




  <div class="book-date"><a class="flex align-center" href="https://github.com/coostdocs/codoc/commit/265464652ec7af99f0d224db2a618227cb64a318" title='Last modified by idealvin | 2023/09/09' target="_blank" rel="noopener">
      <img src="../../../svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>2023/09/09</span>
    </a>
  </div>



  <div class="book-edit">
    <a class="flex align-center" href="https://github.com/coostdocs/codoc/edit/master/content/en/co/flag.md" target="_blank" rel="noopener">
      <img src="../../../svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        





<script src="//cdn.bootcss.com/highlight.js/11.1.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/cpp.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/bash.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/lua.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/yaml.min.js"></script>
<script>hljs.configure({ languages: [] }); hljs.initHighlightingOnLoad();</script>





      </footer>

      
  
  <div class="book-comments">


<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '11f9ff9ca43804d70b32',
    clientSecret: '07e2bd5b09a1654e7942a7698c3ec164e7566177',
    repo: 'gitalk',
    owner: 'idealvin',
    admin: ['idealvin'],
    id: location.pathname,
    language: 'zh-CN',
    distractionFreeMode: false,
    proxy: 'https:\/\/cors-anywhere.azm.workers.dev\/https:\/\/github.com\/login\/oauth\/access_token'
  })
  gitalk.render('gitalk-container');
</script></div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#basic-concepts">Basic concepts</a>
          <ul>
            <li><a href="#flag-variable">flag variable</a></li>
            <li><a href="#command-line-flag">command line flag</a></li>
          </ul>
        </li>
        <li><a href="#apis">APIs</a>
          <ul>
            <li><a href="#flagparse">flag::parse</a></li>
            <li><a href="#flagset_value">flag::set_value</a></li>
            <li><a href="#flagalias">flag::alias</a></li>
          </ul>
        </li>
        <li><a href="#use-flag-variable-in-the-code">Use flag variable in the code</a>
          <ul>
            <li><a href="#define-a-flag-variable">Define a flag variable</a></li>
            <li><a href="#add-alias-for-a-flag">Add alias for a flag</a></li>
            <li><a href="#declare-the-flag-variable">Declare the flag variable</a></li>
            <li><a href="#use-the-flag-variable">Use the flag variable</a></li>
          </ul>
        </li>
        <li><a href="#use-flag-in-command-line">Use flag in command line</a>
          <ul>
            <li><a href="#set-value-of-flags">Set value of flags</a></li>
            <li><a href="#show-help-information">Show Help Information</a></li>
            <li><a href="#list-all-flags">List all flags</a></li>
            <li><a href="#show-version-of-the-program">Show version of the program</a></li>
          </ul>
        </li>
        <li><a href="#config-file">config file</a>
          <ul>
            <li><a href="#config-file-format">config file format</a></li>
            <li><a href="#generate-config-file">Generate config file</a></li>
            <li><a href="#adjust-the-order-of-config-items">Adjust the order of config items</a></li>
            <li><a href="#prohibit-config-items-from-being-generated-in-the-config-file">Prohibit config items from being generated in the config file</a></li>
            <li><a href="#specify-the-config-file-when-the-program-starts">Specify the config file when the program starts</a></li>
          </ul>
        </li>
        <li><a href="#custom-help-information">Custom help information</a></li>
        <li><a href="#run-program-as-a-daemon">Run program as a daemon</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












