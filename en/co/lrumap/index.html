<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="include: co/lru_map.h.
#LruMap template &lt;typename K, typename V&gt; class LruMap; LruMap is a map implemented based on the LRU (least recently used) strategy. When the number of elements in the map reaches the upper limit, the least recently used data will be replaced first. It is implemented based on std::list and std::unordered_map, and the internal elements are unordered.
#LruMap::LruMap LruMap(); explicit LruMap(size_t capacity); The default constructor uses 1024 as the maximum capacity.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="LruMap" />
<meta property="og:description" content="include: co/lru_map.h.
#LruMap template &lt;typename K, typename V&gt; class LruMap; LruMap is a map implemented based on the LRU (least recently used) strategy. When the number of elements in the map reaches the upper limit, the least recently used data will be replaced first. It is implemented based on std::list and std::unordered_map, and the internal elements are unordered.
#LruMap::LruMap LruMap(); explicit LruMap(size_t capacity); The default constructor uses 1024 as the maximum capacity." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://coostdocs.github.io/en/co/lrumap/" /><meta property="article:section" content="co" />

<meta property="article:modified_time" content="2021-08-02T00:06:00+08:00" />

<title>LruMap | Documents for Coost</title>
<link rel="manifest" href="../../../manifest.json">
<link rel="icon" href="../../../favicon.png" type="image/x-icon">
  <link rel="alternate" hreflang="cn" href="https://coostdocs.github.io/cn/co/lrumap/" title="LruMap">
<link rel="stylesheet" href="../../../book.min.0608a3570dae40fa4b3de520d6a873cc9855bb4cb5001c4b16e95a226b84aff8.css" integrity="sha256-BgijVw2uQPpLPeUg1qhzzJhVu0y1ABxLFulaImuEr/g=" crossorigin="anonymous">
  <script defer src="../../../flexsearch.min.js"></script>
  <script defer src="../../../en.search.min.2f8c64aded301f9040a312bb68992574600e80434dd9736f182e4ce7ae2a7710.js" integrity="sha256-L4xkre0wH5BAoxK7aJkldGAOgENN2XNvGC5M564qdxA=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  


<link href='//cdn.bootcss.com/highlight.js/11.1.0/styles/github.min.css'
  rel='stylesheet' type='text/css' />


</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="../../../cn/"><span>Documents for Coost</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>About</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/co/" class="">Introduction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/contact/" class="">Contact</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/about/sponsor/" class="">SponsorðŸ’•</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>Documents for CO</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/def/" class="">Basic definitions</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/defer/" class="">defer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/atomic/" class="">Atomic Operations</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/fastring/" class="">fastring</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/fastream/" class="">fastream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/str/" class="">String utilities</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/flag/" class="">co/flag</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/log/" class="">co/log</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/unitest/" class="">Unitest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/json/" class="">JSON</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/time/" class="">Time</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/thread/" class="">Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/coroutine/" class="">Coroutine</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-752f64a904309658adbf6062b2c3d8c1" class="toggle"  />
    <label for="section-752f64a904309658adbf6062b2c3d8c1" class="flex justify-between">
      <a role="button" class="">Network Programming</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/byte_order/" class="">Byte order</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/tcp/" class="">TCP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/http/" class="">HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/net/rpc/" class="">RPC</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/tasked/" class="">Timed task scheduler</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/random/" class="">Random number</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/lrumap/" class=" active">LruMap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/hash/" class="">Hash</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/path/" class="">Path</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/fs/" class="">File System</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/os/" class="">Operating System</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../en/co/build/" class="">Compiling</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>LruMap</strong>

  <label for="toc-control">
    
    <img src="../../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#lrumap">LruMap</a>
          <ul>
            <li><a href="#lrumaplrumap">LruMap::LruMap</a></li>
            <li><a href="#lrumapbegin">LruMap::begin</a></li>
            <li><a href="#lrumapclear">LruMap::clear</a></li>
            <li><a href="#lrumapempty">LruMap::empty</a></li>
            <li><a href="#lrumapend">LruMap::end</a></li>
            <li><a href="#lrumaperase">LruMap::erase</a></li>
            <li><a href="#lrumapfind">LruMap::find</a></li>
            <li><a href="#lrumapinsert">LruMap::insert</a></li>
            <li><a href="#lrumapsize">LruMap::size</a></li>
            <li><a href="#lrumapswap">LruMap::swap</a></li>
            <li><a href="#code-example">Code example</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><p>include: <a href="https://github.com/idealvin/co/blob/master/include/co/lru_map.h">co/lru_map.h</a>.</p>
<h2 id="lrumap"><a class="anchor" href="#lrumap">#</a>LruMap</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">template</span> <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">typename</span> K, <span style="color:#000;font-weight:bold">typename</span> V<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">LruMap</span>;
</span></span></code></pre></div><p><code>LruMap</code> is a map implemented based on the LRU (least recently used) strategy. When the number of elements in the map reaches the upper limit, the least recently used data will be replaced first. It is implemented based on std::list and std::unordered_map, and the internal elements are unordered.</p>
<h3 id="lrumaplrumap"><a class="anchor" href="#lrumaplrumap">#</a>LruMap::LruMap</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>LruMap();
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">explicit</span> <span style="color:#900;font-weight:bold">LruMap</span>(size_t capacity);
</span></span></code></pre></div><ul>
<li>The default constructor uses 1024 as the maximum capacity.</li>
<li>The second constructor takes the parameter capacity as the maximum capacity.</li>
</ul>
<h3 id="lrumapbegin"><a class="anchor" href="#lrumapbegin">#</a>LruMap::begin</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>iterator <span style="color:#900;font-weight:bold">begin</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Returns an iterator pointing to the first element. When LruMap is empty, the return value is equal to LruMap::end().</li>
</ul>
<h3 id="lrumapclear"><a class="anchor" href="#lrumapclear">#</a>LruMap::clear</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">clear</span>();
</span></span></code></pre></div><ul>
<li>This method clears the elements in LruMap, size() will become 0, and the capacity will remain unchanged.</li>
</ul>
<h3 id="lrumapempty"><a class="anchor" href="#lrumapempty">#</a>LruMap::empty</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">bool</span> <span style="color:#900;font-weight:bold">empty</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>This method determines whether LruMap is empty.</li>
</ul>
<h3 id="lrumapend"><a class="anchor" href="#lrumapend">#</a>LruMap::end</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>iterator <span style="color:#900;font-weight:bold">end</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Returns an iterator pointing to the next position of the last element, it does not point to any element itself. When LruMap is empty, begin() and end() are equal.</li>
</ul>
<h3 id="lrumaperase"><a class="anchor" href="#lrumaperase">#</a>LruMap::erase</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">erase</span>(iterator it);
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">erase</span>(<span style="color:#000;font-weight:bold">const</span> key_type<span style="color:#000;font-weight:bold">&amp;</span> key);
</span></span></code></pre></div><ul>
<li>Erase an element through iterator or key.</li>
</ul>
<h3 id="lrumapfind"><a class="anchor" href="#lrumapfind">#</a>LruMap::find</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>iterator find(<span style="color:#000;font-weight:bold">const</span> key_type<span style="color:#000;font-weight:bold">&amp;</span> key)
</span></span></code></pre></div><ul>
<li>This method finds an element by key, and returns an iterator refer to the element if it is found, otherwise the return value is equal to end().</li>
</ul>
<h3 id="lrumapinsert"><a class="anchor" href="#lrumapinsert">#</a>LruMap::insert</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">template</span> <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">typename</span> Key, <span style="color:#000;font-weight:bold">typename</span> Val<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> insert(Key<span style="color:#000;font-weight:bold">&amp;&amp;</span> key, Val<span style="color:#000;font-weight:bold">&amp;&amp;</span> value);
</span></span></code></pre></div><ul>
<li>Insert an element, only when the key does not exist, it will insert a new element. If the key already exists, no operation will be performed.</li>
<li>During the insert operation, if the number of elements has reached the maximum capacity, the least recently accessed element will be removed.</li>
</ul>
<h3 id="lrumapsize"><a class="anchor" href="#lrumapsize">#</a>LruMap::size</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>size_t <span style="color:#900;font-weight:bold">size</span>() <span style="color:#000;font-weight:bold">const</span>;
</span></span></code></pre></div><ul>
<li>Returns the number of elements in LruMap.</li>
</ul>
<h3 id="lrumapswap"><a class="anchor" href="#lrumapswap">#</a>LruMap::swap</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">swap</span>(LruMap<span style="color:#000;font-weight:bold">&amp;</span> x) <span style="color:#000;font-weight:bold">noexcept</span>;
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">swap</span>(LruMap<span style="color:#000;font-weight:bold">&amp;&amp;</span> x) <span style="color:#000;font-weight:bold">noexcept</span>;
</span></span></code></pre></div><ul>
<li>Exchange the contents of two LruMaps. This operation only exchanges internal pointers, size, and capacity.</li>
</ul>
<h3 id="code-example"><a class="anchor" href="#code-example">#</a>Code example</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>LruMap<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#458;font-weight:bold">int</span>, <span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">&gt;</span> m(<span style="color:#099">128</span>); <span style="color:#998;font-style:italic">// capacity: 128
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">auto</span> it <span style="color:#000;font-weight:bold">=</span> m.find(<span style="color:#099">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> (it <span style="color:#000;font-weight:bold">==</span> m.end()) {
</span></span><span style="display:flex;"><span>    m.insert(<span style="color:#099">1</span>, <span style="color:#099">23</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>    it<span style="color:#000;font-weight:bold">-&gt;</span>second <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m.erase(it);        <span style="color:#998;font-style:italic">// erase by iterator
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>m.erase(it<span style="color:#000;font-weight:bold">-&gt;</span>first); <span style="color:#998;font-style:italic">// erase by key
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>m.clear();          <span style="color:#998;font-style:italic">// clear the map
</span></span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

  



  
    
  
    
  


  


<div class="book-languages" tabindex="0" aria-haspopup="true">
  <ul>
    <li class="flex align-center">
      <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
      English
    </li> 
  </ul>

  <ul class="book-languages-list">
    
    <li class="">
      <a href="../../../cn/co/lrumap/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        ä¸­æ–‡
      </a>
    </li>
    
    <li class="active">
      <a href="../../../en/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </li>
    
  </ul>
</div>




  <div class="book-date"><a class="flex align-center" href="https://github.com/cocoyaxi/codoc/commit/0f6eef5e1f89354b56d0da1de637b1fd139726ab" title='Last modified by idealvin | August 2, 2021' target="_blank" rel="noopener">
      <img src="../../../svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>August 2, 2021</span>
    </a>
  </div>



  <div class="book-edit">
    <a class="flex align-center" href="https://github.com/cocoyaxi/codoc/edit/master/content/en/co/lrumap.md" target="_blank" rel="noopener">
      <img src="../../../svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>

</div>

 
        





<script src="//cdn.bootcss.com/highlight.js/11.1.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/cpp.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/bash.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/lua.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/yaml.min.js"></script>
<script>hljs.configure({ languages: [] }); hljs.initHighlightingOnLoad();</script>





      </footer>

      
  
  <div class="book-comments">


<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '11f9ff9ca43804d70b32',
    clientSecret: '07e2bd5b09a1654e7942a7698c3ec164e7566177',
    repo: 'gitalk',
    owner: 'idealvin',
    admin: ['idealvin'],
    id: location.pathname,
    language: 'zh-CN',
    distractionFreeMode: false,
    proxy: 'https:\/\/cors-anywhere.azm.workers.dev\/https:\/\/github.com\/login\/oauth\/access_token'
  })
  gitalk.render('gitalk-container');
</script></div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#lrumap">LruMap</a>
          <ul>
            <li><a href="#lrumaplrumap">LruMap::LruMap</a></li>
            <li><a href="#lrumapbegin">LruMap::begin</a></li>
            <li><a href="#lrumapclear">LruMap::clear</a></li>
            <li><a href="#lrumapempty">LruMap::empty</a></li>
            <li><a href="#lrumapend">LruMap::end</a></li>
            <li><a href="#lrumaperase">LruMap::erase</a></li>
            <li><a href="#lrumapfind">LruMap::find</a></li>
            <li><a href="#lrumapinsert">LruMap::insert</a></li>
            <li><a href="#lrumapsize">LruMap::size</a></li>
            <li><a href="#lrumapswap">LruMap::swap</a></li>
            <li><a href="#code-example">Code example</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












