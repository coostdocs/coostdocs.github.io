<!DOCTYPE html>
<html lang="cn" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="include: co/log.h.
#ÁÆÄ‰ªã co/log ÊòØ‰∏Ä‰∏™Á±ª‰ºº google glog ÁöÑ C&#43;&#43; ÊµÅÂºèÊó•ÂøóÂ∫ìÔºåÂÆÉÂÉè‰∏ãÈù¢ËøôÊ†∑ÊâìÂç∞Êó•ÂøóÔºö
LOG &lt;&lt; &#34;hello world&#34; &lt;&lt; 23; // level log TLOG(&#34;topic&#34;) &lt;&lt; &#34;hello&#34; &lt;&lt; 23; // topic log co/log ÊîØÊåÅ‰∏§ÁßçÁ±ªÂûãÁöÑÊó•ÂøóÔºålevel log ‰∏é topic log(TLOG)„ÄÇ
#Level Log Level log ÂàÜ‰∏∫ debug, info, warning, error, fatal 5 ‰∏™Á∫ßÂà´ÔºåÂπ∂Êèê‰æõ‰∏ÄÁ≥ªÂàóÁöÑÂÆèÔºåÁî®‰∫éÊâìÂç∞‰∏çÂêåÁ∫ßÂà´ÁöÑÊó•Âøó„ÄÇ
ÊâìÂç∞ fatal Á∫ßÂà´ÁöÑÊó•Âøó‰ºöÁªàÊ≠¢Á®ãÂ∫èÁöÑËøêË°åÔºåco/log Ëøò‰ºöÂú®Á®ãÂ∫èÈÄÄÂá∫ÂâçÊâìÂç∞ÂáΩÊï∞Ë∞ÉÁî®Ê†à‰ø°ÊÅØÔºå‰ª•Êñπ‰æøËøΩÊü•Á®ãÂ∫èÂ¥©Ê∫ÉÁöÑÂéüÂõ†„ÄÇ
Ê≠§Á±ªÂûãÁöÑÊó•Âøó‰ºöÂÜôÂÖ•Âêå‰∏Ä‰∏™Êñá‰ª∂‰∏≠Ôºå‰∏ÄËà¨Áî®‰∫éÊâìÂç∞Ë∞ÉËØï‰ø°ÊÅØ„ÄÇ
#Topic Log Topic log(TLOG) Ê≤°ÊúâÁ∫ßÂà´‰πãÂàÜÔºåËÄåÊòØÊåâ‰∏ªÈ¢òÂàÜÁ±ª„ÄÇ
Ê≠§Á±ªÂûãÁöÑÊó•ÂøóÔºåÊåâ‰∏ªÈ¢òÂÜôÂÖ•‰∏çÂêåÁöÑÊñá‰ª∂Ôºå‰∏ÄËà¨Áî®‰∫éÊâìÂç∞‰∏öÂä°Êó•ÂøóÔºåÊåâ‰∏öÂä°ÂäüËÉΩÂàíÂàÜÔºå‰æø‰∫éÊó•ÂøóÁÆ°ÁêÜ„ÄÇ
#ÊÄßËÉΩ co/log ÂÜÖÈÉ®ÈááÁî®ÂºÇÊ≠•ÁöÑÂÆûÁé∞ÊñπÂºèÔºåÊó•ÂøóÂÖàÂÜôÂÖ•ÁºìÂ≠òÔºåËææÂà∞‰∏ÄÂÆöÈáèÊàñË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥ÂêéÔºåÁî±ÂêéÂè∞Á∫øÁ®ã‰∏ÄÊ¨°ÊÄßÂÜôÂÖ•Êñá‰ª∂ÔºåÊÄßËÉΩÂú®‰∏çÂêåÂπ≥Âè∞ÊØî glog ÊèêÂçá‰∫Ü 20~150 ÂÄçÂ∑¶Âè≥„ÄÇ‰∏ãË°®ÊòØ‰∏çÂêåÂπ≥Âè∞ÂçïÁ∫øÁ®ãËøûÁª≠ÊâìÂç∞ 100 ‰∏áÊù°(ÊØèÊù° 50 Â≠óËäÇÂ∑¶Âè≥) info Êó•ÂøóÁöÑÊµãËØïÁªìÊûúÔºö
platform google glog co/log win2012 HHD 1.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Êó•Âøó" />
<meta property="og:description" content="include: co/log.h.
#ÁÆÄ‰ªã co/log ÊòØ‰∏Ä‰∏™Á±ª‰ºº google glog ÁöÑ C&#43;&#43; ÊµÅÂºèÊó•ÂøóÂ∫ìÔºåÂÆÉÂÉè‰∏ãÈù¢ËøôÊ†∑ÊâìÂç∞Êó•ÂøóÔºö
LOG &lt;&lt; &#34;hello world&#34; &lt;&lt; 23; // level log TLOG(&#34;topic&#34;) &lt;&lt; &#34;hello&#34; &lt;&lt; 23; // topic log co/log ÊîØÊåÅ‰∏§ÁßçÁ±ªÂûãÁöÑÊó•ÂøóÔºålevel log ‰∏é topic log(TLOG)„ÄÇ
#Level Log Level log ÂàÜ‰∏∫ debug, info, warning, error, fatal 5 ‰∏™Á∫ßÂà´ÔºåÂπ∂Êèê‰æõ‰∏ÄÁ≥ªÂàóÁöÑÂÆèÔºåÁî®‰∫éÊâìÂç∞‰∏çÂêåÁ∫ßÂà´ÁöÑÊó•Âøó„ÄÇ
ÊâìÂç∞ fatal Á∫ßÂà´ÁöÑÊó•Âøó‰ºöÁªàÊ≠¢Á®ãÂ∫èÁöÑËøêË°åÔºåco/log Ëøò‰ºöÂú®Á®ãÂ∫èÈÄÄÂá∫ÂâçÊâìÂç∞ÂáΩÊï∞Ë∞ÉÁî®Ê†à‰ø°ÊÅØÔºå‰ª•Êñπ‰æøËøΩÊü•Á®ãÂ∫èÂ¥©Ê∫ÉÁöÑÂéüÂõ†„ÄÇ
Ê≠§Á±ªÂûãÁöÑÊó•Âøó‰ºöÂÜôÂÖ•Âêå‰∏Ä‰∏™Êñá‰ª∂‰∏≠Ôºå‰∏ÄËà¨Áî®‰∫éÊâìÂç∞Ë∞ÉËØï‰ø°ÊÅØ„ÄÇ
#Topic Log Topic log(TLOG) Ê≤°ÊúâÁ∫ßÂà´‰πãÂàÜÔºåËÄåÊòØÊåâ‰∏ªÈ¢òÂàÜÁ±ª„ÄÇ
Ê≠§Á±ªÂûãÁöÑÊó•ÂøóÔºåÊåâ‰∏ªÈ¢òÂÜôÂÖ•‰∏çÂêåÁöÑÊñá‰ª∂Ôºå‰∏ÄËà¨Áî®‰∫éÊâìÂç∞‰∏öÂä°Êó•ÂøóÔºåÊåâ‰∏öÂä°ÂäüËÉΩÂàíÂàÜÔºå‰æø‰∫éÊó•ÂøóÁÆ°ÁêÜ„ÄÇ
#ÊÄßËÉΩ co/log ÂÜÖÈÉ®ÈááÁî®ÂºÇÊ≠•ÁöÑÂÆûÁé∞ÊñπÂºèÔºåÊó•ÂøóÂÖàÂÜôÂÖ•ÁºìÂ≠òÔºåËææÂà∞‰∏ÄÂÆöÈáèÊàñË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥ÂêéÔºåÁî±ÂêéÂè∞Á∫øÁ®ã‰∏ÄÊ¨°ÊÄßÂÜôÂÖ•Êñá‰ª∂ÔºåÊÄßËÉΩÂú®‰∏çÂêåÂπ≥Âè∞ÊØî glog ÊèêÂçá‰∫Ü 20~150 ÂÄçÂ∑¶Âè≥„ÄÇ‰∏ãË°®ÊòØ‰∏çÂêåÂπ≥Âè∞ÂçïÁ∫øÁ®ãËøûÁª≠ÊâìÂç∞ 100 ‰∏áÊù°(ÊØèÊù° 50 Â≠óËäÇÂ∑¶Âè≥) info Êó•ÂøóÁöÑÊµãËØïÁªìÊûúÔºö
platform google glog co/log win2012 HHD 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://coostdocs.github.io/cn/co/log/" /><meta property="article:section" content="co" />

<meta property="article:modified_time" content="2022-09-19T20:44:32+08:00" />

<title>Êó•Âøó | Documents for Coost</title>
<link rel="manifest" href="../../../manifest.json">
<link rel="icon" href="../../../favicon.png" type="image/x-icon">
  <link rel="alternate" hreflang="en" href="https://coostdocs.github.io/en/co/log/" title="co/log">
<link rel="stylesheet" href="../../../book.min.34012a023bb86e99e9c5d444ca11c3e38625a1b8f226bf07e2360827bb149b14.css" integrity="sha256-NAEqAju4bpnpxdREyhHD44YlobjyJr8H4jYIJ7sUmxQ=" crossorigin="anonymous">
  <script defer src="../../../flexsearch.min.js"></script>
  <script defer src="../../../cn.search.min.f2f8f9cac63bf8044b0a1ec22aaecb38a4f829ded1cce9ae4558d3741a7849f5.js" integrity="sha256-8vj5ysY7&#43;ARLCh7CKq7LOKT4Kd7RzOmuRVjTdBp4SfU=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  


<link href='//cdn.bootcss.com/highlight.js/11.1.0/styles/github.min.css'
  rel='stylesheet' type='text/css' />


</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="../../../cn/"><span>Documents for Coost</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="ÊêúÁ¥¢" aria-label="ÊêúÁ¥¢" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>ÂÖ≥‰∫é</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/about/co/" class="">ÁÆÄ‰ªã</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/about/contact/" class="">ËÅîÁ≥ª</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/about/sponsor/" class="">ËµûÂä©üíï</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>CO ÂèÇËÄÉÊñáÊ°£</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/def/" class="">Âü∫Êú¨ÂÆö‰πâ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/defer/" class="">defer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/atomic/" class="">ÂéüÂ≠êÊìç‰Ωú</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/fastring/" class="">Â≠óÁ¨¶‰∏≤(fastring)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/fastream/" class="">Â≠óÁ¨¶ÊµÅ(fastream)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/str/" class="">Â≠óÁ¨¶‰∏≤Êìç‰Ωú</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/flag/" class="">ÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏éÈÖçÁΩÆÊñá‰ª∂Ëß£Êûê</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/log/" class=" active">Êó•Âøó</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/unitest/" class="">ÂçïÂÖÉÊµãËØïÊ°ÜÊû∂</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/json/" class="">JSON</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/time/" class="">Êó∂Èó¥</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/thread/" class="">Á∫øÁ®ã</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/coroutine/" class="">ÂçèÁ®ã</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-752f64a904309658adbf6062b2c3d8c1" class="toggle"  />
    <label for="section-752f64a904309658adbf6062b2c3d8c1" class="flex justify-between">
      <a role="button" class="">ÁΩëÁªúÁºñÁ®ã</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/byte_order/" class="">Â≠óËäÇÂ∫è</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/tcp/" class="">TCP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/http/" class="">HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/rpc/" class="">RPC</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/tasked/" class="">ÂÆöÊó∂‰ªªÂä°</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/random/" class="">ÈöèÊú∫Êï∞</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/lrumap/" class="">LruMap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/hash/" class="">Hash</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/path/" class="">Êñá‰ª∂Ë∑ØÂæÑ(path)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/fs/" class="">Êñá‰ª∂Á≥ªÁªü</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/os/" class="">Êìç‰ΩúÁ≥ªÁªü</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/build/" class="">ÁºñËØë</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>markdownÊñáÊ°£Á§∫‰æã</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/demo/demo/" class="">markdownÊ®°ÊùøÊñáÊ°£</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Êó•Âøó</strong>

  <label for="toc-control">
    
    <img src="../../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#ÁÆÄ‰ªã">ÁÆÄ‰ªã</a>
          <ul>
            <li><a href="#level-log">Level Log</a></li>
            <li><a href="#topic-log">Topic Log</a></li>
            <li><a href="#ÊÄßËÉΩ">ÊÄßËÉΩ</a></li>
          </ul>
        </li>
        <li><a href="#api">API</a>
          <ul>
            <li><a href="#logexit">log::exit</a></li>
            <li><a href="#logset_write_cb">log::set_write_cb</a></li>
            <li><a href="#v30-Âà†Èô§ÁöÑ-api">v3.0 Âà†Èô§ÁöÑ API</a></li>
          </ul>
        </li>
        <li><a href="#level-log-1">Level Log</a>
          <ul>
            <li><a href="#Âü∫Êú¨Áî®Ê≥ï">Âü∫Êú¨Áî®Ê≥ï</a></li>
            <li><a href="#Êù°‰ª∂Êó•Âøó">Êù°‰ª∂Êó•Âøó</a></li>
            <li><a href="#ÊØè-n-Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•Âøó">ÊØè N Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•Âøó</a></li>
            <li><a href="#ÊâìÂç∞Ââç-n-Êù°Êó•Âøó">ÊâìÂç∞Ââç N Êù°Êó•Âøó</a></li>
          </ul>
        </li>
        <li><a href="#tlog">TLOG</a></li>
        <li><a href="#check-Êñ≠Ë®Ä">CHECK Êñ≠Ë®Ä</a></li>
        <li><a href="#ÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ">ÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ</a></li>
        <li><a href="#ÈÖçÁΩÆÈ°π">ÈÖçÁΩÆÈ°π</a>
          <ul>
            <li><a href="#log_dir">log_dir</a></li>
            <li><a href="#log_file_name">log_file_name</a></li>
            <li><a href="#min_log_level">min_log_level</a></li>
            <li><a href="#max_log_size">max_log_size</a></li>
            <li><a href="#max_log_file_size">max_log_file_size</a></li>
            <li><a href="#max_log_file_num">max_log_file_num</a></li>
            <li><a href="#max_log_buffer_size">max_log_buffer_size</a></li>
            <li><a href="#log_flush_ms">log_flush_ms</a></li>
            <li><a href="#log_daily">log_daily</a></li>
            <li><a href="#cout">cout</a></li>
          </ul>
        </li>
        <li><a href="#Êó•ÂøóÊñá‰ª∂">Êó•ÂøóÊñá‰ª∂</a>
          <ul>
            <li><a href="#Êó•ÂøóÁªÑÁªáÊñπÂºè">Êó•ÂøóÁªÑÁªáÊñπÂºè</a></li>
            <li><a href="#Êó•ÂøóÊ†ºÂºè">Êó•ÂøóÊ†ºÂºè</a></li>
            <li><a href="#Êü•ÁúãÊó•Âøó">Êü•ÁúãÊó•Âøó</a></li>
          </ul>
        </li>
        <li><a href="#ÊûÑÂª∫ÂèäËøêË°å-colog-ÊµãËØïÁ®ãÂ∫è">ÊûÑÂª∫ÂèäËøêË°å co/log ÊµãËØïÁ®ãÂ∫è</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><p>include: <a href="https://github.com/idealvin/co/blob/master/include/co/log.h">co/log.h</a>.</p>
<h2 id="ÁÆÄ‰ªã"><a class="anchor" href="#%e7%ae%80%e4%bb%8b">#</a>ÁÆÄ‰ªã</h2>
<p><code>co/log</code> ÊòØ‰∏Ä‰∏™Á±ª‰ºº <a href="https://github.com/google/glog">google glog</a> ÁöÑ C++ ÊµÅÂºèÊó•ÂøóÂ∫ìÔºåÂÆÉÂÉè‰∏ãÈù¢ËøôÊ†∑ÊâìÂç∞Êó•ÂøóÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello world&#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;     <span style="color:#998;font-style:italic">// level log
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>TLOG(<span style="color:#d14">&#34;topic&#34;</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello&#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>; <span style="color:#998;font-style:italic">// topic log
</span></span></span></code></pre></div><p>co/log ÊîØÊåÅ‰∏§ÁßçÁ±ªÂûãÁöÑÊó•ÂøóÔºålevel log ‰∏é topic log(TLOG)„ÄÇ</p>
<h3 id="level-log"><a class="anchor" href="#level-log">#</a>Level Log</h3>
<p>Level log ÂàÜ‰∏∫ debug, info, warning, error, fatal 5 ‰∏™Á∫ßÂà´ÔºåÂπ∂Êèê‰æõ‰∏ÄÁ≥ªÂàóÁöÑÂÆèÔºåÁî®‰∫éÊâìÂç∞‰∏çÂêåÁ∫ßÂà´ÁöÑÊó•Âøó„ÄÇ</p>
<p><strong>ÊâìÂç∞ fatal Á∫ßÂà´ÁöÑÊó•Âøó‰ºöÁªàÊ≠¢Á®ãÂ∫èÁöÑËøêË°å</strong>Ôºåco/log Ëøò‰ºöÂú®Á®ãÂ∫èÈÄÄÂá∫ÂâçÊâìÂç∞ÂáΩÊï∞Ë∞ÉÁî®Ê†à‰ø°ÊÅØÔºå‰ª•Êñπ‰æøËøΩÊü•Á®ãÂ∫èÂ¥©Ê∫ÉÁöÑÂéüÂõ†„ÄÇ</p>
<p>Ê≠§Á±ªÂûãÁöÑÊó•Âøó‰ºöÂÜôÂÖ•Âêå‰∏Ä‰∏™Êñá‰ª∂‰∏≠Ôºå‰∏ÄËà¨Áî®‰∫éÊâìÂç∞Ë∞ÉËØï‰ø°ÊÅØ„ÄÇ</p>
<h3 id="topic-log"><a class="anchor" href="#topic-log">#</a>Topic Log</h3>
<p>Topic log(TLOG) Ê≤°ÊúâÁ∫ßÂà´‰πãÂàÜÔºåËÄåÊòØÊåâ‰∏ªÈ¢òÂàÜÁ±ª„ÄÇ</p>
<p>Ê≠§Á±ªÂûãÁöÑÊó•ÂøóÔºåÊåâ‰∏ªÈ¢òÂÜôÂÖ•‰∏çÂêåÁöÑÊñá‰ª∂Ôºå‰∏ÄËà¨Áî®‰∫éÊâìÂç∞‰∏öÂä°Êó•ÂøóÔºåÊåâ‰∏öÂä°ÂäüËÉΩÂàíÂàÜÔºå‰æø‰∫éÊó•ÂøóÁÆ°ÁêÜ„ÄÇ</p>
<h3 id="ÊÄßËÉΩ"><a class="anchor" href="#%e6%80%a7%e8%83%bd">#</a>ÊÄßËÉΩ</h3>
<p>co/log ÂÜÖÈÉ®ÈááÁî®ÂºÇÊ≠•ÁöÑÂÆûÁé∞ÊñπÂºèÔºåÊó•ÂøóÂÖàÂÜôÂÖ•ÁºìÂ≠òÔºåËææÂà∞‰∏ÄÂÆöÈáèÊàñË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥ÂêéÔºåÁî±ÂêéÂè∞Á∫øÁ®ã‰∏ÄÊ¨°ÊÄßÂÜôÂÖ•Êñá‰ª∂ÔºåÊÄßËÉΩÂú®‰∏çÂêåÂπ≥Âè∞ÊØî glog ÊèêÂçá‰∫Ü 20~150 ÂÄçÂ∑¶Âè≥„ÄÇ‰∏ãË°®ÊòØ‰∏çÂêåÂπ≥Âè∞ÂçïÁ∫øÁ®ãËøûÁª≠ÊâìÂç∞ 100 ‰∏áÊù°(ÊØèÊù° 50 Â≠óËäÇÂ∑¶Âè≥) info Êó•ÂøóÁöÑÊµãËØïÁªìÊûúÔºö</p>
<table>
<thead>
<tr>
<th>platform</th>
<th>google glog</th>
<th>co/log</th>
</tr>
</thead>
<tbody>
<tr>
<td>win2012 HHD</td>
<td>1.6MB/s</td>
<td>180MB/s</td>
</tr>
<tr>
<td>win10 SSD</td>
<td>3.7MB/s</td>
<td>560MB/s</td>
</tr>
<tr>
<td>mac SSD</td>
<td>17MB/s</td>
<td>450MB/s</td>
</tr>
<tr>
<td>linux SSD</td>
<td>54MB/s</td>
<td>1023MB/s</td>
</tr>
</tbody>
</table>
<h2 id="api"><a class="anchor" href="#api">#</a>API</h2>
<h3 id="logexit"><a class="anchor" href="#logexit">#</a>log::exit</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">exit</span>();
</span></span></code></pre></div><ul>
<li>Â∞ÜÁºìÂ≠ò‰∏≠ÁöÑÊó•ÂøóÂÜôÂÖ•Êñá‰ª∂ÔºåÂπ∂ÈÄÄÂá∫ÂêéÂè∞ÂÜôÊó•ÂøóÁöÑÁ∫øÁ®ã„ÄÇ</li>
<li>Á®ãÂ∫èÊ≠£Â∏∏ÈÄÄÂá∫Êó∂Ôºåco/log ‰ºöËá™Âä®Ë∞ÉÁî®Ê≠§ÂáΩÊï∞„ÄÇ</li>
<li>Â§öÊ¨°Ë∞ÉÁî®Ê≠§ÂáΩÊï∞ÊòØÂÆâÂÖ®ÁöÑ„ÄÇ</li>
<li>co/log ÂÜÖÈÉ®ÊçïËé∑Âà∞ <code>SIGINT, SIGTERM, SIGQUIT</code> Á≠â‰ø°Âè∑Êó∂Ôºå‰ºöÂú®Á®ãÂ∫èÈÄÄÂá∫ÂâçË∞ÉÁî®Ê≠§ÂáΩÊï∞„ÄÇ</li>
</ul>
<h3 id="logset_write_cb"><a class="anchor" href="#logset_write_cb">#</a>log::set_write_cb</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">set_write_cb</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">const</span> std<span style="color:#000;font-weight:bold">::</span>function<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#458;font-weight:bold">void</span>(<span style="color:#000;font-weight:bold">const</span> <span style="color:#458;font-weight:bold">void</span><span style="color:#000;font-weight:bold">*</span>, size_t)<span style="color:#000;font-weight:bold">&gt;&amp;</span> cb,
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> flags<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">set_write_cb</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">const</span> std<span style="color:#000;font-weight:bold">::</span>function<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#458;font-weight:bold">void</span>(<span style="color:#000;font-weight:bold">const</span> <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">*</span>, <span style="color:#000;font-weight:bold">const</span> <span style="color:#458;font-weight:bold">void</span><span style="color:#000;font-weight:bold">*</span>, size_t)<span style="color:#000;font-weight:bold">&gt;&amp;</span> cb,
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> flags<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><ul>
<li>co/log ÈªòËÆ§Â∞ÜÊó•ÂøóÂÜôÂà∞Êú¨Âú∞Êñá‰ª∂ÔºåÁî®Êà∑ÂèØ‰ª•Ë∞ÉÁî®Ê≠§ API Ëá™ÂÆö‰πâÂÜôÊó•ÂøóÁöÑ callbackÔºåÂ∞ÜÊó•ÂøóÂÜôÂà∞‰∏çÂêåÁöÑÁõÆÊ†á„ÄÇ</li>
<li>ÂèÇÊï∞ <code>cb</code> ÊòØ callback„ÄÇÁ¨¨ 1 ‰∏™ÁâàÊú¨Áî®‰∫é Level logÔºåcb Â∏¶ 2 ‰∏™ÂèÇÊï∞ÔºåË°®Á§∫Êó•Âøó buffer ÁöÑÂú∞ÂùÄÂèäÈïøÂ∫¶ÔºõÁ¨¨ 2 ‰∏™ÁâàÊú¨Áî®‰∫é Topic log(TLOG)Ôºåcb Â∏¶ 3 ‰∏™ÂèÇÊï∞ÔºåÁ¨¨ 1 ‰∏™ÂèÇÊï∞ÊòØ topicÔºåÂêé‰∏§‰∏™ÂèÇÊï∞‰∏éÁ¨¨ 1 ‰∏™ÁâàÊú¨Áõ∏Âêå„ÄÇbuffer ‰∏≠ÂèØËÉΩÂê´ÊúâÂ§öÊù°Êó•Âøó„ÄÇ</li>
<li>ÂèÇÊï∞ <code>flags</code> ÊòØ v3.0 Êñ∞Â¢ûÔºåÈªòËÆ§‰∏∫ 0ÔºåÂèØ‰ª•ÊòØ‰∏ãËø∞ÈÄâÈ°πÁöÑÁªÑÂêàÔºö
<ul>
<li><code>log::log2local</code>ÔºåÂú®Êú¨Âú∞‰πüÂÜô‰∏Ä‰ªΩÊó•Âøó„ÄÇ</li>
</ul>
</li>
</ul>
<h3 id="v30-Âà†Èô§ÁöÑ-api"><a class="anchor" href="#v30-%e5%88%a0%e9%99%a4%e7%9a%84-api">#</a>v3.0 Âà†Èô§ÁöÑ API</h3>
<ul>
<li>
<p><strong>log::init</strong>Ôºåv3.0 ÁßªÈô§Ôºå‰ªé co 3.0 ÂºÄÂßãÔºå‰∏ÄËà¨Âè™ÈúÄË¶ÅÂú® main ÂáΩÊï∞ÂºÄÂ§¥Ë∞ÉÁî® <code>flag::init(argc, argv)</code>„ÄÇ</p>
</li>
<li>
<p><strong>log::set_single_write_cb</strong>Ôºåv3.0 ÁßªÈô§„ÄÇ</p>
</li>
<li>
<p><strong>log::close</strong>Ôºåv3.0 ÁßªÈô§Ôºå‰ΩøÁî® <code>log::exit()</code> Âèñ‰ª£‰πã„ÄÇ</p>
</li>
</ul>
<h2 id="level-log-1"><a class="anchor" href="#level-log-1">#</a>Level Log</h2>
<h3 id="Âü∫Êú¨Áî®Ê≥ï"><a class="anchor" href="#%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95">#</a>Âü∫Êú¨Áî®Ê≥ï</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DLOG  LOG  WLOG  ELOG  FLOG
</span></span></code></pre></div><ul>
<li>
<p>‰∏äÈù¢ÁöÑ 5 ‰∏™ÂÆèÂàÜÂà´Áî®‰∫éÊâìÂç∞ 5 Áßç‰∏çÂêåÁ∫ßÂà´ÁöÑÊó•ÂøóÔºåÂÆÉ‰ª¨ÊòØ<strong>Á∫øÁ®ãÂÆâÂÖ®</strong>ÁöÑ„ÄÇ</p>
</li>
<li>
<p>Ëøô‰∫õÂÆèÂÆûÈôÖ‰∏äÊòØ <a href="../fastream/">fastream</a> ÁöÑÂºïÁî®ÔºåÂõ†Ê≠§ÂèØ‰ª•ÊâìÂç∞ <code>fastream::operator&lt;&lt;</code> ÊîØÊåÅÁöÑ‰ªª‰ΩïÁ±ªÂûã„ÄÇ</p>
</li>
<li>
<p>Ëøô‰∫õÂÆè‰ºöËá™Âä®Âú®ÊØèÊù°Êó•ÂøóÊú´Â∞æÂä†‰∏ä &lsquo;\n&rsquo; Êç¢Ë°åÁ¨¶ÔºåÁî®Êà∑Êó†ÈúÄÊâãÂä®ËæìÂÖ•Êç¢Ë°åÁ¨¶„ÄÇ</p>
</li>
<li>
<p>Ââç 4 Áßç‰ªÖÂú® <code>FLG_min_log_level</code>¬†‰∏çÂ§ß‰∫éÂΩìÂâçÊó•ÂøóÁ∫ßÂà´Êó∂ÔºåÊâç‰ºöÊâìÂç∞Êó•ÂøóÔºåÁî®Êà∑ÂèØ‰ª•Â∞Ü FLG_min_log_level ÁöÑÂÄºËÆæÁΩÆÂ§ß‰∏Ä‰∫õÔºå‰ª•Â±èËîΩ‰ΩéÁ∫ßÂà´ÁöÑÊó•Âøó„ÄÇ</p>
</li>
<li>
<p>ÊâìÂç∞ fatal Á∫ßÂà´ÁöÑÊó•ÂøóÔºåË°®Á§∫Á®ãÂ∫èÂá∫Áé∞‰∫ÜËá¥ÂëΩÈîôËØØÔºåco/log ‰ºöÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ãÁöÑÂáΩÊï∞Ë∞ÉÁî®Ê†à‰ø°ÊÅØÔºåÂπ∂ÁªàÊ≠¢Á®ãÂ∫èÁöÑËøêË°å„ÄÇ</p>
</li>
<li>
<p>Á§∫‰æã</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DLOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is DEBUG log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is INFO log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>WLOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is WARNING log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>ELOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is ERROR log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>FLOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is FATAL log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span></code></pre></div><h3 id="Êù°‰ª∂Êó•Âøó"><a class="anchor" href="#%e6%9d%a1%e4%bb%b6%e6%97%a5%e5%bf%97">#</a>Êù°‰ª∂Êó•Âøó</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define DLOG_IF(cond) if (cond) DLOG
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define  LOG_IF(cond) if (cond) LOG
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define WLOG_IF(cond) if (cond) WLOG
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define ELOG_IF(cond) if (cond) ELOG
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define FLOG_IF(cond) if (cond) FLOG
</span></span></span></code></pre></div><ul>
<li>
<p>‰∏äÈù¢ÁöÑ 5 ‰∏™ÂÆèÔºåÊé•Âèó‰∏Ä‰∏™Êù°‰ª∂ÂèÇÊï∞ condÔºåÂΩì cond ‰∏∫ true Êó∂ÊâçÊâìÂç∞Êó•Âøó„ÄÇ</p>
</li>
<li>
<p>ÂèÇÊï∞ cond ÂèØ‰ª•ÊòØÂÄº‰∏∫ bool Á±ªÂûãÁöÑ‰ªªÊÑèË°®ËææÂºè„ÄÇ</p>
</li>
<li>
<p>Áî±‰∫éÊù°‰ª∂Âà§Êñ≠Âú®ÊúÄÂâçÈù¢ÔºåÂç≥‰ΩøÁõ∏Â∫îÁ∫ßÂà´ÁöÑÊó•ÂøóË¢´Â±èËîΩÊéâÔºåËøô‰∫õÂÆè‰πü‰ºö‰øùËØÅ cond Ë°®ËææÂºèË¢´ÊâßË°å„ÄÇ</p>
</li>
<li>
<p>Á§∫‰æã</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> s <span style="color:#000;font-weight:bold">=</span> socket();
</span></span><span style="display:flex;"><span>DLOG_IF(s <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket ok: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> s;
</span></span><span style="display:flex;"><span> LOG_IF(s <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket ok: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> s;
</span></span><span style="display:flex;"><span>WLOG_IF(s <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket ko: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> s;
</span></span><span style="display:flex;"><span>ELOG_IF(s <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket ko: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> s;
</span></span><span style="display:flex;"><span>FLOG_IF(s <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket ko: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> s;
</span></span></code></pre></div><h3 id="ÊØè-n-Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•Âøó"><a class="anchor" href="#%e6%af%8f-n-%e6%9d%a1%e6%89%93%e5%8d%b0%e4%b8%80%e6%ac%a1%e6%97%a5%e5%bf%97">#</a>ÊØè N Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•Âøó</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define DLOG_EVERY_N(n) _LOG_EVERY_N(n, DLOG)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define  LOG_EVERY_N(n) _LOG_EVERY_N(n, LOG)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define WLOG_EVERY_N(n) _LOG_EVERY_N(n, WLOG)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define ELOG_EVERY_N(n) _LOG_EVERY_N(n, ELOG)
</span></span></span></code></pre></div><ul>
<li>
<p>‰∏äÈù¢ÁöÑÂÆèÊØè n Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•ÂøóÔºåÂÜÖÈÉ®Áî®<a href="../atomic/">ÂéüÂ≠êÊìç‰Ωú</a>ËÆ°Êï∞ÔºåÊòØ<strong>Á∫øÁ®ãÂÆâÂÖ®</strong>ÁöÑ„ÄÇ</p>
</li>
<li>
<p>ÂèÇÊï∞ n ÂøÖÈ°ªÊòØÂ§ß‰∫é 0 ÁöÑÊï¥Êï∞Ôºå‰∏ÄËà¨‰∏çË¶ÅË∂ÖËøá int Á±ªÂûãÁöÑÊúÄÂ§ßÂÄº„ÄÇ</p>
</li>
<li>
<p>Á¨¨ 1 Êù°Êó•ÂøóÂßãÁªà‰ºöË¢´ÊâìÂç∞Ôºå‰πãÂêéÊØèÈöî n Êù°ÊâìÂç∞‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p>fatal Êó•Âøó‰∏ÄÊâìÂç∞ÔºåÁ®ãÂ∫èÂ∞±‰ºöÁªàÊ≠¢ËøêË°åÔºåÂõ†Ê≠§Ê≤°ÊúâÊèê‰æõ FLOG_EVERY_N„ÄÇ</p>
</li>
<li>
<p>Á§∫‰æã</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// ÊØè 32 Êù°ÊâìÂç∞‰∏ÄÊ¨° (1,33,65...)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>DLOG_EVERY_N(<span style="color:#099">32</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is DEBUG log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>LOG_EVERY_N(<span style="color:#099">32</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is INFO log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>WLOG_EVERY_N(<span style="color:#099">32</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is WARNING log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>ELOG_EVERY_N(<span style="color:#099">32</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is ERROR log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span></code></pre></div><h3 id="ÊâìÂç∞Ââç-n-Êù°Êó•Âøó"><a class="anchor" href="#%e6%89%93%e5%8d%b0%e5%89%8d-n-%e6%9d%a1%e6%97%a5%e5%bf%97">#</a>ÊâìÂç∞Ââç N Êù°Êó•Âøó</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define DLOG_FIRST_N(n) _LOG_FIRST_N(n, DLOG)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define  LOG_FIRST_N(n) _LOG_FIRST_N(n, LOG)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define WLOG_FIRST_N(n) _LOG_FIRST_N(n, WLOG)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define ELOG_FIRST_N(n) _LOG_FIRST_N(n, ELOG)
</span></span></span></code></pre></div><ul>
<li>
<p>‰∏äÈù¢ÁöÑÂÆèÊâìÂç∞Ââç n Êù°Êó•ÂøóÔºåÂÜÖÈÉ®Áî®<a href="../atomic/">ÂéüÂ≠êÊìç‰Ωú</a>ËÆ°Êï∞ÔºåÊòØ<strong>Á∫øÁ®ãÂÆâÂÖ®</strong>ÁöÑ„ÄÇ</p>
</li>
<li>
<p>ÂèÇÊï∞ n ÊòØ‰∏çÂ∞è‰∫é 0 ÁöÑÊï¥Êï∞(Á≠â‰∫é 0 Êó∂‰∏ç‰ºöÊâìÂç∞Êó•Âøó)Ôºå‰∏ÄËà¨‰∏çË¶ÅË∂ÖËøá int Á±ªÂûãÁöÑÊúÄÂ§ßÂÄº„ÄÇ</p>
</li>
<li>
<p>ÂèÇÊï∞ n ‰∏ÄËà¨‰∏çË¶ÅÁî®Â§çÊùÇÁöÑË°®ËææÂºèÔºåÂõ†‰∏∫Ë°®ËææÂºè n ÂèØËÉΩË¢´ÊâßË°å‰∏§Ê¨°„ÄÇ</p>
</li>
<li>
<p>fatal Êó•Âøó‰∏ÄÊâìÂç∞ÔºåÁ®ãÂ∫èÂ∞±‰ºöÁªàÊ≠¢ËøêË°åÔºåÂõ†Ê≠§Ê≤°ÊúâÊèê‰æõ FLOG_FIRST_N„ÄÇ</p>
</li>
<li>
<p>Á§∫‰æã</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// ÊâìÂç∞Ââç 10 Êù°Êó•Âøó
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>DLOG_FIRST_N(<span style="color:#099">10</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is DEBUG log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>LOG_FIRST_N(<span style="color:#099">10</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is INFO log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>WLOG_FIRST_N(<span style="color:#099">10</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is WARNING log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>ELOG_FIRST_N(<span style="color:#099">10</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;this is ERROR log &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span></code></pre></div><h2 id="tlog"><a class="anchor" href="#tlog">#</a>TLOG</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define TLOG(topic)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define TLOG_IF(topic, cond) if (cond) TLOG(topic)
</span></span></span></code></pre></div><ul>
<li>
<p>TLOG ÂÆèÂ∏¶Êúâ‰∏Ä‰∏™ÂèÇÊï∞ <code>topic</code>ÔºåÂÆÉÊòØ‰∏Ä‰∏™ C È£éÊ†ºÁöÑÂ≠óÁ¨¶‰∏≤Ôºå<strong>ÈúÄË¶ÅÂÖ∑Â§áÈùôÊÄÅÁîüÂëΩÂë®Êúü</strong>„ÄÇ</p>
</li>
<li>
<p>TLOG_IF ÂÆè‰ªÖÂΩì cond Êù°‰ª∂ÊàêÁ´ãÊó∂ÔºåÊâçÊâìÂç∞Êó•Âøó„ÄÇ</p>
</li>
<li>
<p>Á§∫‰æã</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>TLOG(<span style="color:#d14">&#34;xx&#34;</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span><span style="display:flex;"><span>TLOG_IF(<span style="color:#d14">&#34;xx&#34;</span>, <span style="color:#0086b3">true</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;
</span></span></code></pre></div><h2 id="check-Êñ≠Ë®Ä"><a class="anchor" href="#check-%e6%96%ad%e8%a8%80">#</a>CHECK Êñ≠Ë®Ä</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK(cond) \
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">    if (!(cond)) _FLOG_STREAM &lt;&lt; &#34;check failed: &#34; #cond &#34;! &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_NOTNULL(p) \
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">    if ((p) == 0) _FLOG_STREAM &lt;&lt; &#34;check failed: &#34; #p &#34; mustn&#39;t be NULL! &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_EQ(a, b) _CHECK_OP(a, b, ==)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_NE(a, b) _CHECK_OP(a, b, !=)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_GE(a, b) _CHECK_OP(a, b, &gt;=)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_LE(a, b) _CHECK_OP(a, b, &lt;=)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_GT(a, b) _CHECK_OP(a, b, &gt;)
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#define CHECK_LT(a, b) _CHECK_OP(a, b, &lt;)
</span></span></span></code></pre></div><ul>
<li>
<p>‰∏äÈù¢ÁöÑÂÆèÂèØËßÜ‰∏∫Âä†Âº∫ÁâàÁöÑ assertÔºåÂÆÉ‰ª¨Âú® DEBUG Ê®°Âºè‰∏ã‰πü‰∏ç‰ºöË¢´Ê∏ÖÈô§„ÄÇ</p>
</li>
<li>
<p>Ëøô‰∫õÂÆè‰∏é <code>FLOG</code>¬†Á±ª‰ººÔºåÂèØ‰ª•ÊâìÂç∞ fatal Á∫ßÂà´ÁöÑÊó•Âøó„ÄÇ</p>
</li>
<li>
<p><code>CHECK</code> Êñ≠Ë®ÄÊù°‰ª∂ cond ‰∏∫ÁúüÔºåcond ÂèØ‰ª•ÊòØÂÄº‰∏∫ bool Á±ªÂûãÁöÑ‰ªªÊÑèË°®ËææÂºè„ÄÇ</p>
</li>
<li>
<p><code>CHECK_NOTNULL</code> Êñ≠Ë®ÄÊåáÈíà‰∏çÊòØ NULLÔºåÂèÇÊï∞ p ÊòØ‰ªªÊÑèÁ±ªÂûãÁöÑÊåáÈíà„ÄÇ</p>
</li>
<li>
<p><code>CHECK_EQ</code>¬†Êñ≠Ë®Ä <code>a == b</code>ÔºåÂèÇÊï∞ a ‰∏é b Á°Æ‰øùÂè™ËÆ°ÁÆó‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p><code>CHECK_NE</code>¬†Êñ≠Ë®Ä <code>a != b</code>ÔºåÂèÇÊï∞ a ‰∏é b Á°Æ‰øùÂè™ËÆ°ÁÆó‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p><code>CHECK_GE</code>¬†Êñ≠Ë®Ä <code>a &gt;= b</code>ÔºåÂèÇÊï∞ a ‰∏é b Á°Æ‰øùÂè™ËÆ°ÁÆó‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p><code>CHECK_LE</code>¬†Êñ≠Ë®Ä <code>a &lt;= b</code>ÔºåÂèÇÊï∞ a ‰∏é b Á°Æ‰øùÂè™ËÆ°ÁÆó‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p><code>CHECK_GT</code> Êñ≠Ë®Ä <code>a &gt; b</code>ÔºåÂèÇÊï∞ a ‰∏é b Á°Æ‰øùÂè™ËÆ°ÁÆó‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p><code>CHECK_LT</code> Êñ≠Ë®Ä <code>a &lt; b</code>ÔºåÂèÇÊï∞ a ‰∏é b Á°Æ‰øùÂè™ËÆ°ÁÆó‰∏ÄÊ¨°„ÄÇ</p>
</li>
<li>
<p>‰∏ÄËà¨Âª∫ËÆÆ‰ºòÂÖà‰ΩøÁî® <code>CHECK_XX(a, b)</code>¬†Ëøô‰∫õÂÆèÔºåÂÆÉ‰ª¨Êèê‰æõÊØî <code>CHECK(cond)</code>¬†Êõ¥Â§öÁöÑ‰ø°ÊÅØÔºå‰ºöÊâìÂç∞Âá∫ÂèÇÊï∞ a ‰∏é b ÁöÑÂÄº„ÄÇ</p>
</li>
<li>
<p><code>fastream::operator&lt;&lt;</code>¬†‰∏çÊîØÊåÅÁöÑÂèÇÊï∞Á±ªÂûãÔºåÂ¶Ç STL ÂÆπÂô®ÁöÑ iterator Á±ªÂûãÔºå‰∏çËÉΩÁî® <code>CHECK_XX(a, b)</code> Ëøô‰∫õÂÆè„ÄÇ</p>
</li>
<li>
<p>Êñ≠Ë®ÄÂ§±Ë¥•Êó∂Ôºåco/log ÂÖàË∞ÉÁî® <code>log::exit()</code>ÔºåÂÜçÊâìÂç∞ÂΩìÂâçÁ∫øÁ®ãÁöÑÂáΩÊï∞Ë∞ÉÁî®Ê†à‰ø°ÊÅØÔºåÁÑ∂ÂêéÈÄÄÂá∫Á®ãÂ∫è„ÄÇ</p>
</li>
<li>
<p>Á§∫‰æã</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> s <span style="color:#000;font-weight:bold">=</span> socket();
</span></span><span style="display:flex;"><span>CHECK(s <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>);
</span></span><span style="display:flex;"><span>CHECK(s <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket failed&#34;</span>;
</span></span><span style="display:flex;"><span>CHECK_NE(s, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket failed&#34;</span>;  <span style="color:#998;font-style:italic">// s != -1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>CHECK_GE(s, <span style="color:#099">0</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket failed&#34;</span>;   <span style="color:#998;font-style:italic">// s &gt;= 0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>CHECK_GT(s, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;create socket failed&#34;</span>;  <span style="color:#998;font-style:italic">// s &gt; -1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>std<span style="color:#000;font-weight:bold">::</span>map<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#458;font-weight:bold">int</span>, <span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">&gt;</span> m;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">auto</span> it <span style="color:#000;font-weight:bold">=</span> m.find(<span style="color:#099">3</span>);
</span></span><span style="display:flex;"><span>CHECK(it <span style="color:#000;font-weight:bold">!=</span> m.end()); <span style="color:#998;font-style:italic">// ‰∏çËÉΩ‰ΩøÁî® CHECK_NE(it, m.end()), ÁºñËØëÂô®‰ºöÊä•Èîô
</span></span></span></code></pre></div><h2 id="ÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ"><a class="anchor" href="#%e6%89%93%e5%8d%b0%e5%a0%86%e6%a0%88%e4%bf%a1%e6%81%af">#</a>ÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ</h2>
<p><code>co/log</code> Âú® <code>CHECK</code> Êñ≠Ë®ÄÂ§±Ë¥•ÊàñÊçïËé∑Âà∞ <code>SIGSEGV</code> Á≠âÂºÇÂ∏∏‰ø°Âè∑Êó∂Ôºå‰ºöÊâìÂç∞ÂáΩÊï∞Ë∞ÉÁî®Ê†àÔºå‰ª•Êñπ‰æøÂÆö‰ΩçÈóÆÈ¢òÔºåÊïàÊûúËßÅ‰∏ãÂõæÔºö</p>
<p><img src="https://coostdocs.github.io/images/stack.png" alt="stack" />(<a href="https://asciinema.org/a/435894">https://asciinema.org/a/435894</a>)</p>
<p>Ê≠§ÂäüËÉΩÈúÄË¶ÅÂú®ÁºñËØëÊó∂ÔºåÂä†ÂÖ•Ë∞ÉËØï‰ø°ÊÅØÔºåÂ¶Ç gcc ÈúÄË¶ÅÂºÄÂêØ <code>-g</code> ÈÄâÈ°π„ÄÇÂú® linux ‰∏é macosx Âπ≥Âè∞ÔºåËøòÈúÄË¶ÅÂÆâË£Ö <a href="https://github.com/ianlancetaylor/libbacktrace">libbacktrace</a>ÔºåÊâçËÉΩÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ„ÄÇÂú® linux ‰∏äÔºå<code>libbacktrace</code> ÂèØËÉΩÂ∑≤ÁªèÈõÜÊàêÂà∞ gcc Èáå‰∫ÜÔºåÊÇ®‰πüËÆ∏ÂèØ‰ª•Âú®Á±ª‰ºº <code>/usr/lib/gcc/x86_64-linux-gnu/9</code> ÁöÑÁõÆÂΩï‰∏≠ÊâæÂà∞ÂÆÉ„ÄÇÂê¶ÂàôÔºåÊÇ®ÂèØ‰ª•Êåâ‰∏ãÈù¢ÁöÑÊñπÂºèÊâãÂä®ÂÆâË£ÖÂÆÉÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git clone https://github.com/ianlancetaylor/libbacktrace.git
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> libbacktrace-master
</span></span><span style="display:flex;"><span>./configure
</span></span><span style="display:flex;"><span>make -j8
</span></span><span style="display:flex;"><span>sudo make install
</span></span></code></pre></div><h2 id="ÈÖçÁΩÆÈ°π"><a class="anchor" href="#%e9%85%8d%e7%bd%ae%e9%a1%b9">#</a>ÈÖçÁΩÆÈ°π</h2>
<p>co/log ‰ΩøÁî® <a href="../flag/">co/flag</a> ÂÆö‰πâÈÖçÁΩÆÈ°πÔºå‰∏ãÈù¢ÂàóÂá∫ÁöÑÊòØ co/log ÂÜÖÈÉ®ÂÆö‰πâÁöÑ flagÔºåËøô‰∫õÈÖçÁΩÆÈ°πÂ¶ÇÊó†ÁâπÂà´ËØ¥ÊòéÔºåÂØπ level log ‰∏é TLOG ÂùáÊúâÊïà„ÄÇ</p>
<h3 id="log_dir"><a class="anchor" href="#log_dir">#</a>log_dir</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_string(log_dir, <span style="color:#d14">&#34;logs&#34;</span>, <span style="color:#d14">&#34;#0 log dir, will be created if not exists&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÊåáÂÆöÊó•ÂøóÁõÆÂΩïÔºåÈªòËÆ§‰∏∫ÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑ <code>logs</code> ÁõÆÂΩïÔºå‰∏çÂ≠òÂú®Êó∂Â∞Ü‰ºöËá™Âä®ÂàõÂª∫„ÄÇ</li>
<li>log_dir ÂèØ‰ª•ÊòØÁªùÂØπË∑ØÂæÑÊàñÁõ∏ÂØπË∑ØÂæÑÔºåË∑ØÂæÑÂàÜÈöîÁ¨¶ÂèØ‰ª•ÊòØ &lsquo;/&rsquo; Êàñ &lsquo;\&rsquo;Ôºå‰∏ÄËà¨Âª∫ËÆÆ‰ΩøÁî® &lsquo;/&rsquo;„ÄÇ</li>
<li>Á®ãÂ∫èÂêØÂä®Êó∂ÔºåÁ°Æ‰øùÂΩìÂâçÁî®Êà∑ÊúâË∂≥Â§üÁöÑÊùÉÈôêÔºåÂê¶ÂàôÂàõÂª∫Êó•ÂøóÁõÆÂΩïÂèØËÉΩÂ§±Ë¥•„ÄÇ</li>
</ul>
<h3 id="log_file_name"><a class="anchor" href="#log_file_name">#</a>log_file_name</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_string(log_file_name, <span style="color:#d14">&#34;&#34;</span>, <span style="color:#d14">&#34;#0 name of log file, using exename if empty&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÊåáÂÆöÊó•ÂøóÊñá‰ª∂Âêç(‰∏çÂê´Ë∑ØÂæÑ)ÔºåÈªòËÆ§‰∏∫Á©∫Ôºå‰ΩøÁî®Á®ãÂ∫èÂêç‰Ωú‰∏∫Êó•ÂøóÊñá‰ª∂Âêç(Á®ãÂ∫èÂêçÊú´Â∞æÁöÑ <code>.exe</code> ‰ºöË¢´ÂéªÊéâ)ÔºåÂ¶ÇÁ®ãÂ∫è xx Êàñ xx.exe ÂØπÂ∫îÁöÑÊó•ÂøóÊñá‰ª∂ÂêçÊòØ xx.log„ÄÇ</li>
<li>Â¶ÇÊûúÊó•ÂøóÊñá‰ª∂Âêç‰∏çÊòØ‰ª• <code>.log</code>¬†ÁªìÂ∞æÔºåco/log Ëá™Âä®Âú®Êñá‰ª∂ÂêçÊú´Â∞æÂä†‰∏ä <code>.log</code>„ÄÇ</li>
</ul>
<h3 id="min_log_level"><a class="anchor" href="#min_log_level">#</a>min_log_level</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_int32(min_log_level, <span style="color:#099">0</span>, <span style="color:#d14">&#34;#0 write logs at or above this level, 0-4 (debug|info|warning|error|fatal)&#34;</span>);
</span></span></code></pre></div><ul>
<li>‰ªÖÈÄÇÁî®‰∫é level logÔºåÊåáÂÆöÊâìÂç∞Êó•ÂøóÁöÑÊúÄÂ∞èÁ∫ßÂà´ÔºåÁî®‰∫éÂ±èËîΩ‰ΩéÁ∫ßÂà´ÁöÑÊó•ÂøóÔºåÈªòËÆ§‰∏∫ 0ÔºåÊâìÂç∞ÊâÄÊúâÁ∫ßÂà´ÁöÑÊó•Âøó„ÄÇ</li>
</ul>
<h3 id="max_log_size"><a class="anchor" href="#max_log_size">#</a>max_log_size</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_int32(max_log_size, <span style="color:#099">4096</span>, <span style="color:#d14">&#34;#0 max size of a single log&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÂçïÊù°Êó•ÂøóÁöÑÊúÄÂ§ßÈïøÂ∫¶ÔºåË∂ÖËøáËøô‰∏™ÂÄºÔºåÊó•Âøó‰ºöË¢´Êà™Êñ≠„ÄÇ</li>
</ul>
<h3 id="max_log_file_size"><a class="anchor" href="#max_log_file_size">#</a>max_log_file_size</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_int64(max_log_file_size, <span style="color:#099">256</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">20</span>, <span style="color:#d14">&#34;#0 max size of log file, default: 256MB&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÊåáÂÆöÊó•ÂøóÊñá‰ª∂ÁöÑÊúÄÂ§ßÂ§ßÂ∞èÔºåÈªòËÆ§ 256MÔºåË∂ÖËøáÊ≠§Â§ßÂ∞èÔºåÁîüÊàêÊñ∞ÁöÑÊó•ÂøóÊñá‰ª∂ÔºåÊóßÁöÑÊó•ÂøóÊñá‰ª∂‰ºöË¢´ÈáçÂëΩÂêç„ÄÇ</li>
</ul>
<h3 id="max_log_file_num"><a class="anchor" href="#max_log_file_num">#</a>max_log_file_num</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_uint32(max_log_file_num, <span style="color:#099">8</span>, <span style="color:#d14">&#34;#0 max number of log files&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÊåáÂÆöÊó•ÂøóÊñá‰ª∂ÁöÑÊúÄÂ§ßÊï∞ÈáèÔºåÈªòËÆ§ÊòØ 8ÔºåË∂ÖËøáÊ≠§ÂÄºÔºåÂà†Èô§ÊóßÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇ</li>
</ul>
<h3 id="max_log_buffer_size"><a class="anchor" href="#max_log_buffer_size">#</a>max_log_buffer_size</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_uint32(max_log_buffer_size, <span style="color:#099">32</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">20</span>, <span style="color:#d14">&#34;#0 max size of log buffer, default: 32MB&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÊåáÂÆöÊó•ÂøóÁºìÂ≠òÁöÑÊúÄÂ§ßÂ§ßÂ∞èÔºåÈªòËÆ§ 32MÔºåË∂ÖËøáÊ≠§ÂÄºÔºå‰∏¢Êéâ‰∏ÄÂçäÁöÑÊó•Âøó„ÄÇ</li>
</ul>
<h3 id="log_flush_ms"><a class="anchor" href="#log_flush_ms">#</a>log_flush_ms</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_uint32(log_flush_ms, <span style="color:#099">128</span>, <span style="color:#d14">&#34;#0 flush the log buffer every n ms&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÂêéÂè∞Á∫øÁ®ãÂ∞ÜÊó•ÂøóÁºìÂ≠òÂà∑ÂÖ•Êñá‰ª∂ÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÂçï‰Ωç‰∏∫ÊØ´Áßí„ÄÇ</li>
</ul>
<h3 id="log_daily"><a class="anchor" href="#log_daily">#</a>log_daily</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_bool(log_daily, <span style="color:#0086b3">false</span>, <span style="color:#d14">&#34;&gt;&gt;#0 if true, enable daily log rotation&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÊåâÂ§©ÁîüÊàêÊó•ÂøóÊñá‰ª∂ÔºåÈªòËÆ§‰∏∫ false„ÄÇ</li>
</ul>
<h3 id="cout"><a class="anchor" href="#cout">#</a>cout</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DEF_bool(cout, <span style="color:#0086b3">false</span>, <span style="color:#d14">&#34;#0 also logging to terminal&#34;</span>);
</span></span></code></pre></div><ul>
<li>ÁªàÁ´ØÊó•ÂøóÂºÄÂÖ≥ÔºåÈªòËÆ§‰∏∫ false„ÄÇËã•‰∏∫ trueÔºåÂ∞ÜÊó•Âøó‰πüÊâìÂç∞Âà∞ÁªàÁ´Ø„ÄÇ</li>
</ul>
<h2 id="Êó•ÂøóÊñá‰ª∂"><a class="anchor" href="#%e6%97%a5%e5%bf%97%e6%96%87%e4%bb%b6">#</a>Êó•ÂøóÊñá‰ª∂</h2>
<h3 id="Êó•ÂøóÁªÑÁªáÊñπÂºè"><a class="anchor" href="#%e6%97%a5%e5%bf%97%e7%bb%84%e7%bb%87%e6%96%b9%e5%bc%8f">#</a>Êó•ÂøóÁªÑÁªáÊñπÂºè</h3>
<p>co/log Â∞ÜÊâÄÊúâÁ∫ßÂà´ÁöÑÊó•ÂøóËÆ∞ÂΩïÂà∞Âêå‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÈªòËÆ§‰ΩøÁî®Á®ãÂ∫èÂêç‰Ωú‰∏∫Êó•ÂøóÊñá‰ª∂ÂêçÔºåÂ¶ÇËøõÁ®ã xx ÁöÑÊó•ÂøóÊñá‰ª∂ÊòØ xx.log„ÄÇÂΩìÊó•ÂøóÊñá‰ª∂ËææÂà∞ÊúÄÂ§ßÂ§ßÂ∞è (FLG_max_log_file_size) Êó∂Ôºåco/log ‰ºöÈáçÂëΩÂêçÊó•ÂøóÊñá‰ª∂ÔºåÂπ∂ÁîüÊàêÊñ∞Êñá‰ª∂„ÄÇÊó•ÂøóÁõÆÂΩï‰∏ãÈù¢ÂèØËÉΩÂåÖÂê´Â¶Ç‰∏ãÁöÑÊñá‰ª∂Ôºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>xx.log
</span></span><span style="display:flex;"><span>xx_0523_16_12_54.970.log
</span></span><span style="display:flex;"><span>xx_0523_16_13_12.921.log
</span></span><span style="display:flex;"><span>xx_0523_16_15_05.264.log
</span></span></code></pre></div><p><code>xx.log</code>¬†ÂßãÁªàÊòØÂΩìÂâçÊúÄÊñ∞ÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇÂΩìÊñá‰ª∂Êï∞ÈáèË∂ÖËøá <code>FLG_max_log_file_num</code> Êó∂Ôºåco/log Â∞±‰ºöÂà†Èô§ÊúÄÊóßÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇ</p>
<p><code>fatal</code>¬†Á∫ßÂà´ÁöÑÊó•ÂøóÔºåËøò‰ºöÈ¢ùÂ§ñËÆ∞ÂΩïÂà∞ <code>xx.fatal</code>¬†Êñá‰ª∂‰∏≠Ôºå<strong>co/log ‰∏ç‰ºöÈáçÂëΩÂêç fatal Êó•ÂøóÊñá‰ª∂Ôºå‰πü‰∏ç‰ºöÂà†Èô§ÂÆÉ</strong>„ÄÇ</p>
<h3 id="Êó•ÂøóÊ†ºÂºè"><a class="anchor" href="#%e6%97%a5%e5%bf%97%e6%a0%bc%e5%bc%8f">#</a>Êó•ÂøóÊ†ºÂºè</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>I0514 11:15:30.123 <span style="color:#099">1045</span> test/xx.cc:11<span style="color:#000;font-weight:bold">]</span> hello world
</span></span><span style="display:flex;"><span>D0514 11:15:30.123 <span style="color:#099">1045</span> test/xx.cc:12<span style="color:#000;font-weight:bold">]</span> hello world
</span></span><span style="display:flex;"><span>W0514 11:15:30.123 <span style="color:#099">1045</span> test/xx.cc:13<span style="color:#000;font-weight:bold">]</span> hello world
</span></span><span style="display:flex;"><span>E0514 11:15:30.123 <span style="color:#099">1045</span> test/xx.cc:14<span style="color:#000;font-weight:bold">]</span> hello world
</span></span><span style="display:flex;"><span>F0514 11:15:30.123 <span style="color:#099">1045</span> test/xx.cc:15<span style="color:#000;font-weight:bold">]</span> hello world
</span></span></code></pre></div><ul>
<li>‰∏äÈù¢ÁöÑ‰æãÂ≠ê‰∏≠ÔºåÊØèË°åÂØπÂ∫î‰∏ÄÊù°Êó•Âøó„ÄÇ</li>
<li>ÊØèÊù°Êó•ÂøóÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊØçÊòØÊó•ÂøóÁ∫ßÂà´Ôºå<code>I</code>¬†Ë°®Á§∫ infoÔºå<code>D</code>¬†Ë°®Á§∫ debugÔºå<code>W</code>¬†Ë°®Á§∫ warningÔºå<code>E</code>¬†Ë°®Á§∫ errorÔºå<code>F</code>¬†Ë°®Á§∫ fatal„ÄÇ</li>
<li>Á∫ßÂà´ÂêéÈù¢ÊòØÊó∂Èó¥Ôºå‰ªéÊúà‰ªΩÂºÄÂßãÂà∞ÊØ´Áßí„ÄÇÂπ¥‰ªΩÊÑè‰πâ‰∏çÂ§ßÔºåÂè™‰ºöÂ§öÂç†Âá†‰∏™Â≠óËäÇÔºåÂõ†Ê≠§Ê≤°ÊúâÊâìÂç∞Âá∫Êù•„ÄÇco/log Êó•ÂøóÁöÑÊó∂Èó¥ÔºåÂπ∂‰∏çÊòØÁîüÊàêÊó∂ÁöÑÊó∂Èó¥ÔºåËÄåÊòØÂÜôÂÖ•ÁºìÂ≠òÊó∂ÁöÑÊó∂Èó¥ÔºåËøôÊòØ‰∏∫‰∫Ü‰øùËØÅÊó•ÂøóÊñá‰ª∂‰∏≠ÁöÑÊó•Âøó‰∏•Ê†ºÊåâÊó∂Èó¥ÊéíÂ∫è„ÄÇ</li>
<li>Êó∂Èó¥ÂêéÈù¢ÊòØÁ∫øÁ®ã idÔºå‰∏äÈù¢ÁöÑ 1045 Âç≥ÊòØÁ∫øÁ®ã id„ÄÇ</li>
<li>Á∫øÁ®ã id ÂêéÈù¢ÊòØÊó•Âøó‰ª£Á†ÅÊâÄÂú®Êñá‰ª∂ÂèäË°åÊï∞„ÄÇ</li>
<li>Ë°åÊï∞ÂêéÈù¢ÊòØ <code>] </code>¬†ÔºåÂç≥ <code>]</code>¬†ÂêéÈù¢Âä†‰∏Ä‰∏™Á©∫Ê†º„ÄÇ</li>
<li><code>] </code>¬†ÂêéÈù¢Â∞±ÊòØÁî®Êà∑ËæìÂÖ•ÁöÑÊó•ÂøóÂÜÖÂÆπ„ÄÇ</li>
</ul>
<h3 id="Êü•ÁúãÊó•Âøó"><a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%97%a5%e5%bf%97">#</a>Êü•ÁúãÊó•Âøó</h3>
<p>Linux Á≠âÁ≥ªÁªüÔºåÂèØ‰ª•Áî® <code>grep</code>Ôºå<code>tail</code>¬†Á≠âÂëΩ‰ª§Êü•ÁúãÊó•Âøó„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep ^E xx.log
</span></span><span style="display:flex;"><span>tail -F xx.log
</span></span><span style="display:flex;"><span>tail -F xx.log | grep ^E
</span></span></code></pre></div><ul>
<li>Á¨¨ 1 Ë°åÁî® <code>grep</code> ËøáÊª§Âá∫Êñá‰ª∂‰∏≠ÁöÑÈîôËØØÊó•ÂøóÔºå<code>^E</code>¬†Ë°®Á§∫‰ª•Â≠óÊØç <code>E</code>¬†ÂºÄÂ§¥„ÄÇ</li>
<li>Á¨¨ 2 Ë°åÁî® <code>tail -F</code>¬†ÂëΩ‰ª§Âä®ÊÄÅËøΩË∏™Êó•ÂøóÊñá‰ª∂ÔºåËøôÈáåÈúÄË¶ÅÁî®Â§ßÂÜôÁöÑ <code>F</code>ÔºåÂõ†‰∏∫ xx.log ÂèØËÉΩË¢´ÈáçÂëΩÂêçÔºåÁÑ∂ÂêéÁîüÊàêÊñ∞ÁöÑ xx.log Êñá‰ª∂Ôºå<code>-F</code>¬†Á°Æ‰øùÊåâÊñá‰ª∂ÂêçËøΩË∏™Âà∞ÊúÄÊñ∞ÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇ</li>
<li>Á¨¨ 3 Ë°åÁî® <code>tail -F</code>¬†ÈÖçÂêà <code>grep</code>¬†Âä®ÊÄÅËøΩË∏™Êó•ÂøóÊñá‰ª∂‰∏≠ÁöÑÈîôËØØÊó•Âøó„ÄÇ</li>
</ul>
<h2 id="ÊûÑÂª∫ÂèäËøêË°å-colog-ÊµãËØïÁ®ãÂ∫è"><a class="anchor" href="#%e6%9e%84%e5%bb%ba%e5%8f%8a%e8%bf%90%e8%a1%8c-colog-%e6%b5%8b%e8%af%95%e7%a8%8b%e5%ba%8f">#</a>ÊûÑÂª∫ÂèäËøêË°å co/log ÊµãËØïÁ®ãÂ∫è</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>xmake -b log                   <span style="color:#998;font-style:italic"># build log or log.exe</span>
</span></span><span style="display:flex;"><span>xmake r log                    <span style="color:#998;font-style:italic"># run log or log.exe</span>
</span></span><span style="display:flex;"><span>xmake r log -cout              <span style="color:#998;font-style:italic"># also log to terminal</span>
</span></span><span style="display:flex;"><span>xmake r log -min_log_level<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>   <span style="color:#998;font-style:italic"># 0-4: debug,info,warning,error,fatal </span>
</span></span><span style="display:flex;"><span>xmake r log -perf              <span style="color:#998;font-style:italic"># performance test</span>
</span></span></code></pre></div><ul>
<li>Âú® co Ê†πÁõÆÂΩïÊâßË°å <code>xmake -b log</code>¬†Âç≥ÂèØÁºñËØë <a href="https://github.com/idealvin/co/blob/master/test/log.cc">test/log.cc</a> ÊµãËØï‰ª£Á†ÅÔºåÂπ∂ÁîüÊàê <code>log</code>¬†‰∫åËøõÂà∂Êñá‰ª∂„ÄÇ</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

  



  
    
  
    
  


  


<div class="book-languages" tabindex="0" aria-haspopup="true">
  <ul>
    <li class="flex align-center">
      <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
      ‰∏≠Êñá
    </li> 
  </ul>

  <ul class="book-languages-list">
    
    <li class="active">
      <a href="../../../cn/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        ‰∏≠Êñá
      </a>
    </li>
    
    <li class="">
      <a href="../../../en/co/log/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </li>
    
  </ul>
</div>




  <div class="book-date"><a class="flex align-center" href="https://github.com/cocoyaxi/codoc/commit/07947e66070d8427517d89d2d0edc9b2af36e9ee" title='ÊúÄÂêé‰øÆÊîπËÄÖ idealvin | September 19, 2022' target="_blank" rel="noopener">
      <img src="../../../svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>September 19, 2022</span>
    </a>
  </div>



  <div class="book-edit">
    <a class="flex align-center" href="https://github.com/cocoyaxi/codoc/edit/master/content/cn/co/log.md" target="_blank" rel="noopener">
      <img src="../../../svg/edit.svg" class="book-icon" alt="Edit" />
      <span>ÁºñËæëÊú¨È°µ</span>
    </a>
  </div>

</div>

 
        





<script src="//cdn.bootcss.com/highlight.js/11.1.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/cpp.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/bash.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/lua.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/yaml.min.js"></script>
<script>hljs.configure({ languages: [] }); hljs.initHighlightingOnLoad();</script>





      </footer>

      
  
  <div class="book-comments">


<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '11f9ff9ca43804d70b32',
    clientSecret: '07e2bd5b09a1654e7942a7698c3ec164e7566177',
    repo: 'gitalk',
    owner: 'idealvin',
    admin: ['idealvin'],
    id: location.pathname,
    language: 'zh-CN',
    distractionFreeMode: false,
    proxy: 'https:\/\/cors-anywhere.azm.workers.dev\/https:\/\/github.com\/login\/oauth\/access_token'
  })
  gitalk.render('gitalk-container');
</script></div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#ÁÆÄ‰ªã">ÁÆÄ‰ªã</a>
          <ul>
            <li><a href="#level-log">Level Log</a></li>
            <li><a href="#topic-log">Topic Log</a></li>
            <li><a href="#ÊÄßËÉΩ">ÊÄßËÉΩ</a></li>
          </ul>
        </li>
        <li><a href="#api">API</a>
          <ul>
            <li><a href="#logexit">log::exit</a></li>
            <li><a href="#logset_write_cb">log::set_write_cb</a></li>
            <li><a href="#v30-Âà†Èô§ÁöÑ-api">v3.0 Âà†Èô§ÁöÑ API</a></li>
          </ul>
        </li>
        <li><a href="#level-log-1">Level Log</a>
          <ul>
            <li><a href="#Âü∫Êú¨Áî®Ê≥ï">Âü∫Êú¨Áî®Ê≥ï</a></li>
            <li><a href="#Êù°‰ª∂Êó•Âøó">Êù°‰ª∂Êó•Âøó</a></li>
            <li><a href="#ÊØè-n-Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•Âøó">ÊØè N Êù°ÊâìÂç∞‰∏ÄÊ¨°Êó•Âøó</a></li>
            <li><a href="#ÊâìÂç∞Ââç-n-Êù°Êó•Âøó">ÊâìÂç∞Ââç N Êù°Êó•Âøó</a></li>
          </ul>
        </li>
        <li><a href="#tlog">TLOG</a></li>
        <li><a href="#check-Êñ≠Ë®Ä">CHECK Êñ≠Ë®Ä</a></li>
        <li><a href="#ÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ">ÊâìÂç∞Â†ÜÊ†à‰ø°ÊÅØ</a></li>
        <li><a href="#ÈÖçÁΩÆÈ°π">ÈÖçÁΩÆÈ°π</a>
          <ul>
            <li><a href="#log_dir">log_dir</a></li>
            <li><a href="#log_file_name">log_file_name</a></li>
            <li><a href="#min_log_level">min_log_level</a></li>
            <li><a href="#max_log_size">max_log_size</a></li>
            <li><a href="#max_log_file_size">max_log_file_size</a></li>
            <li><a href="#max_log_file_num">max_log_file_num</a></li>
            <li><a href="#max_log_buffer_size">max_log_buffer_size</a></li>
            <li><a href="#log_flush_ms">log_flush_ms</a></li>
            <li><a href="#log_daily">log_daily</a></li>
            <li><a href="#cout">cout</a></li>
          </ul>
        </li>
        <li><a href="#Êó•ÂøóÊñá‰ª∂">Êó•ÂøóÊñá‰ª∂</a>
          <ul>
            <li><a href="#Êó•ÂøóÁªÑÁªáÊñπÂºè">Êó•ÂøóÁªÑÁªáÊñπÂºè</a></li>
            <li><a href="#Êó•ÂøóÊ†ºÂºè">Êó•ÂøóÊ†ºÂºè</a></li>
            <li><a href="#Êü•ÁúãÊó•Âøó">Êü•ÁúãÊó•Âøó</a></li>
          </ul>
        </li>
        <li><a href="#ÊûÑÂª∫ÂèäËøêË°å-colog-ÊµãËØïÁ®ãÂ∫è">ÊûÑÂª∫ÂèäËøêË°å co/log ÊµãËØïÁ®ãÂ∫è</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












