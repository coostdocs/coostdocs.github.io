<!DOCTYPE html>
<html lang="cn" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="#CO ÊòØ‰ªÄ‰πà CO ÊòØ‰∏Ä‰∏™‰ºòÈõÖ„ÄÅÈ´òÊïàÁöÑ C&#43;&#43; Âü∫Á°ÄÂ∫ìÔºåÊîØÊåÅ Linux, Windows ‰∏é Mac Á≠âÂπ≥Âè∞ÔºåÂÆÉÂÆûÁé∞‰∫ÜÁ±ª‰ºº golang ÁöÑÂçèÁ®ã„ÄÅÂü∫‰∫éÂçèÁ®ãÁöÑÁΩëÁªúÁºñÁ®ãÊ°ÜÊû∂„ÄÅÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏éÈÖçÁΩÆÊñá‰ª∂Ëß£ÊûêÂ∫ì„ÄÅÈ´òÊÄßËÉΩÊó•ÂøóÂ∫ì„ÄÅÂçïÂÖÉÊµãËØïÊ°ÜÊû∂„ÄÅJSON Â∫ìÁ≠â‰∏ÄÁ≥ªÂàóÈ´òË¥®ÈáèÁöÑÂü∫Á°ÄÁªÑ‰ª∂„ÄÇ
CO Âú® github ‰∏ä‰ª• MIT ËÆ∏ÂèØËØÅÂºÄÊ∫êÔºåÂÆÉ‰ΩøÁî®‰∫ÜÈÉ®ÂàÜ‰∏âÊñπ‰ª£Á†ÅÔºåÂèØËÉΩÊúâ‰∏çÂêåÁöÑËÆ∏ÂèØËØÅÔºåËØ¶ÊÉÖËßÅ LICENSE Êñá‰ª∂„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂõΩÂÜÖÁî®Êà∑Ôºågitee ‰∏ä‰πü‰ºöÂÆöÊúüÂêåÊ≠• github ‰∏äÁöÑ‰ª£Á†Å„ÄÇ
#CO ÁöÑÂèëÂ±ïÂéÜÁ®ã Alvin(idealvin) Ëá™ 2013 Âπ¥ÂºÄÂßãÂºÄÂèë COÔºåÊúÄÂàùÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂáèÂ∞ë C&#43;&#43; È°πÁõÆ‰∏≠ÁöÑ‰∏âÊñπ‰æùËµñÔºåÂêåÊó∂ÊèêÈ´ò C&#43;&#43; ÁöÑÂºÄÂèëÊïàÁéá„ÄÇ‰ªé 2015 Âπ¥ÂºÄÂßãÔºåAlvin Â∞Ü CO ÂºïÂÖ•ÂÆûÈôÖÈ°πÁõÆ‰∏≠Ôºå‰æõËá™Â∑±‰∏éÂêå‰∫ã‰ΩøÁî®ÔºåÂ§ßÂ§ßÁº©Âáè‰∫ÜÈ°πÁõÆÁöÑÂºÄÂèëÂë®ÊúüÔºåCO ‰πüÂæó‰ª•ÁªèÂèóÂ∑•‰∏öÈ°πÁõÆÁöÑÊ£ÄÈ™å„ÄÇ
ÁªèËøáÂ§öÂπ¥ÁöÑÁßØÁ¥Ø„ÄÅÊ≤âÊ∑ÄÔºåÂà∞ 2019 Âπ¥ÔºåAlvin ÂèàÁî® C&#43;&#43; ÂÆûÁé∞‰∫Ü golang ‰∏≠ÁöÑÂçèÁ®ãÊú∫Âà∂ÔºåÂπ∂Êèê‰æõ‰∫Ü‰∏ÄÂ•óÂü∫‰∫éÂçèÁ®ãÁöÑÁΩëÁªúÁºñÁ®ãÊ°ÜÊû∂„ÄÇCO ÂçèÁ®ãËØûÁîü‰πãÂàùÔºåÂ∞±Ë¢´Áî®‰∫éÂµåÂÖ•ÂºèÁΩëÁªúÁ®ãÂ∫èÂºÄÂèëÔºåÂπ∂ÂèñÂæó‰∫ÜÁ´ãÁ´øËßÅÂΩ±ÁöÑÊïàÊûú„ÄÇ
Êà™Ëá≥ 2021 Âπ¥ÔºåCO ÂçèÁ®ãÂèàÊúâ‰∫ÜÈïøË∂≥ÁöÑÂèëÂ±ïÔºåÁõÆÂâçÂú® Linux/Windows/Mac Âπ≥Âè∞ÂùáÂ∑≤ÊîØÊåÅ hookÔºåÂπ∂‰∏îÂÆûÁé∞‰∫ÜÂçèÁ®ãÈîÅ„ÄÅÂçèÁ®ãÂêåÊ≠•‰∫ã‰ª∂„ÄÅÂçèÁ®ãÊ±†‰ª•Âèä golang ‰∏≠ÁöÑ channel ‰∏é waitgroupÔºåÁî®Êà∑ÂèØ‰ª•Áî® CO ÂÜôÂá∫ golang ÁöÑ‰ΩìÈ™å„ÄÇ
#Âø´ÈÄü‰∏äÊâã #ÁºñËØë Âª∫ËÆÆÂÆâË£Ö xmakeÔºåÂú® CO Ê†πÁõÆÂΩïÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÊûÑÂª∫ÊâÄÊúâÂ≠êÈ°πÁõÆÔºö">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="ÁÆÄ‰ªã" />
<meta property="og:description" content="#CO ÊòØ‰ªÄ‰πà CO ÊòØ‰∏Ä‰∏™‰ºòÈõÖ„ÄÅÈ´òÊïàÁöÑ C&#43;&#43; Âü∫Á°ÄÂ∫ìÔºåÊîØÊåÅ Linux, Windows ‰∏é Mac Á≠âÂπ≥Âè∞ÔºåÂÆÉÂÆûÁé∞‰∫ÜÁ±ª‰ºº golang ÁöÑÂçèÁ®ã„ÄÅÂü∫‰∫éÂçèÁ®ãÁöÑÁΩëÁªúÁºñÁ®ãÊ°ÜÊû∂„ÄÅÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏éÈÖçÁΩÆÊñá‰ª∂Ëß£ÊûêÂ∫ì„ÄÅÈ´òÊÄßËÉΩÊó•ÂøóÂ∫ì„ÄÅÂçïÂÖÉÊµãËØïÊ°ÜÊû∂„ÄÅJSON Â∫ìÁ≠â‰∏ÄÁ≥ªÂàóÈ´òË¥®ÈáèÁöÑÂü∫Á°ÄÁªÑ‰ª∂„ÄÇ
CO Âú® github ‰∏ä‰ª• MIT ËÆ∏ÂèØËØÅÂºÄÊ∫êÔºåÂÆÉ‰ΩøÁî®‰∫ÜÈÉ®ÂàÜ‰∏âÊñπ‰ª£Á†ÅÔºåÂèØËÉΩÊúâ‰∏çÂêåÁöÑËÆ∏ÂèØËØÅÔºåËØ¶ÊÉÖËßÅ LICENSE Êñá‰ª∂„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂõΩÂÜÖÁî®Êà∑Ôºågitee ‰∏ä‰πü‰ºöÂÆöÊúüÂêåÊ≠• github ‰∏äÁöÑ‰ª£Á†Å„ÄÇ
#CO ÁöÑÂèëÂ±ïÂéÜÁ®ã Alvin(idealvin) Ëá™ 2013 Âπ¥ÂºÄÂßãÂºÄÂèë COÔºåÊúÄÂàùÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂáèÂ∞ë C&#43;&#43; È°πÁõÆ‰∏≠ÁöÑ‰∏âÊñπ‰æùËµñÔºåÂêåÊó∂ÊèêÈ´ò C&#43;&#43; ÁöÑÂºÄÂèëÊïàÁéá„ÄÇ‰ªé 2015 Âπ¥ÂºÄÂßãÔºåAlvin Â∞Ü CO ÂºïÂÖ•ÂÆûÈôÖÈ°πÁõÆ‰∏≠Ôºå‰æõËá™Â∑±‰∏éÂêå‰∫ã‰ΩøÁî®ÔºåÂ§ßÂ§ßÁº©Âáè‰∫ÜÈ°πÁõÆÁöÑÂºÄÂèëÂë®ÊúüÔºåCO ‰πüÂæó‰ª•ÁªèÂèóÂ∑•‰∏öÈ°πÁõÆÁöÑÊ£ÄÈ™å„ÄÇ
ÁªèËøáÂ§öÂπ¥ÁöÑÁßØÁ¥Ø„ÄÅÊ≤âÊ∑ÄÔºåÂà∞ 2019 Âπ¥ÔºåAlvin ÂèàÁî® C&#43;&#43; ÂÆûÁé∞‰∫Ü golang ‰∏≠ÁöÑÂçèÁ®ãÊú∫Âà∂ÔºåÂπ∂Êèê‰æõ‰∫Ü‰∏ÄÂ•óÂü∫‰∫éÂçèÁ®ãÁöÑÁΩëÁªúÁºñÁ®ãÊ°ÜÊû∂„ÄÇCO ÂçèÁ®ãËØûÁîü‰πãÂàùÔºåÂ∞±Ë¢´Áî®‰∫éÂµåÂÖ•ÂºèÁΩëÁªúÁ®ãÂ∫èÂºÄÂèëÔºåÂπ∂ÂèñÂæó‰∫ÜÁ´ãÁ´øËßÅÂΩ±ÁöÑÊïàÊûú„ÄÇ
Êà™Ëá≥ 2021 Âπ¥ÔºåCO ÂçèÁ®ãÂèàÊúâ‰∫ÜÈïøË∂≥ÁöÑÂèëÂ±ïÔºåÁõÆÂâçÂú® Linux/Windows/Mac Âπ≥Âè∞ÂùáÂ∑≤ÊîØÊåÅ hookÔºåÂπ∂‰∏îÂÆûÁé∞‰∫ÜÂçèÁ®ãÈîÅ„ÄÅÂçèÁ®ãÂêåÊ≠•‰∫ã‰ª∂„ÄÅÂçèÁ®ãÊ±†‰ª•Âèä golang ‰∏≠ÁöÑ channel ‰∏é waitgroupÔºåÁî®Êà∑ÂèØ‰ª•Áî® CO ÂÜôÂá∫ golang ÁöÑ‰ΩìÈ™å„ÄÇ
#Âø´ÈÄü‰∏äÊâã #ÁºñËØë Âª∫ËÆÆÂÆâË£Ö xmakeÔºåÂú® CO Ê†πÁõÆÂΩïÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÊûÑÂª∫ÊâÄÊúâÂ≠êÈ°πÁõÆÔºö" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://coostdocs.github.io/cn/about/co/" /><meta property="article:section" content="about" />

<meta property="article:modified_time" content="2022-06-10T23:01:22+08:00" />

<title>ÁÆÄ‰ªã | Docs for Coost</title>
<link rel="manifest" href="../../../manifest.json">
<link rel="icon" href="../../../favicon.png" type="image/x-icon">
  <link rel="alternate" hreflang="en" href="https://coostdocs.github.io/en/about/co/" title="Introduction">
<link rel="stylesheet" href="../../../book.min.0608a3570dae40fa4b3de520d6a873cc9855bb4cb5001c4b16e95a226b84aff8.css" integrity="sha256-BgijVw2uQPpLPeUg1qhzzJhVu0y1ABxLFulaImuEr/g=" crossorigin="anonymous">
  <script defer src="../../../flexsearch.min.js"></script>
  <script defer src="../../../cn.search.min.b520c7ff2c6fc9cdb33c12d9eb1c9a1066938b8860f026c8f1e97a93c9a9557b.js" integrity="sha256-tSDH/yxvyc2zPBLZ6xyaEGaTi4hg8CbI8el6k8mpVXs=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  


<link href='//cdn.bootcss.com/highlight.js/11.1.0/styles/github.min.css'
  rel='stylesheet' type='text/css' />


</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="../../../cn/"><span>Docs for Coost</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="ÊêúÁ¥¢" aria-label="ÊêúÁ¥¢" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>ÂÖ≥‰∫é</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/about/co/" class=" active">ÁÆÄ‰ªã</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/about/contact/" class="">ËÅîÁ≥ª</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/about/sponsor/" class="">ËµûÂä©üíï</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>CO ÂèÇËÄÉÊñáÊ°£</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/def/" class="">Âü∫Êú¨ÂÆö‰πâ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/defer/" class="">defer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/atomic/" class="">ÂéüÂ≠êÊìç‰Ωú</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/fastring/" class="">Â≠óÁ¨¶‰∏≤(fastring)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/fastream/" class="">Â≠óÁ¨¶ÊµÅ(fastream)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/str/" class="">Â≠óÁ¨¶‰∏≤Êìç‰Ωú</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/flag/" class="">ÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏éÈÖçÁΩÆÊñá‰ª∂Ëß£Êûê</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/log/" class="">Êó•Âøó</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/unitest/" class="">ÂçïÂÖÉÊµãËØïÊ°ÜÊû∂</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/json/" class="">JSON</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/time/" class="">Êó∂Èó¥</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/thread/" class="">Á∫øÁ®ã</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/coroutine/" class="">ÂçèÁ®ã</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-752f64a904309658adbf6062b2c3d8c1" class="toggle"  />
    <label for="section-752f64a904309658adbf6062b2c3d8c1" class="flex justify-between">
      <a role="button" class="">ÁΩëÁªúÁºñÁ®ã</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/byte_order/" class="">Â≠óËäÇÂ∫è</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/tcp/" class="">TCP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/http/" class="">HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/net/rpc/" class="">RPC</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/tasked/" class="">ÂÆöÊó∂‰ªªÂä°</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/random/" class="">ÈöèÊú∫Êï∞</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/lrumap/" class="">LruMap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/hash/" class="">Hash</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/path/" class="">Êñá‰ª∂Ë∑ØÂæÑ(path)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/fs/" class="">Êñá‰ª∂Á≥ªÁªü</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/os/" class="">Êìç‰ΩúÁ≥ªÁªü</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="../../../cn/co/build/" class="">ÁºñËØë</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>ÁÆÄ‰ªã</strong>

  <label for="toc-control">
    
    <img src="../../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#co-ÊòØ‰ªÄ‰πà">CO ÊòØ‰ªÄ‰πà</a></li>
        <li><a href="#co-ÁöÑÂèëÂ±ïÂéÜÁ®ã">CO ÁöÑÂèëÂ±ïÂéÜÁ®ã</a></li>
        <li><a href="#Âø´ÈÄü‰∏äÊâã">Âø´ÈÄü‰∏äÊâã</a>
          <ul>
            <li><a href="#ÁºñËØë">ÁºñËØë</a></li>
            <li><a href="#‰ΩøÁî®-co-ÂºÄÂèë-c-È°πÁõÆ">‰ΩøÁî® CO ÂºÄÂèë C++ È°πÁõÆ</a></li>
          </ul>
        </li>
        <li><a href="#Ê†∏ÂøÉÁªÑ‰ª∂">Ê†∏ÂøÉÁªÑ‰ª∂</a>
          <ul>
            <li><a href="#coflag">co/flag</a></li>
            <li><a href="#colog">co/log</a></li>
            <li><a href="#counitest">co/unitest</a></li>
            <li><a href="#ÂçèÁ®ã">ÂçèÁ®ã</a>
              <ul>
                <li><a href="#ÂàõÂª∫ÂçèÁ®ã">ÂàõÂª∫ÂçèÁ®ã</a></li>
                <li><a href="#channel">channel</a></li>
                <li><a href="#waitgroup">waitgroup</a></li>
              </ul>
            </li>
            <li><a href="#ÁΩëÁªúÁºñÁ®ã">ÁΩëÁªúÁºñÁ®ã</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h2 id="co-ÊòØ‰ªÄ‰πà"><a class="anchor" href="#co-%e6%98%af%e4%bb%80%e4%b9%88">#</a>CO ÊòØ‰ªÄ‰πà</h2>
<p>CO ÊòØ‰∏Ä‰∏™‰ºòÈõÖ„ÄÅÈ´òÊïàÁöÑ C++ Âü∫Á°ÄÂ∫ìÔºåÊîØÊåÅ Linux, Windows ‰∏é Mac Á≠âÂπ≥Âè∞ÔºåÂÆÉÂÆûÁé∞‰∫ÜÁ±ª‰ºº golang ÁöÑÂçèÁ®ã„ÄÅÂü∫‰∫éÂçèÁ®ãÁöÑÁΩëÁªúÁºñÁ®ãÊ°ÜÊû∂„ÄÅÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏éÈÖçÁΩÆÊñá‰ª∂Ëß£ÊûêÂ∫ì„ÄÅÈ´òÊÄßËÉΩÊó•ÂøóÂ∫ì„ÄÅÂçïÂÖÉÊµãËØïÊ°ÜÊû∂„ÄÅJSON Â∫ìÁ≠â‰∏ÄÁ≥ªÂàóÈ´òË¥®ÈáèÁöÑÂü∫Á°ÄÁªÑ‰ª∂„ÄÇ</p>
<p>CO Âú® <a href="https://github.com/idealvin/co">github</a> ‰∏ä‰ª• <a href="https://mit-license.org/">MIT</a> ËÆ∏ÂèØËØÅÂºÄÊ∫êÔºåÂÆÉ‰ΩøÁî®‰∫ÜÈÉ®ÂàÜ‰∏âÊñπ‰ª£Á†ÅÔºåÂèØËÉΩÊúâ‰∏çÂêåÁöÑËÆ∏ÂèØËØÅÔºåËØ¶ÊÉÖËßÅ <a href="https://github.com/idealvin/co/blob/master/LICENSE.md">LICENSE</a> Êñá‰ª∂„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂõΩÂÜÖÁî®Êà∑Ôºå<a href="https://gitee.com/idealvin/co">gitee</a> ‰∏ä‰πü‰ºöÂÆöÊúüÂêåÊ≠• github ‰∏äÁöÑ‰ª£Á†Å„ÄÇ</p>
<h2 id="co-ÁöÑÂèëÂ±ïÂéÜÁ®ã"><a class="anchor" href="#co-%e7%9a%84%e5%8f%91%e5%b1%95%e5%8e%86%e7%a8%8b">#</a>CO ÁöÑÂèëÂ±ïÂéÜÁ®ã</h2>
<p><a href="https://github.com/idealvin">Alvin(idealvin)</a> Ëá™ 2013 Âπ¥ÂºÄÂßãÂºÄÂèë COÔºåÊúÄÂàùÁöÑÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂáèÂ∞ë C++ È°πÁõÆ‰∏≠ÁöÑ‰∏âÊñπ‰æùËµñÔºåÂêåÊó∂ÊèêÈ´ò C++ ÁöÑÂºÄÂèëÊïàÁéá„ÄÇ‰ªé 2015 Âπ¥ÂºÄÂßãÔºåAlvin Â∞Ü CO ÂºïÂÖ•ÂÆûÈôÖÈ°πÁõÆ‰∏≠Ôºå‰æõËá™Â∑±‰∏éÂêå‰∫ã‰ΩøÁî®ÔºåÂ§ßÂ§ßÁº©Âáè‰∫ÜÈ°πÁõÆÁöÑÂºÄÂèëÂë®ÊúüÔºåCO ‰πüÂæó‰ª•ÁªèÂèóÂ∑•‰∏öÈ°πÁõÆÁöÑÊ£ÄÈ™å„ÄÇ</p>
<p>ÁªèËøáÂ§öÂπ¥ÁöÑÁßØÁ¥Ø„ÄÅÊ≤âÊ∑ÄÔºåÂà∞ 2019 Âπ¥ÔºåAlvin ÂèàÁî® C++ ÂÆûÁé∞‰∫Ü golang ‰∏≠ÁöÑÂçèÁ®ãÊú∫Âà∂ÔºåÂπ∂Êèê‰æõ‰∫Ü‰∏ÄÂ•óÂü∫‰∫éÂçèÁ®ãÁöÑÁΩëÁªúÁºñÁ®ãÊ°ÜÊû∂„ÄÇCO ÂçèÁ®ãËØûÁîü‰πãÂàùÔºåÂ∞±Ë¢´Áî®‰∫éÂµåÂÖ•ÂºèÁΩëÁªúÁ®ãÂ∫èÂºÄÂèëÔºåÂπ∂ÂèñÂæó‰∫ÜÁ´ãÁ´øËßÅÂΩ±ÁöÑÊïàÊûú„ÄÇ</p>
<p>Êà™Ëá≥ 2021 Âπ¥ÔºåCO ÂçèÁ®ãÂèàÊúâ‰∫ÜÈïøË∂≥ÁöÑÂèëÂ±ïÔºåÁõÆÂâçÂú® Linux/Windows/Mac Âπ≥Âè∞ÂùáÂ∑≤ÊîØÊåÅ hookÔºåÂπ∂‰∏îÂÆûÁé∞‰∫ÜÂçèÁ®ãÈîÅ„ÄÅÂçèÁ®ãÂêåÊ≠•‰∫ã‰ª∂„ÄÅÂçèÁ®ãÊ±†‰ª•Âèä golang ‰∏≠ÁöÑ channel ‰∏é waitgroupÔºåÁî®Êà∑ÂèØ‰ª•Áî® CO ÂÜôÂá∫ golang ÁöÑ‰ΩìÈ™å„ÄÇ</p>
<h2 id="Âø´ÈÄü‰∏äÊâã"><a class="anchor" href="#%e5%bf%ab%e9%80%9f%e4%b8%8a%e6%89%8b">#</a>Âø´ÈÄü‰∏äÊâã</h2>
<h3 id="ÁºñËØë"><a class="anchor" href="#%e7%bc%96%e8%af%91">#</a>ÁºñËØë</h3>
<p>Âª∫ËÆÆÂÆâË£Ö <a href="https://github.com/xmake-io/xmake">xmake</a>ÔºåÂú® CO Ê†πÁõÆÂΩïÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÊûÑÂª∫ÊâÄÊúâÂ≠êÈ°πÁõÆÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>xmake -a
</span></span></code></pre></div><p>Â¶ÇÊûúÈúÄË¶Å‰ΩøÁî® http::Client, SSL Êàñ HTTPS ÁâπÊÄßÔºåÂàôÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÊûÑÂª∫Ôºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>xmake f --with_libcurl<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">true</span> --with_openssl<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">true</span>
</span></span><span style="display:flex;"><span>xmake -a
</span></span></code></pre></div><p>xmake ‰ºöËá™Âä®‰ªéÁΩëÁªúÂÆâË£Ö libcurl ‰∏é opensslÔºåËßÜÁΩëÁªúÊÉÖÂÜµÔºåËøô‰∏™ËøáÁ®ãÂèØËÉΩ‰ºöËæÉÊÖ¢„ÄÇ<code>xmake -a</code> ‰ºöÊûÑÂª∫ <a href="https://github.com/idealvin/co/tree/master/src">libco</a>, <a href="https://github.com/idealvin/co/tree/master/gen">gen</a>, <a href="https://github.com/idealvin/co/tree/master/unitest">co/unitest</a> ‰ª•Âèä <a href="https://github.com/idealvin/co/tree/master/test">co/test</a> ‰∏ãÈù¢ÁöÑÊâÄÊúâÊµãËØï‰ª£Á†Å„ÄÇÁî®Êà∑ÂèØ‰ª•ÊâßË°å‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÔºåËøêË°å CO ‰∏≠ÁöÑÊµãËØïÁ®ãÂ∫èÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>xmake r unitest
</span></span><span style="display:flex;"><span>xmake r flag
</span></span><span style="display:flex;"><span>xmake r log -cout
</span></span><span style="display:flex;"><span>xmake r co
</span></span></code></pre></div><h3 id="‰ΩøÁî®-co-ÂºÄÂèë-c-È°πÁõÆ"><a class="anchor" href="#%e4%bd%bf%e7%94%a8-co-%e5%bc%80%e5%8f%91-c-%e9%a1%b9%e7%9b%ae">#</a>‰ΩøÁî® CO ÂºÄÂèë C++ È°πÁõÆ</h3>
<p>ÊúÄÁÆÄÂçïÁöÑÔºåÂèØ‰ª•Áõ¥Êé•ÂåÖÂê´ <a href="https://github.com/idealvin/co/blob/master/include/co/all.h">co/all.h</a>Ôºå‰ΩøÁî® CO ‰∏≠ÁöÑÊâÄÊúâÁâπÊÄß„ÄÇÂ¶ÇÊûúÊãÖÂøÉÂΩ±ÂìçÁºñËØëÈÄüÂ∫¶Ôºå‰πüÂèØ‰ª•Âè™ÂåÖÂê´ÈúÄË¶ÅÁî®Âà∞ÁöÑÂ§¥Êñá‰ª∂ÔºåÂ¶ÇÂåÖÂê´ <a href="https://github.com/idealvin/co/blob/master/include/co/co.h">co/co.h</a>ÔºåÂèØ‰ª•‰ΩøÁî® co/flag, co/log ‰ª•ÂèäÂçèÁ®ãÁõ∏ÂÖ≥ÁöÑÊâÄÊúâÁâπÊÄß„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/all.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>DEF_string(s, <span style="color:#d14">&#34;nice&#34;</span>, <span style="color:#d14">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">**</span> argv) {
</span></span><span style="display:flex;"><span>    flag<span style="color:#000;font-weight:bold">::</span>init(argc, argv);
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_s;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>‰∏äÈù¢ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÔºåmain ÂáΩÊï∞Á¨¨‰∏ÄË°åÁî®‰∫éËß£ÊûêÂëΩ‰ª§Ë°åÂèÇÊï∞ÂèäÈÖçÁΩÆÊñá‰ª∂„ÄÇCO ‰∏≠ÁöÑÈÉ®ÂàÜÁªÑ‰ª∂‰ºöÁî® flag ÂÆö‰πâÈÖçÁΩÆÈ°πÔºåÂõ†Ê≠§Ôºå‰∏ÄËà¨ÈúÄË¶ÅÂú® main ÂáΩÊï∞ÂºÄÂ§¥Ë∞ÉÁî® <code>flag::init()</code> ËøõË°åÂàùÂßãÂåñ„ÄÇ</p>
<p>Áî®Êà∑‰πüÂèØ‰ª•Áî®ÂÆè <code>DEF_main</code> ÂÆö‰πâ main ÂáΩÊï∞Ôºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/all.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>DEF_string(s, <span style="color:#d14">&#34;nice&#34;</span>, <span style="color:#d14">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DEF_main(argc, argv) {
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_s;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>DEF_main Âú®ÂÜÖÈÉ®Â∑≤ÁªèË∞ÉÁî®‰∫Ü <code>flag::init()</code> Áî®Êà∑Êó†ÈúÄÂÜçÊ¨°Ë∞ÉÁî®„ÄÇÂè¶Â§ñÔºåDEF_main ‰ºöÂ∞Ü main ÂáΩÊï∞‰∏≠ÁöÑ‰ª£Á†ÅÊîæÂà∞ÂçèÁ®ã‰∏≠ËøêË°åÔºå‰∏é golang ‰øùÊåÅ‰∏ÄËá¥Ôºågolang ‰∏≠ÁöÑ main ÂáΩÊï∞‰πüÂú®ÂçèÁ®ã‰∏≠„ÄÇCO ‰∏≠ÈÉ®ÂàÜÂçèÁ®ãÁõ∏ÂÖ≥ÁöÑÁªÑ‰ª∂ÂøÖÈ°ªÂú®ÂçèÁ®ã‰∏≠‰ΩøÁî®ÔºåÁî® CO ÂºÄÂèëÂü∫‰∫éÂçèÁ®ãÁöÑÂ∫îÁî®Á®ãÂ∫èÊó∂Ôºå‰∏ÄËà¨Âª∫ËÆÆÁî® DEF_main ÂÆö‰πâ main ÂáΩÊï∞„ÄÇ</p>
<h2 id="Ê†∏ÂøÉÁªÑ‰ª∂"><a class="anchor" href="#%e6%a0%b8%e5%bf%83%e7%bb%84%e4%bb%b6">#</a>Ê†∏ÂøÉÁªÑ‰ª∂</h2>
<h3 id="coflag"><a class="anchor" href="#coflag">#</a>co/flag</h3>
<p><a href="../../co/flag/">co/flag</a> ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÊòìÁî®ÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏éÈÖçÁΩÆÊñá‰ª∂Ëß£ÊûêÂ∫ìÔºåCO ‰∏≠ÁöÑ‰∏Ä‰∫õÁªÑ‰ª∂‰ºöÁî®ÂÆÉÂÆö‰πâÈÖçÁΩÆÈ°π„ÄÇ</p>
<p>co/flag ‰∏∫ÊØè‰∏™ÈÖçÁΩÆÈ°πÊèê‰æõ‰∏Ä‰∏™ÈªòËÆ§ÂÄºÔºåÂú®Ê≤°ÊúâÈÖçÁΩÆÂèÇÊï∞ÁöÑÊÉÖÂÜµ‰∏ãÔºåÁ®ãÂ∫èÂèØ‰ª•ÊåâÈªòËÆ§ÈÖçÁΩÆËøêË°å„ÄÇÁî®Êà∑‰πüÂèØ‰ª•‰ªé<strong>ÂëΩ‰ª§Ë°åÊàñÈÖçÁΩÆÊñá‰ª∂</strong>‰º†ÂÖ•ÈÖçÁΩÆÂèÇÊï∞ÔºåÂú®ÈúÄË¶ÅÈÖçÁΩÆÊñá‰ª∂Êó∂ÔºåÂèØ‰ª•ÊâßË°å <code>./exe -mkconf</code> <strong>Ëá™Âä®ÁîüÊàêÈÖçÁΩÆÊñá‰ª∂</strong>„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// xx.cc
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/flag.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/cout.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>DEF_bool(x, <span style="color:#0086b3">false</span>, <span style="color:#d14">&#34;bool x&#34;</span>);
</span></span><span style="display:flex;"><span>DEF_bool(y, <span style="color:#0086b3">false</span>, <span style="color:#d14">&#34;bool y&#34;</span>);
</span></span><span style="display:flex;"><span>DEF_uint32(u32, <span style="color:#099">0</span>, <span style="color:#d14">&#34;...&#34;</span>);
</span></span><span style="display:flex;"><span>DEF_string(s, <span style="color:#d14">&#34;hello world&#34;</span>, <span style="color:#d14">&#34;string&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">**</span> argv) {
</span></span><span style="display:flex;"><span>    flag<span style="color:#000;font-weight:bold">::</span>init(argc, argv);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    COUT <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;x: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_x;
</span></span><span style="display:flex;"><span>    COUT <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;y: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_y;
</span></span><span style="display:flex;"><span>    COUT <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;u32: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_u32;
</span></span><span style="display:flex;"><span>    COUT <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_s <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;|&#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> FLG_s.size();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>‰∏äÈù¢ÊòØ‰∏Ä‰∏™‰ΩøÁî® co/flag ÁöÑ‰æãÂ≠êÔºå‰ª£Á†Å‰∏≠ <code>DEF_</code> ÂºÄÂ§¥ÁöÑÂÆèÔºåÂÆö‰πâ‰∫Ü 4 ‰∏™ÈÖçÁΩÆÈ°πÔºåÊØè‰∏™ÈÖçÁΩÆÈ°πÁõ∏ÂΩì‰∫é‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáèÔºåÂèòÈáèÂêçÊòØ <code>FLG_</code> Âä†ÈÖçÁΩÆÂêç„ÄÇ‰∏äÈù¢ÁöÑ‰ª£Á†ÅÁºñËØëÂÆåÂêéÔºåÂèØ‰ª•Êåâ‰∏ãÈù¢ÁöÑÊñπÂºèËøêË°åÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>./xx                  <span style="color:#998;font-style:italic"># ÊåâÈªòËÆ§ÈÖçÁΩÆËøêË°å</span>
</span></span><span style="display:flex;"><span>./xx -xy -s good      <span style="color:#998;font-style:italic"># ÂçïÂ≠óÊØçÂëΩÂêçÁöÑ bool flag, ÂèØ‰ª•‰∏ÄÂπ∂ËÆæÁΩÆ‰∏∫ true</span>
</span></span><span style="display:flex;"><span>./xx -s <span style="color:#d14">&#34;I&#39;m ok&#34;</span>      <span style="color:#998;font-style:italic"># Âê´Á©∫Ê†ºÁöÑÂ≠óÁ¨¶‰∏≤</span>
</span></span><span style="display:flex;"><span>./xx -u32 8k          <span style="color:#998;font-style:italic"># Êï¥Êï∞ÂèØ‰ª•Â∏¶Âçï‰Ωç: k,m,g,t,p, ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./xx -mkconf          <span style="color:#998;font-style:italic"># Ëá™Âä®ÁîüÊàêÈÖçÁΩÆÊñá‰ª∂ xx.conf</span>
</span></span><span style="display:flex;"><span>./xx xx.conf          <span style="color:#998;font-style:italic"># ‰ªéÈÖçÁΩÆÊñá‰ª∂‰º†ÂÖ•ÂèÇÊï∞</span>
</span></span><span style="display:flex;"><span>./xx -config xx.conf  <span style="color:#998;font-style:italic"># ‰∏é‰∏äÂêå</span>
</span></span></code></pre></div><h3 id="colog"><a class="anchor" href="#colog">#</a>co/log</h3>
<p><a href="../../co/log/">co/log</a> ÊòØ‰∏Ä‰∏™È´òÊÄßËÉΩÁöÑÊú¨Âú∞Êó•ÂøóÁ≥ªÁªüÔºåCO ‰∏≠ÁöÑ‰∏Ä‰∫õÁªÑ‰ª∂‰ºöÁî®ÂÆÉÊâìÂç∞Êó•Âøó„ÄÇ</p>
<p>co/log Â∞ÜÊó•ÂøóÂàÜ‰∏∫ debug, info, warning, error, fatal 5 ‰∏™Á∫ßÂà´Ôºå<strong>ÊâìÂç∞ fatal Á∫ßÂà´ÁöÑÊó•Âøó‰ºöÁªàÊ≠¢Á®ãÂ∫èÁöÑËøêË°å</strong>„ÄÇÁî®Êà∑ÂèØ‰ª•ÂÉè‰∏ãÈù¢ËøôÊ†∑ÊâìÂç∞‰∏çÂêåÁ∫ßÂà´ÁöÑÊó•ÂøóÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>DLOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;  <span style="color:#998;font-style:italic">// debug
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;   <span style="color:#998;font-style:italic">// info
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>WLOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;  <span style="color:#998;font-style:italic">// warning
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>ELOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;  <span style="color:#998;font-style:italic">// error
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>FLOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">23</span>;  <span style="color:#998;font-style:italic">// fatal
</span></span></span></code></pre></div><p>co/log ËøòÊèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàó <code>CHECK</code> ÂÆèÔºåÂèØ‰ª•ËßÜ‰∏∫Âä†Âº∫ÁâàÁöÑ <code>assert</code>ÔºåÂÆÉ‰ª¨Âú® debug Ê®°Âºè‰∏ã‰πü‰∏ç‰ºöË¢´Ê∏ÖÈô§„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span><span style="color:#000;font-weight:bold">*</span> p <span style="color:#000;font-weight:bold">=</span> malloc(<span style="color:#099">32</span>);
</span></span><span style="display:flex;"><span>CHECK(p <span style="color:#000;font-weight:bold">!=</span> <span style="color:#0086b3">NULL</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;malloc failed..&#34;</span>;
</span></span><span style="display:flex;"><span>CHECK_NE(p, <span style="color:#0086b3">NULL</span>) <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;malloc failed..&#34;</span>;
</span></span></code></pre></div><p>CHECK Êñ≠Ë®ÄÂ§±Ë¥•Êó∂Ôºåco/log ‰ºöÊâìÂç∞ÂáΩÊï∞Ë∞ÉÁî®Ê†à‰ø°ÊÅØÔºåÁÑ∂ÂêéÁªàÊ≠¢Á®ãÂ∫èÁöÑËøêË°å„ÄÇ</p>
<p>co/log ÈÄüÂ∫¶ÈùûÂ∏∏Âø´ÔºåÂú®Á®ãÂ∫èËøêË°åÁ®≥ÂÆöÂêéÔºåÂá†‰πé‰∏çÈúÄË¶ÅÂÜÖÂ≠òÂàÜÈÖçÊìç‰Ωú„ÄÇ‰∏ãÈù¢ÊòØ‰∏Ä‰∫õÊµãËØïÁªìÊûúÔºå‰ªÖ‰æõÂèÇËÄÉÔºö</p>
<ul>
<li>
<p>co/log vs glog (single thread)</p>
<table>
<thead>
<tr>
<th>platform</th>
<th>google glog</th>
<th>co/log</th>
</tr>
</thead>
<tbody>
<tr>
<td>win2012 HHD</td>
<td>1.6MB/s</td>
<td>180MB/s</td>
</tr>
<tr>
<td>win10 SSD</td>
<td>3.7MB/s</td>
<td>560MB/s</td>
</tr>
<tr>
<td>mac SSD</td>
<td>17MB/s</td>
<td>450MB/s</td>
</tr>
<tr>
<td>linux SSD</td>
<td>54MB/s</td>
<td>1023MB/s</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><a href="https://github.com/idealvin/co/tree/benchmark">co/log vs spdlog</a> (Windows)</p>
<table>
<thead>
<tr>
<th>threads</th>
<th>total logs</th>
<th>co/log time(seconds)</th>
<th>spdlog time(seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1000000</td>
<td>0.103619</td>
<td>0.482525</td>
</tr>
<tr>
<td>2</td>
<td>1000000</td>
<td>0.202246</td>
<td>0.565262</td>
</tr>
<tr>
<td>4</td>
<td>1000000</td>
<td>0.330694</td>
<td>0.722709</td>
</tr>
<tr>
<td>8</td>
<td>1000000</td>
<td>0.386760</td>
<td>1.322471</td>
</tr>
</tbody>
</table>
</li>
<li>
<p><a href="https://github.com/idealvin/co/tree/benchmark">co/log vs spdlog</a> (Linux)</p>
<table>
<thead>
<tr>
<th>threads</th>
<th>total logs</th>
<th>co/log time(seconds)</th>
<th>spdlog time(seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1000000</td>
<td>0.096445</td>
<td>2.006087</td>
</tr>
<tr>
<td>2</td>
<td>1000000</td>
<td>0.142160</td>
<td>3.276006</td>
</tr>
<tr>
<td>4</td>
<td>1000000</td>
<td>0.181407</td>
<td>4.339714</td>
</tr>
<tr>
<td>8</td>
<td>1000000</td>
<td>0.303968</td>
<td>4.700860</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h3 id="counitest"><a class="anchor" href="#counitest">#</a>co/unitest</h3>
<p><a href="../../co/unitest/">co/unitest</a> ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÊòìÁî®ÁöÑÂçïÂÖÉÊµãËØïÊ°ÜÊû∂ÔºåCO ‰∏≠ÁöÑÂæàÂ§öÁªÑ‰ª∂‰ºöÁî®ÂÆÉÂÜôÂçïÂÖÉÊµãËØï‰ª£Á†ÅÔºå‰∏∫ CO ÁöÑÁ®≥ÂÆöÊÄßÊèê‰æõ‰∫Ü‰øùÈöú„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/unitest.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/os.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">namespace</span> test {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>DEF_test(os) {
</span></span><span style="display:flex;"><span>    DEF_case(homedir) {
</span></span><span style="display:flex;"><span>        EXPECT_NE(os<span style="color:#000;font-weight:bold">::</span>homedir(), <span style="color:#d14">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    DEF_case(cpunum) {
</span></span><span style="display:flex;"><span>        EXPECT_GT(os<span style="color:#000;font-weight:bold">::</span>cpunum(), <span style="color:#099">0</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>} <span style="color:#998;font-style:italic">// namespace test
</span></span></span></code></pre></div><p>‰∏äÈù¢ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ‰æãÂ≠êÔºå<code>DEF_test</code> ÂÆèÂÆö‰πâ‰∫Ü‰∏Ä‰∏™ÊµãËØïÂçïÂÖÉÔºåÂÆûÈôÖ‰∏äÂ∞±ÊòØ‰∏Ä‰∏™ÂáΩÊï∞(Á±ª‰∏≠ÁöÑÊñπÊ≥ï)„ÄÇ<code>DEF_case</code> ÂÆèÂÆö‰πâ‰∫ÜÊµãËØïÁî®‰æãÔºåÊØè‰∏™ÊµãËØïÁî®‰æãÂÆûÈôÖ‰∏äÂ∞±ÊòØ‰∏Ä‰∏™‰ª£Á†ÅÂùó„ÄÇÂ§ö‰∏™ÊµãËØïÂçïÂÖÉÂèØ‰ª•ÊîæÂà∞Âêå‰∏Ä‰∏™ C++ È°πÁõÆ‰∏≠Ôºåmain ÂáΩÊï∞‰∏ÄËà¨Âè™ÈúÄË¶Å‰∏ãÈù¢Âá†Ë°åÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/unitest.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">**</span> argv) {
</span></span><span style="display:flex;"><span>    flag<span style="color:#000;font-weight:bold">::</span>init(argc, argv);
</span></span><span style="display:flex;"><span>    unitest<span style="color:#000;font-weight:bold">::</span>run_all_tests();
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><a href="https://github.com/idealvin/co/tree/master/unitest">co/unitest</a> ÁõÆÂΩï‰∏ãÈù¢ÊòØ CO ‰∏≠ÁöÑÂçïÂÖÉÊµãËØï‰ª£Á†ÅÔºåÁºñËØëÂêéÂèØÊâßË°å‰∏ãËø∞ÂëΩ‰ª§ËøêË°åÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>xmake r unitest -a   <span style="color:#998;font-style:italic"># ËøêË°åÊâÄÊúâÂçïÂÖÉÊµãËØïÁî®‰æã</span>
</span></span><span style="display:flex;"><span>xmake r unitest -os  <span style="color:#998;font-style:italic"># ‰ªÖËøêË°å os ÂçïÂÖÉ‰∏≠ÁöÑÊµãËØïÁî®‰æã</span>
</span></span></code></pre></div><h3 id="ÂçèÁ®ã"><a class="anchor" href="#%e5%8d%8f%e7%a8%8b">#</a>ÂçèÁ®ã</h3>
<p>CO ÂÆûÁé∞‰∫ÜÁ±ª‰ºº <a href="https://github.com/golang/go">golang</a> ÁöÑÂçèÁ®ãÔºåÂÆÉÊúâÂ¶Ç‰∏ãÁâπÊÄßÔºö</p>
<ul>
<li>Â§öÁ∫øÁ®ãË∞ÉÂ∫¶ÔºåÈªòËÆ§Á∫øÁ®ãÊï∞‰∏∫Á≥ªÁªü CPU Ê†∏Êï∞„ÄÇ</li>
<li>ÂÖ±‰∫´Ê†àÔºåÂêå‰∏ÄÁ∫øÁ®ã‰∏≠ÁöÑÂçèÁ®ãÂÖ±Áî®Ëã•Âπ≤‰∏™Ê†à(Â§ßÂ∞èÈªòËÆ§‰∏∫ 1MB)ÔºåÂÜÖÂ≠òÂç†Áî®‰ΩéÔºåLinux ‰∏äÁöÑÊµãËØïÊòæÁ§∫ 1000 ‰∏áÂçèÁ®ãÂè™Áî®‰∫Ü 2.8G ÂÜÖÂ≠ò(‰ªÖ‰æõÂèÇËÄÉ)„ÄÇ</li>
<li>ÂêÑÂçèÁ®ã‰πãÈó¥‰∏∫Âπ≥Á∫ßÂÖ≥Á≥ªÔºåÂèØ‰ª•Âú®‰ªª‰ΩïÂú∞Êñπ(ÂåÖÊã¨Âú®ÂçèÁ®ã‰∏≠)ÂàõÂª∫Êñ∞ÁöÑÂçèÁ®ã„ÄÇ</li>
<li>ÊîØÊåÅÁ≥ªÁªü API hook (Windows/Linux/Mac)ÔºåÂèØ‰ª•Áõ¥Êé•Âú®ÂçèÁ®ã‰∏≠‰ΩøÁî®‰∏âÊñπÁΩëÁªúÂ∫ì„ÄÇ</li>
<li>ÂçèÁ®ãÂåñÁöÑ <a href="../../co/coroutine/#%e5%8d%8f%e7%a8%8b%e5%8c%96%e7%9a%84-socket-api">socket API</a>„ÄÇ</li>
<li>ÂçèÁ®ãÂêåÊ≠•‰∫ã‰ª∂ <a href="../../co/coroutine/#%e5%8d%8f%e7%a8%8b%e5%90%8c%e6%ad%a5%e4%ba%8b%e4%bb%b6coevent">co::Event</a>„ÄÇ</li>
<li>ÂçèÁ®ãÈîÅ <a href="../../co/coroutine/#%e5%8d%8f%e7%a8%8b%e9%94%81comutex">co::Mutex</a>„ÄÇ</li>
<li>ÂçèÁ®ãÊ±† <a href="../../co/coroutine/#%e5%8d%8f%e7%a8%8b%e6%b1%a0copool">co::Pool</a>„ÄÇ</li>
<li>channel <a href="../../co/coroutine/#channelcochan">co::Chan</a>„ÄÇ</li>
<li>waitgroup <a href="../../co/coroutine/#waitgroupcowaitgroup">co::WaitGroup</a>„ÄÇ</li>
</ul>
<h4 id="ÂàõÂª∫ÂçèÁ®ã"><a class="anchor" href="#%e5%88%9b%e5%bb%ba%e5%8d%8f%e7%a8%8b">#</a>ÂàõÂª∫ÂçèÁ®ã</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>go(ku);            <span style="color:#998;font-style:italic">// void ku();
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>go(f, <span style="color:#099">7</span>);          <span style="color:#998;font-style:italic">// void f(int);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>go(<span style="color:#000;font-weight:bold">&amp;</span>T<span style="color:#000;font-weight:bold">::</span>f, <span style="color:#000;font-weight:bold">&amp;</span>o);     <span style="color:#998;font-style:italic">// void T::f(); T o;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>go(<span style="color:#000;font-weight:bold">&amp;</span>T<span style="color:#000;font-weight:bold">::</span>f, <span style="color:#000;font-weight:bold">&amp;</span>o, <span style="color:#099">7</span>);  <span style="color:#998;font-style:italic">// void T::f(int); T o;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>go([](){
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;hello go&#34;</span>;
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>‰∏äÈù¢ÊòØÁî® <code>go()</code> ÂàõÂª∫ÂçèÁ®ãÁöÑ‰æãÂ≠êÔºågo() ÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂÆÉÊé•Âèó 1 Âà∞ 3 ‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ <code>f</code> ÊòØ‰ªªÊÑèÂèØË∞ÉÁî®ÁöÑÂØπË±°ÔºåËøô‰∫õÂèÇÊï∞Âè™Ë¶ÅÊª°Ë∂≥ <code>f()</code>, <code>(*f)()</code>, <code>f(p)</code>, <code>(*f)(p)</code>, <code>(o-&gt;*f)()</code> ÊàñËÄÖ <code>(o-&gt;*f)(p)</code> ËÉΩË¢´Ë∞ÉÁî®Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ</p>
<p><code>go()</code> ÂàõÂª∫ÁöÑÂçèÁ®ã‰ºöÂùáÂåÄÁöÑÂàÜÈÖçÂà∞‰∏çÂêåÁöÑË∞ÉÂ∫¶Á∫øÁ®ã‰∏≠„ÄÇÂ¶ÇÊûúÁî®Êà∑ÊÉ≥ËÆ©Êüê‰∫õÂçèÁ®ãËøêË°åÂú®Âêå‰∏Ä‰∏™Á∫øÁ®ã‰∏ãÔºåÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÊñπÂºèÂàõÂª∫ÂçèÁ®ãÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">auto</span> s <span style="color:#000;font-weight:bold">=</span> co<span style="color:#000;font-weight:bold">::</span>next_scheduler();
</span></span><span style="display:flex;"><span>s<span style="color:#000;font-weight:bold">-&gt;</span>go(f1);
</span></span><span style="display:flex;"><span>s<span style="color:#000;font-weight:bold">-&gt;</span>go(f2);
</span></span></code></pre></div><p>Â¶ÇÊûúÁî®Êà∑ÊÉ≥Âú®ÊâÄÊúâÁöÑË∞ÉÂ∫¶Á∫øÁ®ã‰∏≠ÂàõÂª∫ÂçèÁ®ãÔºåÂèØ‰ª•Áî®‰∏ãÈù¢ÁöÑÊñπÂºèÔºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">auto</span><span style="color:#000;font-weight:bold">&amp;</span> s <span style="color:#000;font-weight:bold">=</span> co<span style="color:#000;font-weight:bold">::</span>all_schedulers();
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">for</span> (size_t i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>; i <span style="color:#000;font-weight:bold">&lt;</span> s.size(); <span style="color:#000;font-weight:bold">++</span>i) {
</span></span><span style="display:flex;"><span>    s[i]<span style="color:#000;font-weight:bold">-&gt;</span>go(f);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="channel"><a class="anchor" href="#channel">#</a>channel</h4>
<p><a href="../../co/coroutine/#channelcochan">co::Chan</a>ÔºåÁ±ª‰ºº‰∫é golang ‰∏≠ÁöÑ channelÔºåÂèØÁî®‰∫éÂú®ÂçèÁ®ã‰πãÈó¥‰º†ÈÄíÊï∞ÊçÆ„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/co.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>DEF_main(argc, argv) {
</span></span><span style="display:flex;"><span>    co<span style="color:#000;font-weight:bold">::</span>Chan<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">&gt;</span> ch;
</span></span><span style="display:flex;"><span>    go([ch]() {
</span></span><span style="display:flex;"><span>        ch <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">7</span>;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">int</span> v <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>    ch <span style="color:#000;font-weight:bold">&gt;&gt;</span> v;
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;v: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> v;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>channel ÁöÑËØªÂÜôÊìç‰ΩúÂøÖÈ°ªÂú®ÂçèÁ®ã‰∏≠ËøõË°å</strong>ÔºåÂõ†Ê≠§‰∏äËø∞‰ª£Á†Å‰∏≠Áî® <code>DEF_main</code> ÂÆö‰πâ main ÂáΩÊï∞ÔºåËÆ© main ÂáΩÊï∞‰∏≠ÁöÑ‰ª£Á†Å‰πüËøêË°åÂú®ÂçèÁ®ã‰∏≠„ÄÇ</p>
<p>‰ª£Á†Å‰∏≠ÁöÑ channel ÂØπË±°Âú®Ê†à‰∏äÔºåËÄå CO ÈááÁî®ÁöÑÊòØÂÖ±‰∫´Ê†àÂÆûÁé∞ÊñπÂºèÔºå‰∏Ä‰∏™ÂçèÁ®ãÊ†à‰∏äÁöÑÊï∞ÊçÆÂèØËÉΩË¢´ÂÖ∂‰ªñÂçèÁ®ãË¶ÜÁõñÔºå<strong>ÂçèÁ®ãÈó¥‰∏ÄËà¨‰∏çËÉΩÁõ¥Êé•ÈÄöËøáÊ†à‰∏äÁöÑÊï∞ÊçÆÈÄö‰ø°</strong>ÔºåÂõ†Ê≠§‰ª£Á†Å‰∏≠ÁöÑ lambda ÈááÁî®‰∫Ü<strong>ÊåâÂÄºÊçïËé∑</strong>ÁöÑÊñπÂºèÔºåÂ∞Ü channel Êã∑Ë¥ù‰∫Ü‰∏Ä‰ªΩÔºå‰º†ÈÄíÂà∞Êñ∞Âª∫ÁöÑÂçèÁ®ã‰∏≠„ÄÇchannel ÁöÑÊã∑Ë¥ùÊìç‰ΩúÂè™ÊòØÂ∞ÜÂÜÖÈÉ®ÂºïÁî®ËÆ°Êï∞Âä† 1ÔºåÂá†‰πé‰∏ç‰ºöÂØπÊÄßËÉΩÈÄ†ÊàêÂΩ±Âìç„ÄÇ</p>
<p>ÂàõÂª∫ channel Êó∂ÂèØ‰ª•ÂÉè‰∏ãÈù¢ËøôÊ†∑Âä†‰∏äË∂ÖÊó∂Êó∂Èó¥Ôºö</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>co<span style="color:#000;font-weight:bold">::</span>Chan<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">&gt;</span> ch(<span style="color:#099">8</span>, <span style="color:#099">1000</span>);
</span></span></code></pre></div><p>channel ËØªÂÜôÊìç‰ΩúÁªìÊùüÂêéÔºåÂèØ‰ª•Ë∞ÉÁî® <code>co::timeout()</code> Âà§Êñ≠ÊòØÂê¶Ë∂ÖÊó∂ÔºåËøôÁßçÊñπÂºèÊØî golang ‰∏≠Âü∫‰∫é select ÁöÑÂÆûÁé∞ÊñπÂºèÊõ¥ÁÆÄÂçï„ÄÇ</p>
<p>CO ‰∏≠ÁöÑ channel Âü∫‰∫éÂÜÖÂ≠òÊã∑Ë¥ùÂÆûÁé∞Ôºå‰º†ÈÄíÁöÑÊï∞ÊçÆÁ±ªÂûãÂèØ‰ª•ÊòØÂÜÖÁΩÆÁ±ªÂûã„ÄÅÊåáÈíàÁ±ªÂûãÔºåÊàñËÄÖ<strong>Êã∑Ë¥ùÊìç‰ΩúÂÖ∑ÊúâÁÆÄÂçïÁöÑÂÜÖÂ≠òÊã∑Ë¥ùËØ≠‰πâÁöÑÁªìÊûÑ‰ΩìÁ±ªÂûã</strong>„ÄÇÂÉè <code>std::string</code> Êàñ STL ‰∏≠ÁöÑÂÆπÂô®Á±ªÂûãÔºåÊã∑Ë¥ùÊìç‰Ωú‰∏çÊòØÁÆÄÂçïÁöÑÂÜÖÂ≠òÊã∑Ë¥ùÔºå‰∏ÄËà¨‰∏çËÉΩÁõ¥Êé•Âú® channel ‰∏≠‰º†ÈÄíÔºåËØ¶ÊÉÖËßÅ <a href="../../co/coroutine/#channelcochan">co::Chan ÂèÇËÄÉÊñáÊ°£</a>„ÄÇ</p>
<h4 id="waitgroup"><a class="anchor" href="#waitgroup">#</a>waitgroup</h4>
<p><a href="../../co/coroutine/#waitgroupcowaitgroup">co::WaitGroup</a>ÔºåÁ±ª‰ºº‰∫é golang ‰∏≠ÁöÑ <code>sync.WaitGroup</code>ÔºåÂèØÁî®‰∫éÁ≠âÂæÖÂçèÁ®ãÊàñÁ∫øÁ®ãÁöÑÈÄÄÂá∫„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/co.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>DEF_main(argc, argv) {
</span></span><span style="display:flex;"><span>    FLG_cout <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    co<span style="color:#000;font-weight:bold">::</span>WaitGroup wg;
</span></span><span style="display:flex;"><span>    wg.add(<span style="color:#099">8</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span> (<span style="color:#458;font-weight:bold">int</span> i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>; i <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">8</span>; <span style="color:#000;font-weight:bold">++</span>i) {
</span></span><span style="display:flex;"><span>        go([wg]() {
</span></span><span style="display:flex;"><span>            LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;co: &#34;</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> co<span style="color:#000;font-weight:bold">::</span>coroutine_id();
</span></span><span style="display:flex;"><span>            wg.done();
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    wg.wait();
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ÁΩëÁªúÁºñÁ®ã"><a class="anchor" href="#%e7%bd%91%e7%bb%9c%e7%bc%96%e7%a8%8b">#</a>ÁΩëÁªúÁºñÁ®ã</h3>
<p>CO Êèê‰æõ‰∫Ü‰∏ÄÂ•óÂçèÁ®ãÂåñÁöÑ <a href="../../co/coroutine/#%e5%8d%8f%e7%a8%8b%e5%8c%96%e7%9a%84-socket-api">socket API</a>ÔºåÂÆÉ‰ª¨Â§ßÈÉ®ÂàÜÂΩ¢Âºè‰∏ä‰∏éÂéüÁîüÁöÑ socket API Âü∫Êú¨‰∏ÄËá¥ÔºåÁÜüÊÇâ socket ÁºñÁ®ãÁöÑÁî®Êà∑ÔºåÂèØ‰ª•ËΩªÊùæÁöÑÁî®ÂêåÊ≠•ÁöÑÊñπÂºèÂÜôÂá∫È´òÊÄßËÉΩÁöÑÁΩëÁªúÁ®ãÂ∫è„ÄÇÂè¶Â§ñÔºåCO ‰πüÂÆûÁé∞‰∫ÜÊõ¥È´òÂ±ÇÁöÑÁΩëÁªúÁºñÁ®ãÁªÑ‰ª∂ÔºåÂåÖÊã¨ <a href="../../co/net/tcp/">TCP</a>„ÄÅ<a href="../../co/net/http/">HTTP</a> ‰ª•ÂèäÂü∫‰∫é <a href="../../co/json/">JSON</a> ÁöÑ <a href="../../co/net/rpc/">RPC</a> Ê°ÜÊû∂ÔºåÂÆÉ‰ª¨ÂÖºÂÆπ IPv6ÔºåÂêåÊó∂ÊîØÊåÅ SSLÔºåÁî®Ëµ∑Êù•ÊØî socket API Êõ¥Êñπ‰æø„ÄÇËøôÈáåÂè™ÁÆÄÂçïÁöÑÂ±ïÁ§∫‰∏Ä‰∏ã HTTP ÁöÑÁî®Ê≥ïÔºåÂÖ∂‰ΩôÁöÑÂèØ‰ª•Êü•ÁúãÂèÇËÄÉÊñáÊ°£„ÄÇ</p>
<p><strong>ÈùôÊÄÅ web server</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/flag.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#include</span> <span style="color:#999;font-weight:bold;font-style:italic">&#34;co/http.h&#34;</span><span style="color:#999;font-weight:bold;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span>DEF_string(d, <span style="color:#d14">&#34;.&#34;</span>, <span style="color:#d14">&#34;root dir&#34;</span>); <span style="color:#998;font-style:italic">// Specify the root directory of the web server
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">main</span>(<span style="color:#458;font-weight:bold">int</span> argc, <span style="color:#458;font-weight:bold">char</span><span style="color:#000;font-weight:bold">**</span> argv) {
</span></span><span style="display:flex;"><span>    flag<span style="color:#000;font-weight:bold">::</span>init(argc, argv);
</span></span><span style="display:flex;"><span>    so<span style="color:#000;font-weight:bold">::</span>easy(FLG_d.c_str()); <span style="color:#998;font-style:italic">// mum never have to worry again
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>HTTP server</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>http<span style="color:#000;font-weight:bold">::</span>Server serv;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>serv.on_req(
</span></span><span style="display:flex;"><span>    [](<span style="color:#000;font-weight:bold">const</span> http<span style="color:#000;font-weight:bold">::</span>Req<span style="color:#000;font-weight:bold">&amp;</span> req, http<span style="color:#000;font-weight:bold">::</span>Res<span style="color:#000;font-weight:bold">&amp;</span> res) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (req.is_method_get()) {
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">if</span> (req.url() <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#34;/hello&#34;</span>) {
</span></span><span style="display:flex;"><span>                res.set_status(<span style="color:#099">200</span>);
</span></span><span style="display:flex;"><span>                res.set_body(<span style="color:#d14">&#34;hello world&#34;</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                res.set_status(<span style="color:#099">404</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            res.set_status(<span style="color:#099">405</span>); <span style="color:#998;font-style:italic">// method not allowed
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>serv.start(<span style="color:#d14">&#34;0.0.0.0&#34;</span>, <span style="color:#099">80</span>);                                    <span style="color:#998;font-style:italic">// http
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>serv.start(<span style="color:#d14">&#34;0.0.0.0&#34;</span>, <span style="color:#099">443</span>, <span style="color:#d14">&#34;privkey.pem&#34;</span>, <span style="color:#d14">&#34;certificate.pem&#34;</span>); <span style="color:#998;font-style:italic">// https
</span></span></span></code></pre></div><p><strong>HTTP client</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">f</span>() {
</span></span><span style="display:flex;"><span>    http<span style="color:#000;font-weight:bold">::</span>Client c(<span style="color:#d14">&#34;https://github.com&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    c.get(<span style="color:#d14">&#34;/&#34;</span>);
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;response code: &#34;</span><span style="color:#000;font-weight:bold">&lt;&lt;</span> c.response_code();
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;body size: &#34;</span><span style="color:#000;font-weight:bold">&lt;&lt;</span> c.body_size();
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;Content-Length: &#34;</span><span style="color:#000;font-weight:bold">&lt;&lt;</span> c.header(<span style="color:#d14">&#34;Content-Length&#34;</span>);
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> c.header();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    c.post(<span style="color:#d14">&#34;/hello&#34;</span>, <span style="color:#d14">&#34;data xxx&#34;</span>);
</span></span><span style="display:flex;"><span>    LOG <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#d14">&#34;response code: &#34;</span><span style="color:#000;font-weight:bold">&lt;&lt;</span> c.response_code();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>go(f);
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

  



  
    
  
    
  


  


<div class="book-languages" tabindex="0" aria-haspopup="true">
  <ul>
    <li class="flex align-center">
      <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
      ‰∏≠Êñá
    </li> 
  </ul>

  <ul class="book-languages-list">
    
    <li class="active">
      <a href="../../../cn/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        ‰∏≠Êñá
      </a>
    </li>
    
    <li class="">
      <a href="../../../en/about/co/" class="flex align-center">
        <img src="../../../svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </li>
    
  </ul>
</div>




  <div class="book-date"><a class="flex align-center" href="https://github.com/cocoyaxi/codoc/commit/3c0a73aa09b5a887a0bd3af3340f10fb6199ba91" title='ÊúÄÂêé‰øÆÊîπËÄÖ idealvin | June 10, 2022' target="_blank" rel="noopener">
      <img src="../../../svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>June 10, 2022</span>
    </a>
  </div>



  <div class="book-edit">
    <a class="flex align-center" href="https://github.com/cocoyaxi/codoc/edit/master/content/cn/about/co.md" target="_blank" rel="noopener">
      <img src="../../../svg/edit.svg" class="book-icon" alt="Edit" />
      <span>ÁºñËæëÊú¨È°µ</span>
    </a>
  </div>

</div>

 
        





<script src="//cdn.bootcss.com/highlight.js/11.1.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/cpp.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/bash.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/lua.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/11.1.0/languages/yaml.min.js"></script>
<script>hljs.configure({ languages: [] }); hljs.initHighlightingOnLoad();</script>





      </footer>

      
  
  <div class="book-comments">


<link rel="stylesheet" href="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.css">
<script src="//cdn.bootcss.com/gitalk/1.7.2/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '11f9ff9ca43804d70b32',
    clientSecret: '07e2bd5b09a1654e7942a7698c3ec164e7566177',
    repo: 'gitalk',
    owner: 'idealvin',
    admin: ['idealvin'],
    id: location.pathname,
    language: 'zh-CN',
    distractionFreeMode: false,
    proxy: 'https:\/\/cors-anywhere.azm.workers.dev\/https:\/\/github.com\/login\/oauth\/access_token'
  })
  gitalk.render('gitalk-container');
</script></div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#co-ÊòØ‰ªÄ‰πà">CO ÊòØ‰ªÄ‰πà</a></li>
        <li><a href="#co-ÁöÑÂèëÂ±ïÂéÜÁ®ã">CO ÁöÑÂèëÂ±ïÂéÜÁ®ã</a></li>
        <li><a href="#Âø´ÈÄü‰∏äÊâã">Âø´ÈÄü‰∏äÊâã</a>
          <ul>
            <li><a href="#ÁºñËØë">ÁºñËØë</a></li>
            <li><a href="#‰ΩøÁî®-co-ÂºÄÂèë-c-È°πÁõÆ">‰ΩøÁî® CO ÂºÄÂèë C++ È°πÁõÆ</a></li>
          </ul>
        </li>
        <li><a href="#Ê†∏ÂøÉÁªÑ‰ª∂">Ê†∏ÂøÉÁªÑ‰ª∂</a>
          <ul>
            <li><a href="#coflag">co/flag</a></li>
            <li><a href="#colog">co/log</a></li>
            <li><a href="#counitest">co/unitest</a></li>
            <li><a href="#ÂçèÁ®ã">ÂçèÁ®ã</a>
              <ul>
                <li><a href="#ÂàõÂª∫ÂçèÁ®ã">ÂàõÂª∫ÂçèÁ®ã</a></li>
                <li><a href="#channel">channel</a></li>
                <li><a href="#waitgroup">waitgroup</a></li>
              </ul>
            </li>
            <li><a href="#ÁΩëÁªúÁºñÁ®ã">ÁΩëÁªúÁºñÁ®ã</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












